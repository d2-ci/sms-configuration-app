{"version":3,"sources":["D2App/App.module.css","D2App/headline/PageHeadline.module.css","D2App/views/home/Home.module.css","D2App/forms/FormRow.module.css","D2App/gateways/GatewayKeyValuePair.module.css","D2App/gateways/GatewayList.module.css","D2App/dataList/ListActions.module.css","D2App/views/gateway_configuration/GatewayConfigList.module.css","D2App/views/received_sms_list/Filter.module.css","D2App/views/received_sms_list/Pagination.module.css","D2App/views/received_sms_list/SmsTable.module.css","D2App/views/received_sms_list/ReceivedSmsList.module.css","D2App/smsCommandFields/FieldDataElementWithCategoryOptionCombo.module.css","D2App/smsCommandFields/DataElementTimesCategoryOptionCombos.module.css","D2App/smsCommandFields/FieldCommandSpecialCharacter.module.css","D2App/views/sms_commands/SmsCommandList.module.css","D2App/views/sent_sms_list/Pagination.module.css","D2App/views/sent_sms_list/SmsTable.module.css","D2App/views/sent_sms_list/SentSmsList.module.css","D2App/notifications/AlertContext.js","D2App/dataTest/dataTest.js","D2App/notifications/AlertHandler.js","D2App/views/NoMatch.js","D2App/locales/index.js","D2App/headline/PageHeadline.js","D2App/views/home/Home.js","D2App/gateways/DeleteGatewaysConfirmationDialog.js","D2App/gateways/FieldGatewayAuthToken.js","D2App/gateways/FieldGatewayName.js","D2App/gateways/FieldGatewayPassword.js","D2App/gateways/FieldGatewayUrlTemplate.js","D2App/gateways/FieldGatewayUsername.js","D2App/gateways/GatewayAddKeyValuePair.js","D2App/forms/FormRow.js","D2App/gateways/GatewayBulkSMSForm.js","D2App/gateways/GatewayClickatellForm.js","D2App/gateways/GatewayGenericForm.js","D2App/gateways/GatewayKeyValuePair.js","D2App/views/gateway_configuration/GatewayConfigFormEdit.js","D2App/gateways/GatewaysTable.js","D2App/gateways/getTypeLabelByType.js","D2App/gateways/GatewayList.js","D2App/gateways/gatewayTypes.js","D2App/gateways/useCreateBulkSMSGatewayMutation.js","D2App/gateways/useCreateClickatellGatewayMutation.js","D2App/gateways/useCreateGenericGatewayMutation.js","D2App/gateways/useDeleteGatewaysMutation.js","D2App/gateways/useReadGatewayQuery.js","D2App/gateways/useReadGatewaysQuery.js","D2App/gateways/useSetDefaultGatewayMutation.js","D2App/gateways/useUpdateGatewayMutation.js","D2App/gateways/useUpdateBulkSMSGatewayMutation.js","D2App/gateways/useUpdateClickatellGatewayMutation.js","D2App/gateways/useUpdateGenericGatewayMutation.js","D2App/views/gateway_configuration/GatewayConfigFormNew.js","D2App/dataList/ListActions.js","D2App/views/gateway_configuration/GatewayConfigList.js","D2App/views/received_sms_list/config.js","D2App/views/received_sms_list/useQueryParams.js","D2App/views/received_sms_list/createSearchString.js","D2App/views/received_sms_list/Filter.js","D2App/views/received_sms_list/DeleteSelectedButton.js","D2App/views/received_sms_list/Pagination.js","D2App/views/received_sms_list/DeleteSmsButton.js","D2App/views/received_sms_list/SmsTable.js","D2App/views/received_sms_list/ReceivedSmsList.js","D2App/smsCommandFields/fieldNames.js","D2App/smsCommandFields/CommandsAddSpecialCharacters.js","D2App/smsCommandFields/completenessMethods.js","D2App/dataSet/FieldDataSet.js","D2App/dataSet/useReadDataSetsQuery.js","D2App/dataSet/FieldDataSetWithAutoLoad.js","D2App/dataSet/useReadDataSetQuery.js","D2App/dataElement/useReadDataElementsQuery.js","D2App/dataElement/useReadDataElementsOfDataSetQuery.js","D2App/smsCommandFields/FieldDataElementWithCategoryOptionComboFormula.js","D2App/utils/get.js","D2App/smsCommandFields/FieldDataElementWithCategoryOptionCombo.js","D2App/smsCommandFields/DataElementTimesCategoryOptionCombos.js","D2App/smsCommandFields/FieldCommandCompletenessMethod.js","D2App/smsCommandFields/FieldCommandConfirmMessage.js","D2App/smsCommandFields/FieldCommandDefaultMessage.js","D2App/smsCommandFields/FieldCommandMoreThanOneOrgUnitMessage.js","D2App/smsCommandFields/FieldCommandName.js","D2App/smsCommandFields/FieldCommandNoUserMessage.js","D2App/smsCommandFields/parserTypes.js","D2App/smsCommandFields/FieldCommandParser.js","D2App/smsCommandFields/FieldCommandSeparator.js","D2App/smsCommandFields/FieldCommandSmsCode.js","D2App/smsCommandFields/FieldCommandSpecialCharacter.js","D2App/smsCommandFields/FieldCommandSuccessMessage.js","D2App/smsCommandFields/FieldCommandUseCurrentPeriodForReporting.js","D2App/smsCommandFields/FieldCommandWrongFormatMessage.js","D2App/smsCommandFields/ProgramStageDataElements.js","D2App/smsCommand/DE_COC_toFormName.js","D2App/smsCommand/DeleteCommandsConfirmationDialog.js","D2App/smsCommand/SaveCommandButton.js","D2App/smsCommand/SubmitErrors.js","D2App/smsCommand/isParserType.js","D2App/smsCommand/useCreateSmsCommandMutation.js","D2App/smsCommand/useDeleteSmsCommandMutation.js","D2App/smsCommand/useReadSmsCommandParserTypeQuery.js","D2App/smsCommand/useReadSmsCommandsQuery.js","D2App/smsCommand/useUpdateCommand.js","D2App/userGroup/FieldUserGroup.js","D2App/userGroup/useReadUserGroupsQuery.js","D2App/userGroup/FieldUserGroupWithAutoLoad.js","D2App/smsCommandUnregisteredParser/CommandEditUnregisteredParserForm.js","D2App/program/FieldProgram.js","D2App/program/useReadProgramsQuery.js","D2App/program/FieldProgramWithAutoLoad.js","D2App/smsCommandTrackedEntityRegistrationParser/CommandEditTrackedEntityRegistrationParserForm.js","D2App/programStage/FieldProgramStage.js","D2App/programStage/useReadProgramStagesQuery.js","D2App/programStage/FieldProgramStageWithAutoLoad.js","D2App/smsCommandProgramStageDataEntryParser/useReadSmsCommandProgramStageDataEntryParserQuery.js","D2App/smsCommandProgramStageDataEntryParser/CommandEditProgramStageDataEntryParserForm.js","D2App/smsCommandWithDataSet/useReadSmsCommandWithDataSetQuery.js","D2App/smsCommandWithDataSet/CommandEditWithDataSetForm.js","D2App/smsCommand/getSmsCodeDuplicates.js","D2App/smsCommandKeyValueParser/CommandEditKeyValueParserForm.js","D2App/smsCommandJ2MEParser/CommandEditJ2MEParserForm.js","D2App/smsCommandEventRegistrationParser/useReadSmsCommandEventRegistrationParserQuery.js","D2App/smsCommandEventRegistrationParser/CommandEditEventRegistrationParserForm.js","D2App/smsCommandAlertParser/CommandEditAlertParserForm.js","D2App/views/sms_commands/SmsCommandFormEdit.js","D2App/views/sms_commands/SmsCommandFormNew.js","D2App/views/sms_commands/SmsCommandList.js","D2App/smsCommand/getLabelByParserType.js","D2App/views/sent_sms_list/translations.js","D2App/views/sent_sms_list/RefetchSms.js","D2App/views/sent_sms_list/DeleteButton.js","D2App/views/sent_sms_list/SmsTableItem.js","D2App/views/sent_sms_list/Pagination.js","D2App/views/sent_sms_list/SmsTable.js","D2App/views/sent_sms_list/StatusFilter.js","D2App/views/sent_sms_list/selectors.js","D2App/views/sent_sms_list/DeleteSelectedButton.js","D2App/views/sent_sms_list/SentSmsList.js","D2App/views/sent_sms_list/handlers.js","D2App/navigation/NavigationItem.js","D2App/navigation/Navigation.js","D2App/App.js"],"names":["module","exports","AlertContext","createContext","addAlert","Error","dataTest","name","prefix","AlertHandler","children","alerts","setAlerts","useState","Provider","value","alert","map","message","type","key","NoMatch","data-test","i18n","addResources","enTranslations","PageHeadline","className","styles","headline","Home","t","nsSeparator","s","explanation","DeleteGatewaysConfirmationDialog","onCancelClick","onDeleteClick","secondary","onClick","destructive","Field","ReactFinalForm","FieldGatewayAuthToken","required","label","component","InputFieldFF","validate","composeValidators","string","hasValue","FieldGatewayName","FieldGatewayPassword","FieldGatewayUrlTemplate","url","FieldGatewayUsername","useForm","GatewayAddKeyValuePair","change","getState","parameters","values","header","encode","confidential","FormRow","cx","formRow","Form","GatewayBulkSMSForm","onSubmit","initialValues","submitText","handleSubmit","submitting","primary","icon","small","disabled","defaultProps","GatewayClickatellForm","GatewayGenericForm","_","index","GatewayKeyValuePair","isStringWithLengthAtLeastOne","textInputs","keyInput","valueInput","checkboxGroup","checkbox","CheckboxFieldFF","slice","removeKeyValueFromFormState","GATEWAY_CONFIG_FORM_EDIT_PATH","GatewayConfigFormEdit","history","useHistory","id","useParams","loading","error","loadError","data","jsonData","useReadGatewayQuery","saveGenericGateway","saveGenericGatewayError","useUpdateGenericGatewayMutation","saveBulkSMSGateway","saveBulkSMSGatewayError","useUpdateBulkSMSGatewayMutation","saveClickatellGateway","saveClickatellGatewayError","useUpdateClickatellGatewayMutation","saveError","msg","title","gateway","JSON","parse","gatewayType","async","formValues","uid","GENERIC_FORM","BULK_SMS_FORM","CLICKATELL_FORM","push","GATEWAY_CONFIG_LIST_PATH","e","Promise","reject","hasGateway","data-gateway-id","GatewaysTable","allGatewaysChecked","checkedGateways","gateways","onGatewayToggle","onToggleAll","onMakeDefaultClick","onChange","checked","includes","isDefault","GatewayList","setCheckedGateways","processing","length","container","processingMessage","loadingContainer","findIndex","curId","newCheckedGateways","allGatewayIds","CREATE_BULK_SMS_GATEWAY_MUTATION","resource","username","password","CREATE_CLICKATELL_GATEWAY_MUTATION","authtoken","urlTemplate","CREATE_GENERIC_GATEWAY_MUTATION","DELETE_GATEWAY_MUTATION","useDeleteGatewaysMutation","setLoading","setError","idToMutationRequest","engine","variables","mutate","idToMutationRequestFactory","useDataEngine","onDone","response","onError","ids","all","then","catch","GATEWAY_QUERY","useDataQuery","GATEWAYS_QUERY","params","fields","filter","SET_DEFAULT_GATEWAY_MUTATION","useUpdateGatewayMutation","query","updatedQuery","UPDATE_BULK_SMS_GATEWAY_MUTATION","UPDATE_CLICKATELL_GATEWAY_MUTATION","UPDATE_GENERIC_GATEWAY_MUTATION","GatewayConfigFormNew","visibleForm","setVisibleForm","useDataMutation","selected","passwordRequired","ListActions","addLabel","deleteLabel","dataTestProp","onAddClick","disableAdd","disableDelete","GatewayConfigList","showDeleteDialog","setShowDeleteDialog","loadingReadGateways","errorReadGateways","refetch","refetchReadGateways","join","rest","parsedData","useReadGatewaysQuery","deleteCheckedGateways","loadingDelete","errorDelete","makeGatewayDefault","loadingSetDefault","errorSetDefault","hasGateways","info","RECEIVED_SMS_LIST_LABEL","STATUS_FILTER_OPTIONS","useQueryParams","searchParams","URLSearchParams","useLocation","search","status","get","phoneNumber","page","parseInt","pageSize","createSearchString","queryString","Object","keys","reduce","acc","paramKey","paramValue","Filter","pristine","inputStrip","SingleSelectFieldFF","options","inputWidth","phoneNumberField","large","mutation","DeleteSelectedButton","selectedIds","onComplete","useContext","PAGE_LENGTHS","Pagination","pageCount","total","firstItem","Math","min","lastItem","availablePages","Array","from","_x","i","toString","navigateToPage","newPage","verticalAlign","dense","select","summary","buttonPrevious","availablePage","buttonNext","DeleteSmsButton","SmsTable","messages","pager","refetchList","setSelectedIds","selectedIdSet","Set","allSelected","toggle","has","delete","add","colSpan","noResults","bind","text","originator","smsstatus","user","userCredentials","moment","receivedDate","format","inboundSms","ReceivedSmsList","called","lazy","useEffect","inboundsmss","topBar","FIELD_COMMAND_COMPLETENESS_METHOD_NAME","FIELD_COMMAND_DEFAULT_MESSAGE_NAME","FIELD_COMMAND_ID_NAME","FIELD_COMMAND_MORE_THAN_ONE_ORG_UNIT_MESSAGE_NAME","FIELD_COMMAND_NAME_NAME","FIELD_COMMAND_NO_USER_MESSAGE_NAME","FIELD_COMMAND_PARSER_NAME","FIELD_COMMAND_PROGAM_NAME","FIELD_COMMAND_PROGAM_STAGE_NAME","FIELD_COMMAND_SEPARATOR_NAME","FIELD_COMMAND_SMS_CODES_NAME","FIELD_COMMAND_SPECIAL_CHARS_NAME","FIELD_COMMAND_SUCCESS_MESSAGE_NAME","FIELD_COMMAND_USE_CURRENT_PERIOD_FOR_REPORTING_NAME","FIELD_COMMAND_WRONG_FORMAT_MESSAGE_NAME","FIELD_COMMAND_CONFIRM_MESSAGE_NAME","CommandsAddSpecialCharacters","newSpecialChars","ALL_DATAVALUE","AT_LEAST_ONE_DATAVALUE","DO_NOT_MARK_COMPLETE","FieldDataSet","dataSets","errorText","validationText","DATA_SETS_QUERY","paging","FieldDataSetWithAutoLoad","showLoadingStatus","programs","displayName","DATA_SET_QUERY","dataSet","DATA_ELEMENTS_QUERY","dataElements","queryDataElements","code","replace","queryDataElementsOfDataSet","nextVariables","queryDataSet","dataSetElements","dataElement","dataElementIds","useFormState","FieldDataElementWithCategoryOptionComboFormula","targetFieldName","onClose","form","dataSetId","setData","finally","useReadDataElementsOfDataSetQuery","initialFormula","path","object","segments","split","cur","nextObject","operator","useMemo","dataElementCode","onRemove","newFormula","event","stopPropagation","initialValue","FieldDataElementWithCategoryOptionCombo","categoryOptionCombo","showFormula","setShowFormula","baseName","DE_COC_toFormName","formulaName","field","subscription","invalid","touched","input","meta","formula","FormSpy","DataElementTimesCategoryOptionCombos","DE_COC_combinations","errors","smsCodeErrors","globalError","global","allRequired","completenessMethods","FieldCommandCompletenessMethod","FieldCommandConfirmMessage","TextAreaFieldFF","FieldCommandDefaultMessage","FieldCommandMoreThanOneOrgUnitMessage","FieldCommandName","FieldCommandNoUserMessage","KEY_VALUE_PARSER","J2ME_PARSER","ALERT_PARSER","UNREGISTERED_PARSER","TRACKED_ENTITY_REGISTRATION_PARSER","PROGRAM_STAGE_DATAENTRY_PARSER","EVENT_REGISTRATION_PARSER","commandTypes","sort","a","b","FieldCommandParser","FieldCommandSeparator","FieldCommandSmsCode","valueType","smsCode","nextCode","trackedEntityAttribute","FieldCommandSpecialCharacter","button","specialChars","FieldCommandSuccessMessage","FieldCommandUseCurrentPeriodForReporting","FieldCommandWrongFormatMessage","ProgramStageDataElements","programStageDataElements","smsCodes","currentValue","dataElementId","cocCode","DeleteCommandsConfirmationDialog","SaveCommandButton","submitError","hasSubmitErrors","SubmitErrors","isParserType","parserType","parser","CREATE_SMS_COMMAND_MUTATION","dataset","userGroup","program","programStage","DELETE_SMS_COMMAND_MUTATION","useDeleteSmsCommandMutation","READ_SMS_COMMAND_PARSER_TYPE_QUERY","smsCommand","SMS_COMMANDS_QUERY","smsCommands","undefined","FORM_ERROR","FinalForm","identity","REPLACE_SMS_COMMAND_MUTATION","commandId","UPDATE_SMS_COMMAND_MUTATION","partial","useUpdateCommand","onAfterChange","formatCommand","allVariables","fallback","FieldUserGroup","userGroups","USER_GROUPS_QUERY","FieldUserGroupWithAutoLoad","CommandEditUnregisteredParserForm","updateCommand","receivedMessage","FieldProgram","PROGRAMS_QUERY","registration","FieldProgramWithAutoLoad","useReadProgramsQuery","formatSmsCodes","updates","CommandEditTrackedEntityRegistrationParserForm","separator","defaultMessage","wrongFormatMessage","noUserMessage","moreThanOneOrgUnitMessage","successMessage","smsCodesOriginal","curSmsCodes","selectedProgramOption","dynamicFields","programTrackedEntityAttributes","merged","dynamicField","FieldProgramStage","programStages","PROGRAM_STAGES_QUERY","programId","FieldProgramStageWithAutoLoad","useReadProgramStagesQuery","READ_SMS_COMMAND_PROGRAM_STAGE_DATA_ENTRY_PARSER_QUERY","CommandEditProgramStageDataEntryParserForm","loadingCommandError","commandData","programStageId","command","getInitialFormState","selectedProgramStageOption","READ_SMS_COMMAND_KEY_VALUE_PARSER_QUERY","globalValidate","DE_COC_combination_data","hasErrors","completenessMethod","smsCodesFormState","smsCodesWithValue","entries","assign","duplicates","curDuplicates","potentialDuplicates","curCode","curIndex","newlyFoundDuplicates","curWithCodeDuplicates","curName","getSmsCodeDuplicates","duplicateErrors","forEach","duplicate","formattedSmsCodes","compulsory","optionId","formattedSmsCode","CommandEditWithDataSetForm","initialCompletenessMethod","selectedDataSetOption","useCurrentPeriodForReporting","specialCharacters","curCombinations","categoryCombo","combos","COC","CommandEditKeyValueParserForm","CommandEditJ2MEParserForm","READ_SMS_COMMAND_EVENT_REGISTRATION_PARSER_QUERY","CommandEditEventRegistrationParserForm","CommandEditAlertParserForm","SMS_COMMAND_FORM_EDIT_PATH","SmsCommandFormEdit","useReadSmsCommandParserTypeQuery","isParser","SMS_COMMAND_LIST_PATH","ActualForm","prevValues","setPrevValues","subscribe","batch","prevProgram","prevParserType","useResetFormFields","showDataSetField","showUserGroupField","showProgramField","showProgramStageField","SmsCommandFormNew","createSmsCommand","useCreateSmsCommandMutation","SMS_COMMAND_LIST_LABEL","SmsCommandList","checkedSmsCommands","setCheckedSmsCommands","showDeleteConfirmationDialog","setShowDeleteConfirmationDialog","loadingReadSmsCommands","errorReadSmsCommands","deleteSmsCommands","allChecked","hasCommands","find","checkedId","toggleSmsCommand","parserTypes","getLabelByParserTypes","editButtonCell","statusMap","DELIVERED","ERROR","FAILED","OUTBOUND","PENDING","SCHEDULED","SENT","throwError","RefetchSms","refetchAndClear","DeleteButton","cleanSelected","SmsTableItem","sms","toggleSelected","isSelected","date","recipients","pageSizes","changePage","left","size","right","amount","pageselection","smses","toggleAll","parseStatus","filterOptions","StatusFilter","setStatus","SENT_SMS_LIST_LABEL","base","SentSmsList","setSelected","allIds","getAllIds","outboundsmss","noIds","noLengthMatch","every","getAllSelected","filtered","current","createCleanSelectedHandler","createToggleAllHandler","currentId","createToggleHandler","context","headerRight","NavigationItem","exactMatch","active","routeMatch","useRouteMatch","isExact","useIsItemActive","defualtProps","Navigation","App","spacers","colors","sidebar","content","exact"],"mappings":"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","file":"static/js/app.24d4e536.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"App_container__2zgzu\",\"sidebar\":\"App_sidebar__10tAV\",\"content\":\"App_content__3I8HS\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"headline\":\"PageHeadline_headline__1llN5\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"explanation\":\"Home_explanation__10no3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"formRow\":\"FormRow_formRow__3ALDU\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"textInputs\":\"GatewayKeyValuePair_textInputs__dJAb3\",\"keyInput\":\"GatewayKeyValuePair_keyInput__2WHV_\",\"valueInput\":\"GatewayKeyValuePair_valueInput__1uRVv\",\"checkboxGroup\":\"GatewayKeyValuePair_checkboxGroup__2k2Cu\",\"checkbox\":\"GatewayKeyValuePair_checkbox__2hg0g\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"GatewayList_container__jCYee\",\"processingMessage\":\"GatewayList_processingMessage__1RE2H\",\"loadingContainer\":\"GatewayList_loadingContainer__7veW4\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"ListActions_container__2mPW8\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"GatewayConfigList_container__3BZQo\",\"actions\":\"GatewayConfigList_actions__yMRge\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Filter_container__zWNRg\",\"inputStrip\":\"Filter_inputStrip__28I4q\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Pagination_container__1oOhc\",\"verticalAlign\":\"Pagination_verticalAlign__2xbtG\",\"select\":\"Pagination_select__39auA\",\"buttonPrevious\":\"Pagination_buttonPrevious__SXF81\",\"buttonNext\":\"Pagination_buttonNext__1HLDE\",\"summary\":\"Pagination_summary__2dp6R\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"noResults\":\"SmsTable_noResults__1t04p\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"topBar\":\"ReceivedSmsList_topBar__2qRs6\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"FieldDataElementWithCategoryOptionCombo_container__2h1m8\",\"field\":\"FieldDataElementWithCategoryOptionCombo_field__mnPuJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"formRow\":\"DataElementTimesCategoryOptionCombos_formRow__TGwSL\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"FieldCommandSpecialCharacter_container__2Vgvs\",\"field\":\"FieldCommandSpecialCharacter_field__-1mZE\",\"button\":\"FieldCommandSpecialCharacter_button__2XK2-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"editButtonCell\":\"SmsCommandList_editButtonCell__1OBCC\",\"checkbox\":\"SmsCommandList_checkbox__1mJm5\",\"noResults\":\"SmsCommandList_noResults__j0ImP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Pagination_container__2LAE2\",\"left\":\"Pagination_left__1ff2z\",\"right\":\"Pagination_right__2Py4F\",\"amount\":\"Pagination_amount__19_-8\",\"pageselection\":\"Pagination_pageselection__27-Pj\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"noResults\":\"SmsTable_noResults__rTkg-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"SentSmsList_header__3biA5\",\"headerRight\":\"SentSmsList_headerRight__XinlM\"};","import { createContext } from 'react';\nexport const AlertContext = createContext({\n  addAlert: () => {\n    throw new Error('AlertContext has not been initialized yet!');\n  }\n});","const defaultPrefix = 'dhis2-smsconfiguration';\nexport const dataTest = (name, prefix = defaultPrefix) => `${prefix}-${name}`;","import { AlertBar, AlertStack } from '@dhis2/ui';\nimport React, { useState } from 'react';\nimport { PropTypes } from '@dhis2/prop-types';\nimport { AlertContext } from './AlertContext';\nimport { dataTest } from '../dataTest';\nexport const AlertHandler = ({\n  children\n}) => {\n  const [alerts, setAlerts] = useState([]);\n\n  const addAlert = alert => setAlerts([...alerts, alert]);\n\n  return <AlertContext.Provider value={{\n    addAlert\n  }}>\n            {children}\n\n            <AlertStack dataTest={dataTest('notifications-alerthandler')}>\n                {alerts.map(({\n        message,\n        type\n      }) => <AlertBar dataTest={dataTest('notifications-alert')} key={message} {...{\n        [type]: true\n      }}>\n                        {message}\n                    </AlertBar>)}\n            </AlertStack>\n        </AlertContext.Provider>;\n};\nAlertHandler.propTypes = {\n  children: PropTypes.any\n};","import React from 'react';\nimport { dataTest } from '../dataTest';\nexport const NoMatch = () => <div data-test={dataTest('views-nomatch')}>\n        <h1>404</h1>\n    </div>;","//------------------------------------------------------------------------------\n// <auto-generated>\n// This code was generated by d2-i18n-generate.\n//\n// Changes to this file may cause incorrect behavior and will be lost if\n// the code is regenerated.\n// </auto-generated>\n//------------------------------------------------------------------------------\nimport i18n from '@dhis2/d2-i18n';\nimport enTranslations from './en/translations.json';\nconst namespace = 'default';\ni18n.addResources('en', namespace, enTranslations);\nexport default i18n;","import { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { dataTest } from '../dataTest';\nimport styles from './PageHeadline.module.css';\nexport const PageHeadline = ({\n  children\n}) => <h1 className={styles.headline} data-test={dataTest('headline-pageheadline')}>\n        {children}\n    </h1>;\nPageHeadline.propTypes = {\n  children: PropTypes.string.isRequired\n};","import React from 'react';\nimport i18n from '../../locales';\nimport { PageHeadline } from '../../headline';\nimport { dataTest } from '../../dataTest';\nimport s from './Home.module.css';\nexport const HOME_PATH = '/';\nexport const HOME_LABEL = 'Home';\nexport const Home = () => {\n  return <div data-test={dataTest('views-home')}>\n            <PageHeadline>\n                {i18n.t('Overview: SMS Configuration', {\n        nsSeparator: '>'\n      })}\n            </PageHeadline>\n            <p className={s.explanation}>\n                {i18n.t('Configure settings for SMS sending, receiving, data reporting, alerts, registration and more.')}\n            </p>\n        </div>;\n};","import { Button, ButtonStrip, Modal, ModalActions, ModalContent, ModalTitle } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nexport const DeleteGatewaysConfirmationDialog = ({\n  onCancelClick,\n  onDeleteClick\n}) => <Modal dataTest={dataTest('gateways-deleteconfirmationdialog')}>\n        <ModalTitle>{i18n.t('Confirm deletion')}</ModalTitle>\n        <ModalContent>\n            {i18n.t('Are you sure you want to delete the selected gateways?')}\n        </ModalContent>\n        <ModalActions>\n            <ButtonStrip>\n                <Button secondary onClick={onCancelClick} dataTest={dataTest('gateways-deleteconfirmationdialog-cancel')}>\n                    Cancel\n                </Button>\n\n                <Button destructive onClick={onDeleteClick} dataTest={dataTest('gateways-deleteconfirmationdialog-confirm')}>\n                    Delete\n                </Button>\n            </ButtonStrip>\n        </ModalActions>\n    </Modal>;\nDeleteGatewaysConfirmationDialog.propTypes = {\n  onCancelClick: PropTypes.func.isRequired,\n  onDeleteClick: PropTypes.func.isRequired\n};","import { InputFieldFF, ReactFinalForm, composeValidators, hasValue, string } from '@dhis2/ui';\nimport React from 'react';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nexport const FieldGatewayAuthToken = () => <Field required dataTest={dataTest('gateways-fieldgatewayauthtoken')} name=\"authtoken\" label={i18n.t('Auth token')} component={InputFieldFF} validate={composeValidators(string, hasValue)} />;","import { InputFieldFF, ReactFinalForm, composeValidators, hasValue, string } from '@dhis2/ui';\nimport React from 'react';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nexport const FieldGatewayName = () => <Field required dataTest={dataTest('gateways-fieldgatewayname')} name=\"name\" label={i18n.t('Name')} component={InputFieldFF} validate={composeValidators(string, hasValue)} />;","import { InputFieldFF, ReactFinalForm, composeValidators, hasValue, string } from '@dhis2/ui';\nimport React from 'react';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nexport const FieldGatewayPassword = () => <Field required dataTest={dataTest('gateways-fieldgatewaypassword')} name=\"password\" label={i18n.t('Password')} component={InputFieldFF} validate={composeValidators(string, hasValue)} />;","import { InputFieldFF, ReactFinalForm, composeValidators, hasValue, url } from '@dhis2/ui';\nimport React from 'react';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nexport const FieldGatewayUrlTemplate = () => <Field required dataTest={dataTest('gateways-fieldgatewayurltemplate')} name=\"urlTemplate\" label={i18n.t('Url template')} component={InputFieldFF} validate={composeValidators(url, hasValue)} />;","import { InputFieldFF, ReactFinalForm, composeValidators, hasValue, string } from '@dhis2/ui';\nimport React from 'react';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nexport const FieldGatewayUsername = () => <Field required dataTest={dataTest('gateways-fieldgatewayusername')} name=\"username\" label={i18n.t('User name')} component={InputFieldFF} validate={composeValidators(string, hasValue)} />;","import { Button, ReactFinalForm } from '@dhis2/ui';\nimport React from 'react';\nimport i18n from '../locales';\nimport { dataTest } from '../dataTest';\nconst {\n  useForm\n} = ReactFinalForm;\nexport const GatewayAddKeyValuePair = () => {\n  const {\n    change,\n    getState\n  } = useForm();\n\n  const addKeyValueToFormState = () => {\n    const {\n      parameters\n    } = getState().values;\n    change('parameters', [...parameters, {\n      header: false,\n      encode: false,\n      key: '',\n      value: '',\n      confidential: false\n    }]);\n  };\n\n  return <Button onClick={addKeyValueToFormState} dataTest={dataTest('gateways-gatewayaddkeyvaluepair')}>\n            {i18n.t('Add key value pair')}\n        </Button>;\n};","import React from 'react';\nimport { PropTypes } from '@dhis2/prop-types';\nimport cx from 'classnames';\nimport { dataTest } from '../dataTest';\nimport styles from './FormRow.module.css';\nexport const FormRow = ({\n  children,\n  className\n}) => <div className={cx(styles.formRow, className)} data-test={dataTest('forms-formrow')}>\n        {children}\n    </div>;\nFormRow.propTypes = {\n  children: PropTypes.any.isRequired,\n  className: PropTypes.string\n};","import { Button, ReactFinalForm, CircularLoader } from '@dhis2/ui';\nimport React from 'react';\nimport { PropTypes } from '@dhis2/prop-types';\nimport { FormRow } from '../forms';\nimport { FieldGatewayName, FieldGatewayUsername, FieldGatewayPassword } from '../gateways';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Form\n} = ReactFinalForm;\nexport const GatewayBulkSMSForm = ({\n  onSubmit,\n  initialValues\n}) => {\n  const submitText = initialValues ? i18n.t('Save gateway') : i18n.t('Add gateway');\n  return <Form onSubmit={onSubmit} initialValues={initialValues}>\n            {({\n      handleSubmit,\n      submitting\n    }) => <form onSubmit={handleSubmit} data-test={dataTest('gateways-gatewaybulksmsform')}>\n                    <FormRow>\n                        <FieldGatewayName />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldGatewayUsername />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldGatewayPassword />\n                    </FormRow>\n\n                    <Button primary type=\"submit\" icon={submitting ? <CircularLoader small /> : null} disabled={submitting} dataTest={dataTest('forms-gatewaybulksmsform-submit')}>\n                        {submitText}\n                    </Button>\n                </form>}\n        </Form>;\n};\nGatewayBulkSMSForm.defaultProps = {\n  initialValues: {}\n};\nGatewayBulkSMSForm.propTypes = {\n  onSubmit: PropTypes.func.isRequired,\n  initialValues: PropTypes.object\n};","import { Button, ReactFinalForm, CircularLoader } from '@dhis2/ui';\nimport React from 'react';\nimport { PropTypes } from '@dhis2/prop-types';\nimport { FormRow } from '../forms';\nimport { FieldGatewayAuthToken, FieldGatewayName, FieldGatewayUrlTemplate, FieldGatewayUsername } from '../gateways';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Form\n} = ReactFinalForm;\nexport const GatewayClickatellForm = ({\n  onSubmit,\n  initialValues\n}) => {\n  const submitText = initialValues ? i18n.t('Save gateway') : i18n.t('Add gateway');\n  return <Form onSubmit={onSubmit} initialValues={initialValues}>\n            {({\n      handleSubmit,\n      submitting\n    }) => <form onSubmit={handleSubmit} data-test={dataTest('gateways-gatewayclickatellform')}>\n                    <FormRow>\n                        <FieldGatewayName />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldGatewayUsername />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldGatewayAuthToken />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldGatewayUrlTemplate />\n                    </FormRow>\n\n                    <Button primary type=\"submit\" icon={submitting ? <CircularLoader small /> : null} disabled={submitting} dataTest={dataTest('forms-gatewayclickatellform-submit')}>\n                        {submitText}\n                    </Button>\n                </form>}\n        </Form>;\n};\nGatewayClickatellForm.defaultProps = {\n  initialValues: {}\n};\nGatewayClickatellForm.propTypes = {\n  onSubmit: PropTypes.func.isRequired,\n  initialValues: PropTypes.object\n};","import { Button, ReactFinalForm, NoticeBox, CircularLoader } from '@dhis2/ui';\nimport React from 'react';\nimport { PropTypes } from '@dhis2/prop-types';\nimport { FieldGatewayName, FieldGatewayUrlTemplate, GatewayAddKeyValuePair, GatewayKeyValuePair } from '../gateways';\nimport { FormRow } from '../forms';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Form\n} = ReactFinalForm;\nexport const GatewayGenericForm = ({\n  onSubmit,\n  initialValues\n}) => {\n  const submitText = initialValues ? i18n.t('Save gateway') : i18n.t('Add gateway');\n  return <Form onSubmit={onSubmit} initialValues={initialValues}>\n            {({\n      handleSubmit,\n      values,\n      submitting\n    }) => <form onSubmit={handleSubmit} data-test={dataTest('gateways-gatewaygenericform')}>\n                    <FormRow>\n                        <FieldGatewayName />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldGatewayUrlTemplate />\n                    </FormRow>\n\n                    {values.parameters.map((_, index) => <GatewayKeyValuePair index={index} key={index} />)}\n\n                    <FormRow>\n                        <NoticeBox>\n                            {i18n.t('With a generic http gateway any number of parameters can be added with key value pairs')}\n                        </NoticeBox>\n                    </FormRow>\n\n                    <FormRow>\n                        <GatewayAddKeyValuePair />\n                    </FormRow>\n\n                    <Button primary type=\"submit\" dataTest={dataTest('forms-gatewaygenericform-submit')} disabled={submitting} icon={submitting ? <CircularLoader small /> : null}>\n                        {submitText}\n                    </Button>\n                </form>}\n        </Form>;\n};\nGatewayGenericForm.defaultProps = {\n  initialValues: {\n    parameters: []\n  }\n};\nGatewayGenericForm.propTypes = {\n  onSubmit: PropTypes.func.isRequired,\n  initialValues: PropTypes.object\n};","import { Button, CheckboxFieldFF, InputFieldFF, ReactFinalForm, composeValidators, hasValue, string } from '@dhis2/ui';\nimport React from 'react';\nimport { PropTypes } from '@dhis2/prop-types';\nimport { FormRow } from '../forms';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nimport styles from './GatewayKeyValuePair.module.css';\nconst {\n  Field,\n  useForm\n} = ReactFinalForm;\nconst isStringWithLengthAtLeastOne = composeValidators(string, hasValue);\nexport const GatewayKeyValuePair = ({\n  index\n}) => {\n  const {\n    change,\n    getState\n  } = useForm();\n\n  const removeKeyValueFromFormState = index => {\n    const {\n      parameters\n    } = getState().values;\n\n    if (index === 0) {\n      change('parameters', parameters.slice(1));\n    } else {\n      change('parameters', [...parameters.slice(0, index), ...parameters.slice(index + 1)]);\n    }\n  };\n\n  return <div data-test={dataTest('gateways-gatewaykeyvaluepair')}>\n            <FormRow>\n                <div className={styles.textInputs}>\n                    <Field dataTest={dataTest('gateways-gatewaykeyvaluepair-key')} className={styles.keyInput} name={`parameters[${index}].key`} label={i18n.t('Key')} component={InputFieldFF} validate={isStringWithLengthAtLeastOne} />\n\n                    <Field dataTest={dataTest('gateways-gatewaykeyvaluepair-value')} className={styles.valueInput} name={`parameters[${index}].value`} label={i18n.t('Value')} component={InputFieldFF} validate={isStringWithLengthAtLeastOne} />\n                </div>\n\n                <div className={styles.checkboxGroup}>\n                    <Field dataTest={dataTest('gateways-gatewaykeyvaluepair-isheader')} className={styles.checkbox} type=\"checkbox\" name={`parameters[${index}].header`} label={i18n.t('Send as header')} component={CheckboxFieldFF} />\n\n                    <Field dataTest={dataTest('gateways-gatewaykeyvaluepair-isencoded')} className={styles.checkbox} type=\"checkbox\" name={`parameters[${index}].encode`} label={i18n.t('Encode')} component={CheckboxFieldFF} />\n\n                    <Field dataTest={dataTest('gateways-gatewaykeyvaluepair-isconfidential')} className={styles.checkbox} type=\"checkbox\" name={`parameters[${index}].confidential`} label={i18n.t('Confidential')} component={CheckboxFieldFF} />\n                </div>\n\n                <Button dataTest={dataTest('gateways-gatewaykeyvaluepair-remove')} onClick={() => removeKeyValueFromFormState(index)}>\n                    {i18n.t('Remove key value pair')}\n                </Button>\n            </FormRow>\n        </div>;\n};\nGatewayKeyValuePair.propTypes = {\n  index: PropTypes.number.isRequired\n};","import { useHistory, useParams } from 'react-router-dom';\nimport React from 'react';\nimport { NoticeBox, CenteredContent, CircularLoader } from '@dhis2/ui';\nimport { GATEWAY_CONFIG_LIST_PATH } from './GatewayConfigList';\nimport { GENERIC_FORM, BULK_SMS_FORM, CLICKATELL_FORM, GatewayBulkSMSForm, GatewayClickatellForm, GatewayGenericForm, useReadGatewayQuery, useUpdateGenericGatewayMutation, useUpdateBulkSMSGatewayMutation, useUpdateClickatellGatewayMutation } from '../../gateways';\nimport { PageHeadline } from '../../headline';\nimport { dataTest } from '../../dataTest';\nimport i18n from '../../locales';\nexport const GATEWAY_CONFIG_FORM_EDIT_PATH_STATIC = '/sms-gateway/edit';\nexport const GATEWAY_CONFIG_FORM_EDIT_PATH = `${GATEWAY_CONFIG_FORM_EDIT_PATH_STATIC}/:id`;\nexport const GatewayConfigFormEdit = () => {\n  const history = useHistory();\n  const {\n    id\n  } = useParams();\n  const {\n    loading,\n    error: loadError,\n    data: jsonData\n  } = useReadGatewayQuery(id);\n  const [saveGenericGateway, {\n    error: saveGenericGatewayError\n  }] = useUpdateGenericGatewayMutation();\n  const [saveBulkSMSGateway, {\n    error: saveBulkSMSGatewayError\n  }] = useUpdateBulkSMSGatewayMutation();\n  const [saveClickatellGateway, {\n    error: saveClickatellGatewayError\n  }] = useUpdateClickatellGatewayMutation();\n  const saveError = saveGenericGatewayError || saveBulkSMSGatewayError || saveClickatellGatewayError;\n\n  if (loading) {\n    return <>\n                <PageHeadline>{i18n.t('Edit')}</PageHeadline>\n                <CenteredContent>\n                    <CircularLoader />\n                </CenteredContent>\n            </>;\n  }\n\n  if (loadError) {\n    const msg = i18n.t('Something went wrong whilst loading gateways');\n    return <>\n                <PageHeadline>{i18n.t('Edit')}</PageHeadline>\n                <NoticeBox error title={msg}>\n                    {loadError.message}\n                </NoticeBox>\n            </>;\n  }\n\n  const data =\n  /**\n   * @TODO:\n   *   * The response does not contain the right content type header\n   *     -> https://jira.dhis2.org/browse/DHIS2-9252\n   */\n  jsonData && typeof jsonData.gateway === 'string' ? {\n    gateway: JSON.parse(jsonData.gateway)\n  } : jsonData;\n  const gatewayType = data?.gateway?.type;\n\n  const onSubmit = async formValues => {\n    const values = { ...formValues,\n      id: data.gateway.uid\n    };\n\n    try {\n      if (values.type === GENERIC_FORM) {\n        await saveGenericGateway(values);\n      }\n\n      if (values.type === BULK_SMS_FORM) {\n        await saveBulkSMSGateway(values);\n      }\n\n      if (values.type === CLICKATELL_FORM) {\n        await saveClickatellGateway(values);\n      }\n\n      history.push(GATEWAY_CONFIG_LIST_PATH);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n\n  const hasGateway = data?.gateway;\n  return <div data-test={dataTest('views-gatewayconfigformedit')}>\n            <PageHeadline>{i18n.t('Edit gateway')}</PageHeadline>\n            {hasGateway ? <div data-test={dataTest('views-gatewayconfigformedit-formcontainer')} data-gateway-id={data.gateway.uid}>\n                    {saveError && <NoticeBox error title={i18n.t('Something went wrong whilst saving gateways')}>\n                            {saveError.message}\n                        </NoticeBox>}\n\n                    {gatewayType === GENERIC_FORM && <GatewayGenericForm initialValues={data.gateway} onSubmit={onSubmit} />}\n\n                    {gatewayType === BULK_SMS_FORM && <GatewayBulkSMSForm initialValues={data.gateway} onSubmit={onSubmit} />}\n\n                    {gatewayType === CLICKATELL_FORM && <GatewayClickatellForm initialValues={data.gateway} onSubmit={onSubmit} />}\n                </div> : <NoticeBox error title={i18n.t('Gateway not found')}>\n                    {i18n.t('The requested gateway could not be loaded')}\n                </NoticeBox>}\n        </div>;\n};","import { Button, ButtonStrip, Checkbox, Table, TableHead, TableBody, TableRowHead, TableCellHead, TableRow, TableCell } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport { useHistory } from 'react-router-dom';\nimport React from 'react';\nimport { GATEWAY_CONFIG_FORM_EDIT_PATH_STATIC } from '../views/gateway_configuration/GatewayConfigFormEdit';\nimport { dataTest } from '../dataTest';\nimport { getTypeLabelByType } from './getTypeLabelByType';\nimport i18n from '../locales';\nexport const GatewaysTable = ({\n  allGatewaysChecked,\n  checkedGateways,\n  gateways,\n  onGatewayToggle,\n  onToggleAll,\n  onMakeDefaultClick\n}) => {\n  const history = useHistory();\n  return <Table dataTest={dataTest('gateways-gatewaystable')}>\n            <TableHead>\n                <TableRowHead>\n                    <TableCellHead dataTest={dataTest('gateways-gatewaystable-checkall')}>\n                        <Checkbox onChange={onToggleAll} checked={allGatewaysChecked} />\n                    </TableCellHead>\n                    <TableCellHead>{i18n.t('Name')}</TableCellHead>\n                    <TableCellHead>{i18n.t('Type')}</TableCellHead>\n                    <TableCellHead>{i18n.t('Default gateway')}</TableCellHead>\n                    <TableCellHead />\n                </TableRowHead>\n            </TableHead>\n\n            <TableBody>\n                {gateways.map(gateway => <TableRow key={gateway.uid} dataTest={dataTest('gateways-gatewaystable-row')}>\n                        <TableCell dataTest={dataTest('gateways-gatewaystable-checkbox')}>\n                            <Checkbox value={gateway.uid} onChange={() => onGatewayToggle(gateway.uid)} checked={checkedGateways.includes(gateway.uid)} dataTest={dataTest('gateways-gatewaystable-id')} />\n                        </TableCell>\n\n                        <TableCell dataTest={dataTest('gateways-gatewaystable-name')}>\n                            {gateway.name}\n                        </TableCell>\n\n                        <TableCell dataTest={dataTest('gateways-gatewaystable-type')}>\n                            {getTypeLabelByType(gateway.type)}\n                        </TableCell>\n\n                        <TableCell dataTest={dataTest('gateways-gatewaystable-isdefault')}>\n                            {gateway.isDefault ? i18n.t('Yes') : i18n.t('No')}\n                        </TableCell>\n\n                        <TableCell dataTest={dataTest('gateways-gatewaystable-actions')}>\n                            <ButtonStrip>\n                                {!gateway.isDefault && <Button dataTest={dataTest('gateways-gatewaystable-makedefault')} onClick={() => onMakeDefaultClick(gateway.uid)}>\n                                        {i18n.t('Make default')}\n                                    </Button>}\n\n                                <Button dataTest={dataTest('gateways-gatewaystable-edit')} onClick={() => {\n              history.push(`${GATEWAY_CONFIG_FORM_EDIT_PATH_STATIC}/${gateway.uid}`);\n            }}>\n                                    {i18n.t('Edit')}\n                                </Button>\n                            </ButtonStrip>\n                        </TableCell>\n                    </TableRow>)}\n            </TableBody>\n        </Table>;\n};\nGatewaysTable.propTypes = {\n  checkedGateways: PropTypes.arrayOf(PropTypes.string).isRequired,\n  gateways: PropTypes.arrayOf(PropTypes.shape({\n    isDefault: PropTypes.bool.isRequired,\n    name: PropTypes.string.isRequired,\n    type: PropTypes.string.isRequired,\n    uid: PropTypes.string.isRequired\n  })).isRequired,\n  onGatewayToggle: PropTypes.func.isRequired,\n  onMakeDefaultClick: PropTypes.func.isRequired,\n  onToggleAll: PropTypes.func.isRequired,\n  allGatewaysChecked: PropTypes.bool\n};","import i18n from '../locales';\n/**\n * @param {string} type\n * @returns {string}\n */\n\nexport const getTypeLabelByType = type => {\n  if (type === 'bulksms') {\n    return i18n.t('BulkSMS');\n  }\n\n  if (type === 'clickatell') {\n    return i18n.t('Clickatell');\n  }\n\n  if (type === 'http' || !type) {\n    return i18n.t('Generic');\n  }\n\n  return type;\n};","import { CircularLoader } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { GatewaysTable } from './GatewaysTable';\nimport { dataTest } from '../dataTest';\nimport styles from './GatewayList.module.css';\nexport const GatewayList = ({\n  checkedGateways,\n  gateways,\n  setCheckedGateways,\n  onMakeDefaultClick,\n  processing\n}) => {\n  const allGatewaysChecked = checkedGateways.length === gateways.length;\n\n  const toggleGateway = id => {\n    if (checkedGateways.includes(id)) {\n      const index = checkedGateways.findIndex(curId => curId === id);\n      const newCheckedGateways = index === 0 ? checkedGateways.slice(1) : [...checkedGateways.slice(0, index), ...checkedGateways.slice(index + 1)];\n      setCheckedGateways(newCheckedGateways);\n    } else {\n      setCheckedGateways([...checkedGateways, id]);\n    }\n  };\n\n  const toggleAll = () => {\n    if (!allGatewaysChecked) {\n      const allGatewayIds = gateways.map(({\n        uid\n      }) => uid);\n      setCheckedGateways(allGatewayIds);\n    } else {\n      setCheckedGateways([]);\n    }\n  };\n\n  return <div className={styles.container} data-test={dataTest('gateways-gatewaylist')}>\n            {processing && <div className={styles.processingMessage}>\n                    <div className={styles.loadingContainer}>\n                        <CircularLoader />\n                    </div>\n                </div>}\n\n            <GatewaysTable allGatewaysChecked={allGatewaysChecked} gateways={gateways} checkedGateways={checkedGateways} onGatewayToggle={toggleGateway} onMakeDefaultClick={onMakeDefaultClick} onToggleAll={toggleAll} />\n        </div>;\n};\nGatewayList.propTypes = {\n  checkedGateways: PropTypes.arrayOf(PropTypes.string).isRequired,\n  gateways: PropTypes.arrayOf(PropTypes.shape({\n    name: PropTypes.string.isRequired,\n    type: PropTypes.string.isRequired,\n    uid: PropTypes.string.isRequired,\n    isDefault: PropTypes.bool\n  })).isRequired,\n  setCheckedGateways: PropTypes.func.isRequired,\n  onMakeDefaultClick: PropTypes.func.isRequired,\n  processing: PropTypes.bool\n};","export const GENERIC_FORM = 'http';\nexport const BULK_SMS_FORM = 'bulksms';\nexport const CLICKATELL_FORM = 'clickatell';","import { useDataMutation } from '@dhis2/app-runtime';\nexport const CREATE_BULK_SMS_GATEWAY_MUTATION = {\n  resource: 'gateways',\n  type: 'create',\n  data: ({\n    name,\n    username,\n    password\n  }) => ({\n    type: 'bulksms',\n    name,\n    username,\n    password\n  })\n};\nexport const useCreateBulkSMSGatewayMutation = () => useDataMutation(CREATE_BULK_SMS_GATEWAY_MUTATION);","import { useDataMutation } from '@dhis2/app-runtime';\nexport const CREATE_CLICKATELL_GATEWAY_MUTATION = {\n  resource: 'gateways',\n  type: 'create',\n  data: ({\n    name,\n    username,\n    authtoken,\n    urlTemplate\n  }) => ({\n    type: 'clickatell',\n    name,\n    username,\n    authtoken,\n    urlTemplate\n  })\n};\nexport const useCreateClickatellGatewayMutation = () => useDataMutation(CREATE_CLICKATELL_GATEWAY_MUTATION);","import { useDataMutation } from '@dhis2/app-runtime';\n/**\n * This the shape of the additional fields\n * that can be added to a generic config\n *\n * @typedef {Object} Parameter\n * @prop {string} key\n * @prop {string} value\n * @prop {bool} header\n * @prop {bool} encode\n * @prop {bool} confidential\n */\n\n/**\n * @param {Object} args\n * @param {string} args.name\n * @param {string} args.urlTemplate\n * @param {Parameter[]} args.parameters\n *\n * @returns {Object}\n */\n\nconst createDataFromVariables = ({\n  name,\n  urlTemplate,\n  parameters\n}) => ({\n  type: 'http',\n  name,\n  urlTemplate,\n  parameters\n});\n\nexport const CREATE_GENERIC_GATEWAY_MUTATION = {\n  resource: 'gateways',\n  type: 'create',\n  data: createDataFromVariables\n};\nexport const useCreateGenericGatewayMutation = () => useDataMutation(CREATE_GENERIC_GATEWAY_MUTATION);","import { useState } from 'react';\nimport { useDataEngine } from '@dhis2/app-runtime';\nexport const DELETE_GATEWAY_MUTATION = {\n  resource: 'gateways',\n  type: 'delete',\n  id: ({\n    id\n  }) => id\n};\n\nconst idToMutationRequestFactory = engine => id => {\n  const variables = {\n    id\n  };\n  return engine.mutate(DELETE_GATEWAY_MUTATION, {\n    variables\n  });\n};\n\nexport const useDeleteGatewaysMutation = () => {\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const engine = useDataEngine();\n  const idToMutationRequest = idToMutationRequestFactory(engine);\n\n  const onStart = () => setLoading(true);\n\n  const onDone = response => {\n    setLoading(false);\n    return response;\n  };\n\n  const onError = error => {\n    setError(error);\n    setLoading(false);\n  };\n\n  const mutate = ({\n    ids\n  }) => {\n    onStart();\n    return Promise.all(ids.map(idToMutationRequest)).then(onDone).catch(onError);\n  };\n\n  return [mutate, {\n    loading,\n    error\n  }];\n};","import { useDataQuery } from '@dhis2/app-runtime';\n/**\n * @TODO:\n *   * The \"fields\" param does not work\n *     -> https://jira.dhis2.org/browse/DHIS2-9241\n *   * id field is not present, only uid\n *     -> https://jira.dhis2.org/browse/DHIS2-9249\n *   * Api does not return password of BulkSMS gateway configs\n *     -> https://jira.dhis2.org/browse/DHIS2-9248\n */\n\nexport const GATEWAY_QUERY = {\n  gateway: {\n    resource: 'gateways',\n    id: ({\n      id\n    }) => id\n  }\n};\nexport const useReadGatewayQuery = id => useDataQuery(GATEWAY_QUERY, {\n  variables: {\n    id\n  }\n});","import { useDataQuery } from '@dhis2/app-runtime';\n/**\n * @TODO:\n *   * The endpoint requires a `.json`, ignores \"Accept\" header\n *     -> https://jira.dhis2.org/browse/DHIS2-9250\n *   * The \"fields\" param does not work\n *     -> https://jira.dhis2.org/browse/DHIS2-9241\n *   * id field is not present, only uid\n *     -> https://jira.dhis2.org/browse/DHIS2-9249\n */\n\nexport const GATEWAYS_QUERY = {\n  gateways: {\n    resource: 'gateways.json',\n    params: ({\n      fields,\n      filter\n    }) => {\n      const params = {};\n\n      if (fields) {\n        params.fields = fields;\n      }\n\n      if (filter) {\n        params.filter = filter;\n      }\n\n      return params;\n    }\n  }\n};\n/**\n * @param {string[]} [ids]\n * @return {Object}\n */\n\nexport const useReadGatewaysQuery = ids => {\n  /*\n   * @TODO(filtering): Currently the `id:in:[...]` doesn't work\n   *   -> https://jira.dhis2.org/browse/DHIS2-9259\n   *\n   * This is because filtering doesn't work right now\n   * So there's no need for sending any variables\n   */\n  const filter = `id:in:[${ids?.join(',')}]`;\n  const variables = false && ids ? {\n    filter\n  } : {}; // eslint-disable-line no-constant-condition\n\n  const {\n    data: jsonData,\n    ...rest\n  } = useDataQuery(GATEWAYS_QUERY, {\n    variables\n  });\n  const parsedData =\n  /**\n   * @TODO:\n   *   Create Jira issue for:\n   *   The response does not contain the right content type header\n   */\n  jsonData && typeof jsonData.gateways === 'string' ? {\n    gateways: JSON.parse(jsonData.gateways)\n  } : jsonData;\n  const data = ids && parsedData?.gateways?.gateways ? {\n    gateways: {\n      gateways: parsedData.gateways.gateways.filter(({\n        uid\n      }) => ids.includes(uid))\n    }\n  } : parsedData;\n  return {\n    data,\n    ...rest\n  };\n};","import { useDataMutation } from '@dhis2/app-runtime';\nexport const SET_DEFAULT_GATEWAY_MUTATION = {\n  resource: 'gateways/default',\n  type: 'replace',\n  id: ({\n    id\n  }) => id\n};\nexport const useSetDefaultGatewayMutation = () => useDataMutation(SET_DEFAULT_GATEWAY_MUTATION);","import { useState } from 'react';\nimport { useDataEngine } from '@dhis2/app-runtime';\n/**\n * @TODO\n *   * Create jira issue: Make `useDataMutation` accept function for \"id\"\n */\n\n/**\n * @param {Object} query\n * @returns {Object}\n */\n\nexport const useUpdateGatewayMutation = query => {\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const engine = useDataEngine();\n\n  const doFetch = variables => {\n    const updatedQuery = { ...query,\n      id: variables.id\n    };\n    setLoading(true);\n    setError(null);\n    return engine.mutate(updatedQuery, {\n      variables\n    }).then(data => {\n      setLoading(false);\n      return data;\n    }).catch(error => {\n      setLoading(false);\n      setError(error);\n      throw error;\n    });\n  };\n\n  return [doFetch, {\n    loading,\n    error\n  }];\n};","import { useUpdateGatewayMutation } from './useUpdateGatewayMutation';\nexport const UPDATE_BULK_SMS_GATEWAY_MUTATION = {\n  resource: 'gateways',\n  id: ({\n    id\n  }) => id,\n  type: 'update',\n  data: ({\n    name,\n    username,\n    password\n  }) => ({\n    type: 'bulksms',\n    name,\n    username,\n    password\n  })\n};\nexport const useUpdateBulkSMSGatewayMutation = () => useUpdateGatewayMutation(UPDATE_BULK_SMS_GATEWAY_MUTATION);","import { useUpdateGatewayMutation } from './useUpdateGatewayMutation';\nexport const UPDATE_CLICKATELL_GATEWAY_MUTATION = {\n  resource: 'gateways',\n  id: ({\n    id\n  }) => id,\n  type: 'update',\n  data: ({\n    name,\n    username,\n    authtoken,\n    urlTemplate\n  }) => ({\n    type: 'clickatell',\n    name,\n    username,\n    authtoken,\n    urlTemplate\n  })\n};\nexport const useUpdateClickatellGatewayMutation = () => useUpdateGatewayMutation(UPDATE_CLICKATELL_GATEWAY_MUTATION);","import { useUpdateGatewayMutation } from './useUpdateGatewayMutation';\n/**\n * This the shape of the additional fields\n * that can be added to a generic config\n *\n * @typedef {Object} Parameter\n * @prop {string} key\n * @prop {string} value\n * @prop {bool} header\n * @prop {bool} encode\n * @prop {bool} confidential\n */\n\n/**\n * @param {Object} args\n * @param {string} args.name\n * @param {string} args.urlTemplate\n * @param {Parameter[]} args.parameters\n *\n * @returns {Object}\n */\n\nconst updateDataFromVariables = ({\n  name,\n  urlTemplate,\n  parameters\n}) => ({\n  type: 'http',\n  name,\n  urlTemplate,\n  parameters\n});\n\nexport const UPDATE_GENERIC_GATEWAY_MUTATION = {\n  resource: 'gateways',\n  id: ({\n    id\n  }) => id,\n  type: 'replace',\n  data: updateDataFromVariables\n};\nexport const useUpdateGenericGatewayMutation = () => useUpdateGatewayMutation(UPDATE_GENERIC_GATEWAY_MUTATION);","import { SingleSelectField, SingleSelectOption, NoticeBox } from '@dhis2/ui';\nimport { useHistory } from 'react-router-dom';\nimport React, { useState } from 'react';\nimport { GATEWAY_CONFIG_LIST_PATH } from './GatewayConfigList';\nimport { GENERIC_FORM, BULK_SMS_FORM, CLICKATELL_FORM } from '../../gateways';\nimport { FormRow } from '../../forms';\nimport { PageHeadline } from '../../headline';\nimport { dataTest } from '../../dataTest';\nimport { GatewayBulkSMSForm, GatewayClickatellForm, GatewayGenericForm, useCreateBulkSMSGatewayMutation, useCreateClickatellGatewayMutation, useCreateGenericGatewayMutation } from '../../gateways';\nimport i18n from '../../locales';\nexport const GATEWAY_CONFIG_FORM_NEW_PATH = '/sms-gateway/new';\nexport const GatewayConfigFormNew = () => {\n  const history = useHistory();\n  const [visibleForm, setVisibleForm] = useState(GENERIC_FORM);\n  const [saveGenericGateway, {\n    error: saveGenericGatewayError\n  }] = useCreateGenericGatewayMutation();\n  const [saveBulkSMSGateway, {\n    error: saveBulkSMSGatewayError\n  }] = useCreateBulkSMSGatewayMutation();\n  const [saveClickatellGateway, {\n    error: saveClickatellGatewayError\n  }] = useCreateClickatellGatewayMutation();\n  const error = saveGenericGatewayError || saveBulkSMSGatewayError || saveClickatellGatewayError;\n\n  if (error) {\n    const msg = i18n.t('Something went wrong whilst saving the gateway');\n    return <div data-test={dataTest('views-gatewayconfigformnew')}>\n                <PageHeadline>{i18n.t('Add gateway')}</PageHeadline>\n                <NoticeBox error title={msg}>\n                    {error.message}\n                </NoticeBox>\n            </div>;\n  }\n\n  const onSubmit = async values => {\n    try {\n      if (visibleForm === GENERIC_FORM) {\n        await saveGenericGateway(values);\n      }\n\n      if (visibleForm === BULK_SMS_FORM) {\n        await saveBulkSMSGateway(values);\n      }\n\n      if (visibleForm === CLICKATELL_FORM) {\n        await saveClickatellGateway(values);\n      }\n\n      history.push(GATEWAY_CONFIG_LIST_PATH);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n\n  return <div data-test={dataTest('views-gatewayconfigformnew')}>\n            <PageHeadline>{i18n.t('Add gateway')}</PageHeadline>\n\n            <FormRow>\n                <SingleSelectField label={i18n.t('Type')} onChange={({\n        selected\n      }) => setVisibleForm(selected)} selected={visibleForm} dataTest={dataTest('views-gatewayconfigformnew-gatewaytype')}>\n                    <SingleSelectOption value={GENERIC_FORM} label={i18n.t('Generic')} />\n\n                    <SingleSelectOption value={BULK_SMS_FORM} label={i18n.t('BulkSMS')} />\n\n                    <SingleSelectOption value={CLICKATELL_FORM} label={i18n.t('Clickatell')} />\n                </SingleSelectField>\n            </FormRow>\n\n            <FormRow>\n                {visibleForm === GENERIC_FORM && <GatewayGenericForm onSubmit={onSubmit} />}\n\n                {visibleForm === BULK_SMS_FORM && <GatewayBulkSMSForm onSubmit={onSubmit} passwordRequired={true} />}\n\n                {visibleForm === CLICKATELL_FORM && <GatewayClickatellForm onSubmit={onSubmit} passwordRequired={true} />}\n            </FormRow>\n        </div>;\n};","import { ButtonStrip, Button } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { dataTest } from '../dataTest';\nimport styles from './ListActions.module.css';\nexport const ListActions = ({\n  addLabel,\n  deleteLabel,\n  dataTest: dataTestProp,\n  onAddClick,\n  onDeleteClick,\n  disableAdd,\n  disableDelete\n}) => {\n  return <div className={styles.container}>\n            <ButtonStrip data-test={dataTest(`${dataTestProp}-actions`)}>\n                <Button primary onClick={onAddClick} disabled={disableAdd} dataTest={dataTest(`${dataTestProp}-add`)}>\n                    {addLabel}\n                </Button>\n\n                <Button destructive onClick={onDeleteClick} disabled={disableDelete} dataTest={dataTest(`${dataTestProp}-delete`)}>\n                    {deleteLabel}\n                </Button>\n            </ButtonStrip>\n        </div>;\n};\nListActions.propTypes = {\n  addLabel: PropTypes.string.isRequired,\n  dataTest: PropTypes.string.isRequired,\n  deleteLabel: PropTypes.string.isRequired,\n  onAddClick: PropTypes.func.isRequired,\n  onDeleteClick: PropTypes.func.isRequired,\n  disableAdd: PropTypes.bool,\n  disableDelete: PropTypes.bool\n};","import { useHistory } from 'react-router-dom';\nimport React, { useState } from 'react';\nimport { NoticeBox, CenteredContent, CircularLoader } from '@dhis2/ui';\nimport { GATEWAY_CONFIG_FORM_NEW_PATH } from './GatewayConfigFormNew';\nimport { DeleteGatewaysConfirmationDialog, GatewayList, useDeleteGatewaysMutation, useReadGatewaysQuery, useSetDefaultGatewayMutation } from '../../gateways';\nimport { ListActions } from '../../dataList';\nimport { PageHeadline } from '../../headline';\nimport { dataTest } from '../../dataTest';\nimport i18n from '../../locales';\nimport styles from './GatewayConfigList.module.css';\nexport const GATEWAY_CONFIG_LIST_PATH = '/sms-gateway';\nexport const GATEWAY_CONFIG_LIST_LABEL = 'Gateway configuration';\nexport const GatewayConfigList = () => {\n  const history = useHistory();\n\n  const onAddGatewayClick = () => history.push(GATEWAY_CONFIG_FORM_NEW_PATH);\n\n  const [checkedGateways, setCheckedGateways] = useState([]);\n  const [showDeleteDialog, setShowDeleteDialog] = useState(false);\n  const {\n    loading: loadingReadGateways,\n    error: errorReadGateways,\n    data,\n    refetch: refetchReadGateways\n  } = useReadGatewaysQuery();\n  const [deleteCheckedGateways, {\n    loading: loadingDelete,\n    error: errorDelete\n  }] = useDeleteGatewaysMutation();\n  const [makeGatewayDefault, {\n    loading: loadingSetDefault,\n    error: errorSetDefault\n  }] = useSetDefaultGatewayMutation();\n\n  const onDeleteClick = () => {\n    const variables = {\n      ids: checkedGateways\n    };\n    deleteCheckedGateways(variables).then(refetchReadGateways);\n    setShowDeleteDialog(false);\n  };\n\n  const onMakeDefaultClick = id => {\n    const variables = {\n      id\n    };\n    makeGatewayDefault(variables).then(refetchReadGateways);\n  };\n\n  const loading = loadingReadGateways || loadingDelete || loadingSetDefault;\n\n  if (loading) {\n    return <>\n                <PageHeadline>{GATEWAY_CONFIG_LIST_LABEL}</PageHeadline>\n                <CenteredContent>\n                    <CircularLoader />\n                </CenteredContent>\n            </>;\n  }\n\n  const error = errorReadGateways || errorDelete || errorSetDefault;\n\n  if (error) {\n    const msg = i18n.t('Something went wrong whilst performing the requested operation');\n    return <>\n                <PageHeadline>{GATEWAY_CONFIG_LIST_LABEL}</PageHeadline>\n                <NoticeBox error title={msg}>\n                    {error.message}\n                </NoticeBox>\n            </>;\n  }\n\n  const hasGateways = !!data?.gateways?.gateways?.length;\n  return <div className={styles.container} data-test={dataTest('views-gatewayconfiglist')}>\n            <PageHeadline>{GATEWAY_CONFIG_LIST_LABEL}</PageHeadline>\n\n            <p>\n                {i18n.t('There are five different types of gateways supported by the SMS service. SMSes can be sent if at least one of the gateway types has been configured. If more than one gateway has been configured they will all be used in a round-robin fashion for load balancing')}\n            </p>\n\n            <ListActions addLabel={i18n.t('Add gateway')} deleteLabel={i18n.t('Delete selected')} dataTest=\"views-gatewayconfiglist\" onAddClick={onAddGatewayClick} onDeleteClick={() => setShowDeleteDialog(true)} disableAdd={loadingDelete} disableDelete={!checkedGateways.length || loadingDelete} />\n\n            {hasGateways ? <GatewayList processing={loading} checkedGateways={checkedGateways} setCheckedGateways={setCheckedGateways} gateways={data.gateways.gateways} onMakeDefaultClick={onMakeDefaultClick} /> : <NoticeBox info title={i18n.t('No gateways found')}>\n                    {i18n.t(\"It looks like there aren't any configured gateways, or they couldn't be loaded.\")}\n                </NoticeBox>}\n\n            {showDeleteDialog && <DeleteGatewaysConfirmationDialog onCancelClick={() => setShowDeleteDialog(false)} onDeleteClick={onDeleteClick} />}\n        </div>;\n};","import i18n from '@dhis2/d2-i18n';\nexport const RECEIVED_SMS_LIST_LABEL = i18n.t('Received');\nexport const RECEIVED_SMS_LIST_PATH = '/received';\nexport const STATUS_ALL = 'ALL'; // dhis-2/dhis-api/src/main/java/org/hisp/dhis/sms/incoming/SmsMessageStatus.java\n\nexport const STATUS_FILTER_OPTIONS = [{\n  value: STATUS_ALL,\n  label: i18n.t('All')\n}, {\n  value: 'FAILED',\n  label: i18n.t('Failed')\n}, {\n  value: 'INCOMING',\n  label: i18n.t('Incoming')\n}, {\n  value: 'PROCESSED',\n  label: i18n.t('Processed')\n}, {\n  value: 'PROCESSING',\n  label: i18n.t('Processing')\n}, {\n  value: 'SENT',\n  label: i18n.t('Sent')\n}, {\n  value: 'UNHANDLED',\n  label: i18n.t('Unhandled')\n}];","import { useLocation } from 'react-router-dom';\nimport { STATUS_ALL } from './config';\nexport const useQueryParams = () => {\n  const searchParams = new URLSearchParams(useLocation().search);\n  return {\n    status: searchParams.get('status') || STATUS_ALL,\n    phoneNumber: searchParams.get('phoneNumber') || '',\n    page: parseInt(searchParams.get('page') || 1),\n    pageSize: parseInt(searchParams.get('pageSize') || 50)\n  };\n};","import { STATUS_ALL } from './config';\nexport const createSearchString = query => {\n  const queryString = Object.keys(query).reduce((acc, paramKey) => {\n    const paramValue = query[paramKey];\n    const isDefaultStatus = paramKey === 'status' && paramValue === STATUS_ALL;\n\n    if (paramValue && !isDefaultStatus) {\n      acc.push(`${paramKey}=${paramValue}`);\n    }\n\n    return acc;\n  }, []).join('&');\n  return `?${queryString}`;\n};","import React from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { PropTypes } from '@dhis2/prop-types';\nimport i18n from '@dhis2/d2-i18n';\nimport { dataTest } from '../../dataTest';\nimport { Button, InputFieldFF, ReactFinalForm, SingleSelectFieldFF } from '@dhis2/ui';\nimport { STATUS_FILTER_OPTIONS } from './config';\nimport { useQueryParams } from './useQueryParams';\nimport { createSearchString } from './createSearchString';\nimport styles from './Filter.module.css';\nconst {\n  Form,\n  Field\n} = ReactFinalForm;\n\nconst Filter = ({\n  loading\n}) => {\n  const {\n    status,\n    phoneNumber,\n    pageSize\n  } = useQueryParams();\n  const initialValues = {\n    status,\n    phoneNumber\n  };\n  const history = useHistory();\n\n  const navigateToFilteredUrl = ({\n    status,\n    phoneNumber\n  }) => {\n    history.push({\n      search: createSearchString({\n        status,\n        phoneNumber,\n        pageSize,\n        page: 1\n      })\n    });\n  };\n\n  return <div data-test={dataTest('views-receivedsms-filter')} className={styles.container}>\n            <Form onSubmit={navigateToFilteredUrl} initialValues={initialValues}>\n                {({\n        handleSubmit,\n        pristine\n      }) => <form onSubmit={handleSubmit} className={styles.inputStrip}>\n                        <Field name=\"status\" component={SingleSelectFieldFF} options={STATUS_FILTER_OPTIONS} label={i18n.t('Filter by status')} inputWidth=\"200px\" />\n                        <Field name=\"phoneNumber\" component={InputFieldFF} label={i18n.t('Filter by phone number')} className={styles.phoneNumberField} inputWidth=\"300px\" />\n                        <Button large type=\"submit\" disabled={loading || pristine}>\n                            {i18n.t('Filter')}\n                        </Button>\n                    </form>}\n            </Form>\n        </div>;\n};\n\nFilter.propTypes = {\n  loading: PropTypes.bool\n};\nexport { Filter };","import React, { useContext } from 'react';\nimport { PropTypes } from '@dhis2/prop-types';\nimport i18n from '@dhis2/d2-i18n';\nimport { useDataMutation } from '@dhis2/app-runtime';\nimport { Button } from '@dhis2/ui';\nimport { AlertContext } from '../../notifications';\nconst mutation = {\n  resource: 'sms/inbound',\n  type: 'delete',\n  params: ({\n    ids\n  }) => ({\n    ids\n  })\n};\n\nconst DeleteSelectedButton = ({\n  selectedIds,\n  onComplete\n}) => {\n  const {\n    addAlert\n  } = useContext(AlertContext);\n  const [mutate] = useDataMutation(mutation, {\n    onComplete,\n    onError: error => {\n      addAlert({\n        type: 'critical',\n        message: error.message\n      });\n    }\n  });\n  return <Button destructive onClick={() => mutate({\n    ids: selectedIds.join()\n  })} disabled={selectedIds.length === 0}>\n            {i18n.t('Delete selected')}\n        </Button>;\n};\n\nDeleteSelectedButton.propTypes = {\n  onComplete: PropTypes.func.isRequired,\n  selectedIds: PropTypes.arrayOf(PropTypes.string)\n};\nexport { DeleteSelectedButton };","import React from 'react';\nimport { PropTypes } from '@dhis2/prop-types';\nimport i18n from '@dhis2/d2-i18n';\nimport { useHistory } from 'react-router-dom';\nimport { Button, SingleSelect, SingleSelectOption } from '@dhis2/ui';\nimport { useQueryParams } from './useQueryParams';\nimport { createSearchString } from './createSearchString';\nimport styles from './Pagination.module.css';\nconst PAGE_LENGTHS = ['1', '2', '10', '20', '30', '40', '50', '100'];\n\nconst Pagination = ({\n  page,\n  pageCount,\n  pageSize,\n  total\n}) => {\n  const firstItem = Math.min((page - 1) * pageSize + 1, total);\n  const lastItem = Math.min(firstItem + pageSize - 1, total);\n  const availablePages = Array.from({\n    length: pageCount\n  }, (_x, i) => (i + 1).toString());\n  const {\n    status,\n    phoneNumber\n  } = useQueryParams();\n  const history = useHistory();\n\n  const navigateToPage = newPage => {\n    history.push({\n      search: createSearchString({\n        status,\n        phoneNumber,\n        pageSize,\n        page: newPage\n      })\n    });\n  };\n\n  const navigateToNewPageSize = ({\n    selected\n  }) => {\n    history.push({\n      search: createSearchString({\n        status,\n        phoneNumber,\n        pageSize: selected,\n        page: 1\n      })\n    });\n  };\n\n  return <div className={styles.container}>\n            <div className={styles.verticalAlign}>\n                {i18n.t('Show')}\n                <SingleSelect dense selected={pageSize.toString()} onChange={navigateToNewPageSize} className={styles.select}>\n                    {PAGE_LENGTHS.map(length => <SingleSelectOption key={length} value={length} label={length} />)}\n                </SingleSelect>\n                {i18n.t('per page')}\n            </div>\n\n            <div className={styles.verticalAlign}>\n                <span className={styles.summary}>\n                    {i18n.t('Viewing {{firstItem}}-{{lastItem}} of {{total}}', {\n          firstItem,\n          lastItem,\n          total\n        })}\n                </span>\n                <Button className={styles.buttonPrevious} small disabled={page === 1} onClick={() => navigateToPage(page - 1)}>\n                    {i18n.t('Previous')}\n                </Button>\n                <span>{i18n.t('Page')}</span>\n                <SingleSelect dense inputWidth=\"600px\" selected={page.toString()} onChange={({\n        selected\n      }) => navigateToPage(selected)} className={styles.select}>\n                    {availablePages.map(availablePage => <SingleSelectOption key={availablePage} value={availablePage} label={availablePage} />)}\n                </SingleSelect>\n                <span>{i18n.t('of {{pageCount}}', {\n          pageCount\n        })}</span>\n                <Button className={styles.buttonNext} small disabled={page === pageCount} onClick={() => navigateToPage(page + 1)}>\n                    {i18n.t('Next')}\n                </Button>\n            </div>\n        </div>;\n};\n\nPagination.propTypes = {\n  page: PropTypes.number,\n  pageCount: PropTypes.number,\n  pageSize: PropTypes.number,\n  total: PropTypes.number\n};\nexport { Pagination };","import React, { useContext } from 'react';\nimport { PropTypes } from '@dhis2/prop-types';\nimport i18n from '@dhis2/d2-i18n';\nimport { useDataMutation } from '@dhis2/app-runtime';\nimport { Button } from '@dhis2/ui';\nimport { AlertContext } from '../../notifications';\nconst mutation = {\n  resource: 'sms/inbound',\n  id: ({\n    id\n  }) => id,\n  type: 'delete'\n};\n\nconst DeleteSmsButton = ({\n  id,\n  onComplete\n}) => {\n  const {\n    addAlert\n  } = useContext(AlertContext);\n  const [mutate, {\n    loading,\n    error\n  }] = useDataMutation(mutation, {\n    onComplete,\n    onError: error => {\n      addAlert({\n        type: 'critical',\n        message: error.message\n      });\n    },\n    variables: {\n      id\n    }\n  });\n  return <Button small destructive onClick={mutate} disabled={loading || error}>\n            {i18n.t('Delete')}\n        </Button>;\n};\n\nDeleteSmsButton.propTypes = {\n  onComplete: PropTypes.func.isRequired,\n  id: PropTypes.string\n};\nexport { DeleteSmsButton };","import React from 'react';\nimport { PropTypes } from '@dhis2/prop-types';\nimport i18n from '@dhis2/d2-i18n';\nimport moment from 'moment';\nimport { Checkbox, Table, TableBody, TableCell, TableCellHead, TableFoot, TableHead, TableRow, TableRowHead } from '@dhis2/ui';\nimport { Pagination } from './Pagination';\nimport styles from './SmsTable.module.css';\nimport { DeleteSmsButton } from './DeleteSmsButton';\n\nconst SmsTable = ({\n  messages,\n  pager,\n  refetchList,\n  selectedIds,\n  setSelectedIds\n}) => {\n  const selectedIdSet = new Set(selectedIds);\n  const allSelected = messages.length > 0 && selectedIds.length === messages.length;\n\n  const toggle = id => {\n    if (selectedIdSet.has(id)) {\n      selectedIdSet.delete(id);\n    } else {\n      selectedIdSet.add(id);\n    }\n\n    setSelectedIds(Array.from(selectedIdSet));\n  };\n\n  const toggleAll = () => {\n    if (allSelected) {\n      setSelectedIds([]);\n    } else {\n      setSelectedIds(messages.map(({\n        id\n      }) => id));\n    }\n  };\n\n  return <Table>\n            <TableHead>\n                <TableRowHead>\n                    <TableCellHead>\n                        <Checkbox checked={allSelected} onChange={toggleAll} />\n                    </TableCellHead>\n                    <TableCellHead>{i18n.t('Message')}</TableCellHead>\n                    <TableCellHead>{i18n.t('Phone number')}</TableCellHead>\n                    <TableCellHead>{i18n.t('Status')}</TableCellHead>\n                    <TableCellHead>{i18n.t('Sender')}</TableCellHead>\n                    <TableCellHead>{i18n.t('Date')}</TableCellHead>\n                    <TableCellHead>{i18n.t('Delete')}</TableCellHead>\n                </TableRowHead>\n            </TableHead>\n            <TableBody>\n                {messages.length === 0 ? <TableRow>\n                        <TableCell colSpan=\"7\" className={styles.noResults}>\n                            {i18n.t('No SMSes to display')}\n                        </TableCell>\n                    </TableRow> : messages.map(message => <TableRow key={message.id}>\n                            <TableCell>\n                                <Checkbox checked={selectedIdSet.has(message.id)} onChange={toggle.bind(null, message.id)} />\n                            </TableCell>\n                            <TableCell>{message.text}</TableCell>\n                            <TableCell>{message.originator}</TableCell>\n                            <TableCell>{message.smsstatus}</TableCell>\n                            <TableCell>\n                                {message.user ? message.user.userCredentials.username : i18n.t('Unknown')}\n                            </TableCell>\n                            <TableCell>\n                                {moment(message.receivedDate).format('MMMM Do YYYY, h:mm:ss a')}\n                            </TableCell>\n                            <TableCell>\n                                <DeleteSmsButton destructive small onComplete={refetchList} id={message.id}>\n                                    Delete\n                                </DeleteSmsButton>\n                            </TableCell>\n                        </TableRow>)}\n            </TableBody>\n            <TableFoot>\n                <TableRow>\n                    <TableCell colSpan=\"7\">\n                        <Pagination {...pager} />\n                    </TableCell>\n                </TableRow>\n            </TableFoot>\n        </Table>;\n};\n\nSmsTable.propTypes = {\n  messages: PropTypes.arrayOf(PropTypes.object).isRequired,\n  pager: PropTypes.PropTypes.object.isRequired,\n  refetchList: PropTypes.func.isRequired,\n  selectedIds: PropTypes.arrayOf(PropTypes.string).isRequired,\n  setSelectedIds: PropTypes.func.isRequired\n};\nexport { SmsTable };","import React, { useState, useEffect } from 'react';\nimport { useDataQuery } from '@dhis2/app-service-data';\nimport { NoticeBox, CenteredContent, CircularLoader } from '@dhis2/ui';\nimport i18n from '../../locales';\nimport { dataTest } from '../../dataTest';\nimport { Filter } from './Filter';\nimport { DeleteSelectedButton } from './DeleteSelectedButton';\nimport { SmsTable } from './SmsTable';\nimport { RECEIVED_SMS_LIST_LABEL, RECEIVED_SMS_LIST_PATH } from './config';\nimport { useQueryParams } from './useQueryParams';\nimport styles from './ReceivedSmsList.module.css';\nimport { PageHeadline } from '../../headline';\nconst query = {\n  inboundSms: {\n    resource: 'sms/inbound',\n    params: ({\n      page,\n      pageSize,\n      phoneNumber,\n      status\n    }) => ({\n      page,\n      pageSize,\n      phoneNumber,\n      status,\n      fields: ['id', 'text', 'originator', 'smsstatus', 'user[userCredentials[username]]', // sender\n      'receiveddate']\n    })\n  }\n};\n\nconst ReceivedSmsList = () => {\n  const [selectedIds, setSelectedIds] = useState([]);\n  const {\n    page,\n    pageSize,\n    phoneNumber,\n    status\n  } = useQueryParams();\n  const {\n    called,\n    loading,\n    error,\n    data,\n    refetch\n  } = useDataQuery(query, {\n    lazy: true\n  });\n\n  const refetchAndClear = () => {\n    refetch();\n    setSelectedIds([]);\n  };\n\n  useEffect(() => {\n    refetch({\n      page,\n      pageSize,\n      phoneNumber,\n      status\n    });\n  }, [page, pageSize, phoneNumber, status]);\n\n  if (loading || !called) {\n    return <>\n                <PageHeadline>{RECEIVED_SMS_LIST_LABEL}</PageHeadline>\n                <CenteredContent>\n                    <CircularLoader />\n                </CenteredContent>\n            </>;\n  }\n\n  if (error) {\n    const msg = i18n.t('Something went wrong whilst loading received SMSes');\n    return <>\n                <PageHeadline>{RECEIVED_SMS_LIST_LABEL}</PageHeadline>\n                <NoticeBox error title={msg}>\n                    {error.message}\n                </NoticeBox>\n            </>;\n  }\n\n  const messages = data?.inboundSms?.inboundsmss || [];\n  return <div data-test={dataTest('views-receivedsmslist')}>\n            <PageHeadline>{RECEIVED_SMS_LIST_LABEL}</PageHeadline>\n            <div className={styles.topBar}>\n                <Filter loading={loading} />\n                <DeleteSelectedButton onComplete={refetchAndClear} selectedIds={selectedIds} />\n            </div>\n            <div>\n                {<SmsTable messages={messages} pager={data.inboundSms.pager} selectedIds={selectedIds} setSelectedIds={setSelectedIds} refetchList={refetch} />}\n            </div>\n        </div>;\n};\n\nexport { ReceivedSmsList, RECEIVED_SMS_LIST_LABEL, RECEIVED_SMS_LIST_PATH };","export const FIELD_COMMAND_COMPLETENESS_METHOD_NAME = 'completenessMethod';\nexport const FIELD_COMMAND_DEFAULT_MESSAGE_NAME = 'defaultMessage';\nexport const FIELD_COMMAND_ID_NAME = 'id';\nexport const FIELD_COMMAND_MORE_THAN_ONE_ORG_UNIT_MESSAGE_NAME = 'moreThanOneOrgUnitMessage';\nexport const FIELD_COMMAND_NAME_NAME = 'name';\nexport const FIELD_COMMAND_NO_USER_MESSAGE_NAME = 'noUserMessage';\nexport const FIELD_COMMAND_PARSER_NAME = 'parserType';\nexport const FIELD_COMMAND_PROGAM_NAME = 'program';\nexport const FIELD_COMMAND_PROGAM_STAGE_NAME = 'programStage';\nexport const FIELD_COMMAND_SEPARATOR_NAME = 'separator';\nexport const FIELD_COMMAND_SMS_CODES_NAME = 'smsCodes';\nexport const FIELD_COMMAND_SPECIAL_CHARS_NAME = 'specialCharacters';\nexport const FIELD_COMMAND_SUCCESS_MESSAGE_NAME = 'successMessage';\nexport const FIELD_COMMAND_USE_CURRENT_PERIOD_FOR_REPORTING_NAME = 'currentPeriodUsedForReporting';\nexport const FIELD_COMMAND_WRONG_FORMAT_MESSAGE_NAME = 'wrongFormatMessage';\nexport const FIELD_COMMAND_CONFIRM_MESSAGE_NAME = 'receivedMessage';","import { Button, ReactFinalForm } from '@dhis2/ui';\nimport React from 'react';\nimport { FIELD_COMMAND_SPECIAL_CHARS_NAME } from './fieldNames';\nimport { FormRow } from '../forms';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  useForm\n} = ReactFinalForm;\nexport const CommandsAddSpecialCharacters = () => {\n  const {\n    change,\n    getState\n  } = useForm();\n\n  const addSpecialKeyFieldsToFormState = () => {\n    const specialChars = getState().values[FIELD_COMMAND_SPECIAL_CHARS_NAME];\n    const newSpecialChars = [...specialChars, {\n      name: '',\n      value: ''\n    }];\n    change(FIELD_COMMAND_SPECIAL_CHARS_NAME, newSpecialChars);\n  };\n\n  return <FormRow>\n            <Button onClick={addSpecialKeyFieldsToFormState} dataTest={dataTest('forms-commandsaddspecialcharacters')}>\n                {i18n.t('Add special character')}\n            </Button>\n        </FormRow>;\n};","import i18n from '../locales/index';\nexport const ALL_DATAVALUE = {\n  value: 'ALL_DATAVALUE',\n  label: i18n.t('Receive all data value')\n};\nexport const AT_LEAST_ONE_DATAVALUE = {\n  value: 'AT_LEAST_ONE_DATAVALUE',\n  label: i18n.t('Receive at least one data value')\n};\nexport const DO_NOT_MARK_COMPLETE = {\n  value: 'DO_NOT_MARK_COMPLETE',\n  label: i18n.t('Do not mark as complete')\n};","import { SingleSelectFieldFF, ReactFinalForm, hasValue } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm; // The \"s\" from \"set\" is not capitalized\n// as the property on the java-model\n// does not have a capitalized \"s\" either\n//\n// @TODO: Create issue to make it consistent\n\nexport const FIELD_DATA_SET_NAME = 'dataset';\nexport const FieldDataSet = ({\n  dataSets,\n  loading,\n  required,\n  disabled,\n  errorText\n}) => <Field disabled={disabled} error={!!errorText} validationText={errorText} required={required} loading={loading} dataTest={dataTest('forms-fielddataset')} name={FIELD_DATA_SET_NAME} label={i18n.t('Dataset')} component={SingleSelectFieldFF} options={dataSets} validate={hasValue} format={value => value?.id || null} parse={id => ({\n  id\n})} />;\nFieldDataSet.defaultProps = {\n  disabled: false,\n  loading: false,\n  required: false,\n  errorText: ''\n};\nFieldDataSet.propTypes = {\n  dataSets: PropTypes.arrayOf(PropTypes.shape({\n    label: PropTypes.string.isRequired,\n    value: PropTypes.string.isRequired\n  })).isRequired,\n  disabled: PropTypes.bool,\n  errorText: PropTypes.string,\n  loading: PropTypes.bool,\n  required: PropTypes.bool\n};","import { useDataQuery } from '@dhis2/app-runtime';\nexport const DATA_SETS_QUERY = {\n  dataSets: {\n    resource: 'dataSets',\n    params: {\n      fields: ['id', 'displayName'],\n      paging: 'false'\n    }\n  }\n};\nexport const useReadDataSetsQuery = () => useDataQuery(DATA_SETS_QUERY);","import { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { FieldDataSet } from './FieldDataSet';\nimport { useReadDataSetsQuery } from './useReadDataSetsQuery';\nexport const FieldDataSetWithAutoLoad = ({\n  required\n}) => {\n  const {\n    loading,\n    error,\n    data\n  } = useReadDataSetsQuery();\n\n  if (loading) {\n    return <FieldDataSet loading showLoadingStatus required={required} dataSets={[]} />;\n  }\n\n  if (error) {\n    return <FieldDataSet required={required} disabled programs={[]} errorText={error.message} />;\n  }\n\n  const {\n    dataSets\n  } = data.dataSets;\n  const options = dataSets.map(({\n    id,\n    displayName\n  }) => ({\n    label: displayName,\n    value: id\n  }));\n  return <FieldDataSet required={required} dataSets={options} />;\n};\nFieldDataSetWithAutoLoad.defaultProps = {\n  required: false\n};\nFieldDataSetWithAutoLoad.propTypes = {\n  required: PropTypes.bool\n};","import { useDataQuery } from '@dhis2/app-runtime';\nexport const DATA_SET_QUERY = {\n  dataSet: {\n    resource: 'dataSets',\n    id: ({\n      id\n    }) => id,\n    params: ({\n      fields = ['id', 'displayName']\n    } = {}) => ({\n      fields\n    })\n  }\n};\nexport const queryDataSet = (engine, variables) => engine.query(DATA_SET_QUERY, {\n  variables\n});\nexport const useReadDataSetQuery = id => useDataQuery(DATA_SET_QUERY, {\n  variables: {\n    id\n  }\n});","import { useDataEngine } from '@dhis2/app-runtime';\nimport { useEffect, useState } from 'react';\nexport const DATA_ELEMENTS_QUERY = {\n  dataElements: {\n    resource: 'dataElements',\n    params: ({\n      ids\n    }) => ({\n      filter: `id:in:[${ids.join(',')}]`,\n      fields: 'id,code,displayName,categoryCombo',\n      paging: 'false'\n    })\n  }\n};\nexport const queryDataElements = (engine, variables) => engine.query(DATA_ELEMENTS_QUERY, {\n  variables\n}).then(data => ({ ...data,\n  dataElements: { ...data.dataElements,\n    dataElements: data.dataElements.dataElements.map(({\n      code,\n      ...rest\n    }) => ({ ...rest,\n      // only the number is needed\n      code: code.replace('DE_', '')\n    }))\n  }\n})); // Not using `useDataQuery` here because the\n// response needs to be formatted\n\nexport const useReadDataElementsQuery = ids => {\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [data, setData] = useState(null);\n  const engine = useDataEngine();\n\n  const refetch = ({\n    ids\n  }) => {\n    setLoading(true);\n    setError(null);\n    return queryDataElements(engine, ids).then(setData).catch(setError).finally(() => setLoading(false));\n  }; // initial request\n\n\n  useEffect(() => {\n    refetch({\n      ids\n    });\n  }, []);\n  return {\n    loading,\n    error,\n    data,\n    refetch\n  };\n};","import { useDataEngine } from '@dhis2/app-runtime';\nimport { useEffect, useState } from 'react';\nimport { queryDataElements } from '../dataElement';\nimport { queryDataSet } from '../dataSet';\nexport const queryDataElementsOfDataSet = (engine, variables) => {\n  const nextVariables = { ...variables,\n    fields: 'dataSetElements'\n  };\n  return queryDataSet(engine, nextVariables).then(response => {\n    const dataSets = response.dataSet;\n    const {\n      dataSetElements\n    } = dataSets;\n    const dataElementIds = dataSetElements.map(({\n      dataElement\n    }) => dataElement.id);\n    return dataElementIds;\n  }).then(dataElementIds => {\n    if (!dataElementIds.length) return [];\n    const dataElementVariables = {\n      ids: dataElementIds\n    };\n    return queryDataElements(engine, dataElementVariables);\n  });\n};\nexport const useReadDataElementsOfDataSetQuery = dataSetId => {\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [data, setData] = useState(null);\n  const engine = useDataEngine();\n\n  const refetch = variables => {\n    setLoading(true);\n    setError(null);\n    return queryDataElementsOfDataSet(engine, variables).then(setData).catch(setError).finally(() => setLoading(false));\n  }; // initial request\n\n\n  useEffect(() => {\n    refetch({\n      id: dataSetId\n    });\n  }, []);\n  return {\n    loading,\n    error,\n    data,\n    refetch\n  };\n};","import { Button, ButtonStrip, CircularLoader, Modal, ModalTitle, ModalContent, SingleSelectFieldFF, ReactFinalForm, hasValue, NoticeBox } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React, { useMemo } from 'react';\nimport { FIELD_DATA_SET_NAME } from '../dataSet';\nimport { FormRow } from '../forms';\nimport { get } from '../utils';\nimport { useReadDataElementsOfDataSetQuery } from '../dataElement';\nimport i18n from '../locales';\nconst {\n  Field,\n  Form,\n  useForm,\n  useFormState\n} = ReactFinalForm;\nexport const FieldDataElementWithCategoryOptionComboFormula = ({\n  targetFieldName,\n  onClose\n}) => {\n  const form = useForm();\n  const {\n    values\n  } = useFormState();\n  const {\n    id: dataSetId\n  } = values[FIELD_DATA_SET_NAME];\n  const {\n    loading,\n    error,\n    data\n  } = useReadDataElementsOfDataSetQuery(dataSetId); // Using memo so changing the form does not change the \"initialValues\"\n  // which would cause the form to update unnecessarily\n\n  const initialFormula = get(targetFieldName, values);\n  const initialOperator = useMemo(() => initialFormula ? initialFormula[0] : '+', []);\n  const initialDataElementCode = useMemo(() => initialFormula ? initialFormula.slice(1) : '', []);\n  const initialValues = {\n    operator: initialOperator,\n    dataElementCode: initialDataElementCode\n  };\n\n  if (loading) {\n    return <Modal>\n                <CircularLoader />\n            </Modal>;\n  }\n\n  const options = data.dataElements.dataElements.map(dataElement => {\n    const {\n      code,\n      displayName\n    } = dataElement;\n    return {\n      value: code,\n      label: displayName\n    };\n  });\n\n  const onSubmit = values => {\n    const newFormula = `${values.operator}${values.dataElementCode}`;\n    form.change(targetFieldName, newFormula);\n    onClose();\n  };\n\n  const onRemove = () => {\n    form.change(targetFieldName, null);\n    onClose();\n  };\n\n  return <Form onSubmit={onSubmit} initialValues={initialValues}>\n            {({\n      handleSubmit\n    }) => <Modal>\n                    <ModalTitle>{i18n.t('')}</ModalTitle>\n\n                    <ModalContent>\n                        <form onSubmit={event => {\n          event.stopPropagation();\n          handleSubmit(event);\n        }}>\n                            <FormRow>\n                                <Field required name=\"dataElementCode\" label={i18n.t('Data element')} component={SingleSelectFieldFF} options={options} validate={hasValue} />\n                            </FormRow>\n\n                            <FormRow>\n                                <Field required name=\"operator\" label={i18n.t('formula operator')} component={SingleSelectFieldFF} initialValue=\"+\" options={[{\n              value: '+',\n              label: '+'\n            }, {\n              value: '-',\n              label: '-'\n            }]} />\n                            </FormRow>\n\n                            {error && <FormRow>\n                                    <NoticeBox error title={i18n.t('Something went wrong whilst saving')}>\n                                        {error.message}\n                                    </NoticeBox>\n                                </FormRow>}\n\n                            <FormRow>\n                                <ButtonStrip>\n                                    <Button type=\"submit\" primary>\n                                        {i18n.t('Save')}\n                                    </Button>\n\n                                    <Button onClick={onClose}>\n                                        {i18n.t('Cancel')}\n                                    </Button>\n\n                                    <Button onClick={onRemove}>\n                                        {i18n.t('Remove')}\n                                    </Button>\n                                </ButtonStrip>\n                            </FormRow>\n                        </form>\n                    </ModalContent>\n                </Modal>}\n        </Form>;\n};\nFieldDataElementWithCategoryOptionComboFormula.propTypes = {\n  targetFieldName: PropTypes.string.isRequired,\n  onClose: PropTypes.func.isRequired\n};","export const get = (path, object) => {\n  let value = null;\n  const segments = path.split('.');\n\n  if (!(object instanceof Object)) {\n    return value;\n  }\n\n  for (let i = 0, cur = object; i < segments.length; ++i) {\n    const nextObject = cur[segments[i]];\n    if (!nextObject) break;\n\n    if (i === segments.length - 1) {\n      value = nextObject;\n      break;\n    }\n\n    cur = nextObject;\n  }\n\n  return value;\n};","import { Button, InputFieldFF, ReactFinalForm } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React, { useState } from 'react';\nimport { DE_COC_toFormName } from '../smsCommand';\nimport { FieldDataElementWithCategoryOptionComboFormula } from './FieldDataElementWithCategoryOptionComboFormula';\nimport { FormRow } from '../forms';\nimport i18n from '../locales';\nimport styles from './FieldDataElementWithCategoryOptionCombo.module.css';\nconst {\n  Field\n} = ReactFinalForm;\nexport const FieldDataElementWithCategoryOptionCombo = ({\n  dataElement,\n  categoryOptionCombo\n}) => {\n  const [showFormula, setShowFormula] = useState(false);\n  const label = categoryOptionCombo ? `${dataElement.displayName} ${categoryOptionCombo.displayName}` : `${dataElement.displayName} ${i18n.t('default')}`;\n  const baseName = DE_COC_toFormName(dataElement, categoryOptionCombo);\n  const name = `${baseName}.code`;\n  const formulaName = `${baseName}.formula`;\n  return <div className={styles.container}>\n            <Field className={styles.field} label={label} name={name} subscription={{\n      value: true,\n      error: true,\n      invalid: true,\n      touched: true\n    }}>\n                {({\n        input,\n        meta,\n        ...rest\n      }) => {\n        const code = input.value;\n        return <>\n                            <FormRow>\n                                <InputFieldFF {...rest} input={input} meta={meta} error={!!meta.error} />\n                            </FormRow>\n\n                            {code && <>\n                                    <Button onClick={() => setShowFormula(true)}>\n                                        {i18n.t('Change formula')}\n                                    </Button>\n\n                                    {showFormula && <FieldDataElementWithCategoryOptionComboFormula targetFieldName={formulaName} onClose={() => setShowFormula(false)} />}\n                                </>}\n                        </>;\n      }}\n            </Field>\n        </div>;\n};\nFieldDataElementWithCategoryOptionCombo.defaultProps = {\n  categoryOptionCombo: null,\n  formula: ''\n};\nFieldDataElementWithCategoryOptionCombo.propTypes = {\n  dataElement: PropTypes.shape({\n    displayName: PropTypes.string.isRequired,\n    id: PropTypes.string.isRequired\n  }).isRequired,\n  categoryOptionCombo: PropTypes.shape({\n    code: PropTypes.string.isRequired,\n    displayName: PropTypes.string.isRequired,\n    id: PropTypes.string.isRequired\n  })\n};","import { NoticeBox, ReactFinalForm } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { FIELD_COMMAND_SMS_CODES_NAME } from './fieldNames';\nimport { FieldDataElementWithCategoryOptionCombo } from './FieldDataElementWithCategoryOptionCombo';\nimport { FormRow } from '../forms';\nimport i18n from '../locales';\nimport styles from './DataElementTimesCategoryOptionCombos.module.css';\nconst {\n  FormSpy\n} = ReactFinalForm;\nexport const DataElementTimesCategoryOptionCombos = ({\n  DE_COC_combinations\n}) => <div>\n        <h2>{i18n.t('Data element category combination')}</h2>\n\n        <FormSpy subscription={{\n    errors: true,\n    pristine: true\n  }}>\n            {({\n      errors,\n      pristine\n    }) => {\n      if (pristine) return <span />;\n      const smsCodeErrors = errors[FIELD_COMMAND_SMS_CODES_NAME];\n      const globalError = smsCodeErrors?.global;\n      return <>\n                        {globalError && <FormRow>\n                                <NoticeBox error title={i18n.t('Data element category combination validation error')}>\n                                    {globalError}\n                                </NoticeBox>\n                            </FormRow>}\n                    </>;\n    }}\n        </FormSpy>\n\n        <div>\n            {DE_COC_combinations.map(({\n      dataElement,\n      categoryOptionCombo\n    }) => {\n      return <FormRow className={styles.formRow} key={dataElement.id + categoryOptionCombo?.id}>\n                        <FieldDataElementWithCategoryOptionCombo dataElement={dataElement} categoryOptionCombo={categoryOptionCombo} />\n                    </FormRow>;\n    })}\n        </div>\n    </div>;\nDataElementTimesCategoryOptionCombos.defaultProps = {\n  allRequired: false\n};\nDataElementTimesCategoryOptionCombos.propTypes = {\n  DE_COC_combinations: PropTypes.arrayOf(PropTypes.shape({\n    dataElement: PropTypes.shape({\n      displayName: PropTypes.string.isRequired,\n      id: PropTypes.string.isRequired\n    }).isRequired,\n    categoryOptionCombo: PropTypes.shape({\n      code: PropTypes.string.isRequired,\n      displayName: PropTypes.string.isRequired,\n      id: PropTypes.string.isRequired\n    })\n  })).isRequired\n};","import { SingleSelectFieldFF, ReactFinalForm } from '@dhis2/ui';\nimport React from 'react';\nimport { FIELD_COMMAND_COMPLETENESS_METHOD_NAME } from './fieldNames';\nimport * as completenessMethods from './completenessMethods';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nconst options = Object.values(completenessMethods);\nexport const FieldCommandCompletenessMethod = () => <Field dataTest={dataTest('forms-fielddataset')} name={FIELD_COMMAND_COMPLETENESS_METHOD_NAME} label={i18n.t('Completeness method')} component={SingleSelectFieldFF} options={options} />;","import { TextAreaFieldFF, ReactFinalForm } from '@dhis2/ui';\nimport React from 'react';\nimport { FIELD_COMMAND_CONFIRM_MESSAGE_NAME } from './fieldNames';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nexport const FieldCommandConfirmMessage = () => <Field dataTest={dataTest('commands-fieldcommandconfirmmessage')} name={FIELD_COMMAND_CONFIRM_MESSAGE_NAME} label={i18n.t('Confirm message')} component={TextAreaFieldFF} />;","import { TextAreaFieldFF, ReactFinalForm } from '@dhis2/ui';\nimport React from 'react';\nimport { FIELD_COMMAND_DEFAULT_MESSAGE_NAME } from './fieldNames';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nexport const FieldCommandDefaultMessage = () => <Field dataTest={dataTest('forms-fieldcommanddefaultmessage')} name={FIELD_COMMAND_DEFAULT_MESSAGE_NAME} label={i18n.t('Reply message if no codes are sent (only the command)')} component={TextAreaFieldFF} />;","import { TextAreaFieldFF, ReactFinalForm } from '@dhis2/ui';\nimport React from 'react';\nimport { FIELD_COMMAND_MORE_THAN_ONE_ORG_UNIT_MESSAGE_NAME } from './fieldNames';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nexport const FieldCommandMoreThanOneOrgUnitMessage = () => <Field dataTest={dataTest('forms-fieldcommandmorethanoneorgunitmessage')} name={FIELD_COMMAND_MORE_THAN_ONE_ORG_UNIT_MESSAGE_NAME} label={i18n.t('More than one orgunit message')} component={TextAreaFieldFF} />;","import { InputFieldFF, ReactFinalForm, composeValidators, hasValue, string } from '@dhis2/ui';\nimport React from 'react';\nimport { FIELD_COMMAND_NAME_NAME } from './fieldNames';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nexport const FieldCommandName = () => <Field required dataTest={dataTest('commands-fieldcommandname')} name={FIELD_COMMAND_NAME_NAME} label={i18n.t('Name')} component={InputFieldFF} validate={composeValidators(string, hasValue)} />;","import { TextAreaFieldFF, ReactFinalForm } from '@dhis2/ui';\nimport React from 'react';\nimport { FIELD_COMMAND_NO_USER_MESSAGE_NAME } from './fieldNames';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nexport const FieldCommandNoUserMessage = () => <Field dataTest={dataTest('forms-fieldcommandnousermessage')} name={FIELD_COMMAND_NO_USER_MESSAGE_NAME} label={i18n.t('No user message')} component={TextAreaFieldFF} />;","import i18n from '../locales/index';\nexport const KEY_VALUE_PARSER = {\n  value: 'KEY_VALUE_PARSER',\n  label: i18n.t('Key value parser')\n}; // @TODO: This parser is not listed in the docs,\n//        but it's listed in the original source code\n//   -> docs: https://docs.dhis2.org/master/en/dhis2_developer_manual/web-api.html#sms-command-values\n//   -> code: https://github.com/dhis2/dhis2-core/blob/79bd77ecf52051b00e3ba96eb1aca4d0a6063ed1/dhis-2/dhis-web/dhis-web-maintenance/dhis-web-maintenance-mobile/src/main/webapp/dhis-web-maintenance-mobile/smscommand/edit-sms-command.vm#L188\n\nexport const J2ME_PARSER = {\n  value: 'J2ME_PARSER',\n  label: i18n.t('J2ME parser')\n};\nexport const ALERT_PARSER = {\n  value: 'ALERT_PARSER',\n  label: i18n.t('Alert parser')\n};\nexport const UNREGISTERED_PARSER = {\n  value: 'UNREGISTERED_PARSER',\n  label: i18n.t('Unregistered parser')\n};\nexport const TRACKED_ENTITY_REGISTRATION_PARSER = {\n  value: 'TRACKED_ENTITY_REGISTRATION_PARSER',\n  label: i18n.t('Tracked entity registration parser')\n};\nexport const PROGRAM_STAGE_DATAENTRY_PARSER = {\n  value: 'PROGRAM_STAGE_DATAENTRY_PARSER',\n  label: i18n.t('Program stage data entry parser')\n};\nexport const EVENT_REGISTRATION_PARSER = {\n  value: 'EVENT_REGISTRATION_PARSER',\n  label: i18n.t('Event registration parser')\n};","import { PropTypes } from '@dhis2/prop-types';\nimport { SingleSelectFieldFF, ReactFinalForm } from '@dhis2/ui';\nimport React from 'react';\nimport { FIELD_COMMAND_PARSER_NAME } from './fieldNames';\nimport * as commandTypes from './parserTypes';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nconst options = Object.values(commandTypes).sort((a, b) => {\n  if (a.label < b.label) {\n    return -1;\n  }\n\n  if (a.label > b.label) {\n    return 1;\n  }\n\n  return 0;\n});\nexport const FieldCommandParser = ({\n  disabled\n}) => <Field disabled={disabled} dataTest={dataTest('forms-fieldcommandparser')} name={FIELD_COMMAND_PARSER_NAME} label={i18n.t('Parser')} component={SingleSelectFieldFF} options={options} />;\nFieldCommandParser.defaultProps = {\n  disabled: false\n};\nFieldCommandParser.propTypes = {\n  disabled: PropTypes.bool\n};","import { InputFieldFF, ReactFinalForm } from '@dhis2/ui';\nimport React from 'react';\nimport { FIELD_COMMAND_SEPARATOR_NAME } from './fieldNames';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nexport const FieldCommandSeparator = () => <Field dataTest={dataTest('forms-fieldcommandseparator')} name={FIELD_COMMAND_SEPARATOR_NAME} label={i18n.t('Field separator')} component={InputFieldFF} />;","import { InputFieldFF, ReactFinalForm } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { FIELD_COMMAND_SMS_CODES_NAME } from './fieldNames';\nconst {\n  Field,\n  useFormState\n} = ReactFinalForm;\nconst subscription = {\n  values: true\n};\nexport const FieldCommandSmsCode = ({\n  id,\n  displayName,\n  valueType\n}) => {\n  const {\n    values\n  } = useFormState({\n    subscription\n  });\n  const smsCode = values[FIELD_COMMAND_SMS_CODES_NAME][id];\n  /**\n   * This uses a dynamic, nested name for storing the field value in the\n   * form state. You can't submit the data as is though, since the backend\n   * expects a different shape. So I was thinking of dealing with that\n   * in the submit handler. Since you have the ids and the field value\n   * you should be able to transform it into any shape you need.\n   */\n\n  return <Field required name={`${FIELD_COMMAND_SMS_CODES_NAME}.${id}`} label={displayName} component={InputFieldFF} format={code => code?.code || ''} parse={nextCode => !smsCode ? {\n    code: nextCode,\n    trackedEntityAttribute: {\n      id,\n      displayName,\n      valueType\n    }\n  } : { ...smsCode,\n    code: nextCode\n  }} />;\n};\nFieldCommandSmsCode.propTypes = {\n  displayName: PropTypes.string.isRequired,\n  id: PropTypes.string.isRequired,\n  valueType: PropTypes.string.isRequired\n};","import { Button, Field as UiField, InputFieldFF, ReactFinalForm, hasValue } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { FIELD_COMMAND_SPECIAL_CHARS_NAME } from './fieldNames';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nimport styles from './FieldCommandSpecialCharacter.module.css';\nconst {\n  Field,\n  useForm\n} = ReactFinalForm;\nexport const FieldCommandSpecialCharacter = ({\n  index\n}) => {\n  const {\n    change,\n    getState\n  } = useForm();\n\n  const removeSpecialKeyFieldsFromFormState = () => {\n    const specialChars = getState().values[FIELD_COMMAND_SPECIAL_CHARS_NAME];\n    const newSpecialChars = [...specialChars.slice(0, index), ...specialChars.slice(index + 1)];\n    change(FIELD_COMMAND_SPECIAL_CHARS_NAME, newSpecialChars);\n  };\n\n  return <div key={index} className={styles.container}>\n            <Field required className={styles.field} dataTest={dataTest('@TODO')} label={i18n.t('Special character name')} name={`${FIELD_COMMAND_SPECIAL_CHARS_NAME}[${index}].name`} component={InputFieldFF} validate={hasValue} />\n\n            <Field required className={styles.field} dataTest={dataTest('@TODO')} label={i18n.t('Special character value')} name={`${FIELD_COMMAND_SPECIAL_CHARS_NAME}[${index}].value`} component={InputFieldFF} validate={hasValue} />\n\n            <UiField label=\"&nbsp;\">\n                <Button className={styles.button} onClick={removeSpecialKeyFieldsFromFormState}>\n                    {i18n.t('Remove')}\n                </Button>\n            </UiField>\n        </div>;\n};\nFieldCommandSpecialCharacter.propTypes = {\n  index: PropTypes.number.isRequired\n};","import { TextAreaFieldFF, ReactFinalForm } from '@dhis2/ui';\nimport React from 'react';\nimport { FIELD_COMMAND_SUCCESS_MESSAGE_NAME } from './fieldNames';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nexport const FieldCommandSuccessMessage = () => <Field dataTest={dataTest('forms-fieldcommandsuccessmessage')} name={FIELD_COMMAND_SUCCESS_MESSAGE_NAME} label={i18n.t('Success message')} component={TextAreaFieldFF} />;","import { CheckboxFieldFF, ReactFinalForm } from '@dhis2/ui';\nimport React from 'react';\nimport { FIELD_COMMAND_USE_CURRENT_PERIOD_FOR_REPORTING_NAME } from './fieldNames';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nexport const FieldCommandUseCurrentPeriodForReporting = () => <Field type=\"checkbox\" dataTest={dataTest('forms-fieldusecurrentperiodforreporting')} name={FIELD_COMMAND_USE_CURRENT_PERIOD_FOR_REPORTING_NAME} label={i18n.t('Use current period for reporting')} component={CheckboxFieldFF} />;","import { TextAreaFieldFF, ReactFinalForm } from '@dhis2/ui';\nimport React from 'react';\nimport { FIELD_COMMAND_WRONG_FORMAT_MESSAGE_NAME } from './fieldNames';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nexport const FieldCommandWrongFormatMessage = () => <Field dataTest={dataTest('forms-fieldcommandwrongformatmessage')} name={FIELD_COMMAND_WRONG_FORMAT_MESSAGE_NAME} label={i18n.t('Wrong format message')} component={TextAreaFieldFF} />;","import { InputFieldFF, ReactFinalForm } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { FIELD_COMMAND_SMS_CODES_NAME } from './fieldNames';\nconst {\n  Field\n} = ReactFinalForm;\nexport const ProgramStageDataElements = ({\n  programStageDataElements,\n  smsCodes\n}) => {\n  return <>\n            {programStageDataElements.map(({\n      dataElement\n    }) => <Field key={dataElement.id} name={`${FIELD_COMMAND_SMS_CODES_NAME}.${dataElement.id}`} label={dataElement.displayName} component={InputFieldFF} format={value => value?.code || null} parse={code => {\n      const currentValue = smsCodes[dataElement.id];\n      const newValue = { ...currentValue,\n        code: code || '',\n        dataElement\n      };\n      return newValue;\n    }} />)}\n        </>;\n};\nProgramStageDataElements.propTypes = {\n  programStageDataElements: PropTypes.arrayOf(PropTypes.shape({\n    dataElement: PropTypes.shape({\n      displayName: PropTypes.string.isRequired,\n      id: PropTypes.string.isRequired\n    })\n  })).isRequired,\n  smsCodes: PropTypes.objectOf(PropTypes.shape({\n    dataElement: PropTypes.shape({\n      id: PropTypes.string.isRequired\n    }).isRequired,\n    code: PropTypes.string,\n    compulsory: PropTypes.bool,\n    optionId: PropTypes.oneOfType([PropTypes.string, PropTypes.number])\n  }))\n};","import { FIELD_COMMAND_SMS_CODES_NAME } from '../smsCommandFields';\nexport const DE_COC_toFormName = (dataElement, categoryOptionCombo) => {\n  const dataElementId = dataElement.id;\n  const cocCode = categoryOptionCombo?.code;\n  const isDefault = cocCode === 'default';\n\n  if (!cocCode || isDefault) {\n    return `${FIELD_COMMAND_SMS_CODES_NAME}.${dataElementId}`;\n  }\n\n  return `${FIELD_COMMAND_SMS_CODES_NAME}.${dataElementId}-${cocCode}`;\n};","import { Button, ButtonStrip, Modal, ModalActions, ModalContent, ModalTitle } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nexport const DeleteCommandsConfirmationDialog = ({\n  onCancelClick,\n  onDeleteClick\n}) => {\n  return <Modal dataTest={dataTest('commands-deleteconfirmationdialog')}>\n            <ModalTitle>{i18n.t('Confirm deletion')}</ModalTitle>\n            <ModalContent>\n                {i18n.t('Are you sure you want to delete the selected commands?')}\n            </ModalContent>\n            <ModalActions>\n                <ButtonStrip>\n                    <Button secondary onClick={onCancelClick} dataTest={dataTest('commands-deleteconfirmationdialog-cancel')}>\n                        {i18n.t('Cancel')}\n                    </Button>\n\n                    <Button primary onClick={onDeleteClick} dataTest={dataTest('commands-deleteconfirmationdialog-confirm')}>\n                        {i18n.t('Delete')}\n                    </Button>\n                </ButtonStrip>\n            </ModalActions>\n        </Modal>;\n};\nDeleteCommandsConfirmationDialog.propTypes = {\n  onCancelClick: PropTypes.func.isRequired,\n  onDeleteClick: PropTypes.func.isRequired\n};","import { Button, CircularLoader, ReactFinalForm } from '@dhis2/ui';\nimport React from 'react';\nimport i18n from '../locales';\nconst {\n  useFormState\n} = ReactFinalForm;\nconst subscription = {\n  submitting: true,\n  pristine: true\n};\nexport const SaveCommandButton = () => {\n  const {\n    submitting,\n    pristine\n  } = useFormState({\n    subscription\n  });\n  return <Button primary type=\"submit\" disabled={pristine || submitting} icon={submitting ? <CircularLoader small /> : null}>\n            {i18n.t('Save command')}\n        </Button>;\n};","import { NoticeBox, ReactFinalForm } from '@dhis2/ui';\nimport React from 'react';\nimport { FormRow } from '../forms';\nimport i18n from '../locales';\nconst {\n  useFormState\n} = ReactFinalForm;\nconst subscription = {\n  submitError: true,\n  hasSubmitErrors: true\n};\nexport const SubmitErrors = () => {\n  const {\n    submitError,\n    hasSubmitErrors\n  } = useFormState({\n    subscription\n  });\n  if (!hasSubmitErrors) return null;\n  return <FormRow>\n            <NoticeBox error title={i18n.t('Something went wrong whilst submitting the form')}>\n                {submitError}\n            </NoticeBox>\n        </FormRow>;\n};","/**\n * @param {string} parserType\n * @param {Object} parser\n * @param {string} parser.value\n * @returns {bool}\n */\nexport const isParserType = (parserType, parser) => parserType === parser.value;","import { useDataMutation } from '@dhis2/app-runtime';\nimport { ALERT_PARSER, EVENT_REGISTRATION_PARSER, J2ME_PARSER, KEY_VALUE_PARSER, PROGRAM_STAGE_DATAENTRY_PARSER, TRACKED_ENTITY_REGISTRATION_PARSER, UNREGISTERED_PARSER } from '../smsCommandFields';\nexport const CREATE_SMS_COMMAND_MUTATION = {\n  resource: 'smsCommands',\n  type: 'create',\n\n  /*\n   * @param {Object} args\n   * @param {string} args.parserType\n   * @param {string} args.name\n   * @param {string} args.dataset (id)\n   * @param {string} args.userGroup (id)\n   * @param {string} args.program (id)\n   * @param {string} args.programStage (id)\n   * @returns {Object}\n   */\n  data: ({\n    parserType,\n    name,\n    dataset,\n    userGroup,\n    program,\n    programStage\n  }) => {\n    if (parserType === KEY_VALUE_PARSER.value || parserType === J2ME_PARSER.value) {\n      return {\n        parserType,\n        name,\n        dataset\n      };\n    }\n\n    if (parserType === ALERT_PARSER.value || parserType === UNREGISTERED_PARSER.value) {\n      return {\n        parserType,\n        name,\n        userGroup: {\n          id: userGroup\n        }\n      };\n    }\n\n    if (parserType === TRACKED_ENTITY_REGISTRATION_PARSER.value || parserType === EVENT_REGISTRATION_PARSER.value) {\n      return {\n        parserType,\n        name,\n        program\n      };\n    }\n\n    if (parserType === PROGRAM_STAGE_DATAENTRY_PARSER.value) {\n      return {\n        parserType,\n        name,\n        program,\n        programStage\n      };\n    }\n\n    throw new Error(`You provided an unrecognized parserType \"${parserType}\"`);\n  }\n};\nexport const useCreateSmsCommandMutation = ({\n  onComplete,\n  onError\n}) => useDataMutation(CREATE_SMS_COMMAND_MUTATION, {\n  onComplete,\n  onError\n});","import { useState } from 'react';\nimport { useDataEngine } from '@dhis2/app-runtime';\nexport const DELETE_SMS_COMMAND_MUTATION = {\n  resource: 'smsCommands',\n  type: 'delete',\n  id: ({\n    id\n  }) => id\n};\n\nconst idToMutationRequestFactory = engine => id => {\n  const variables = {\n    id\n  };\n  return engine.mutate(DELETE_SMS_COMMAND_MUTATION, {\n    variables\n  });\n};\n\nexport const useDeleteSmsCommandMutation = () => {\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const engine = useDataEngine();\n  const idToMutationRequest = idToMutationRequestFactory(engine);\n\n  const onStart = () => setLoading(true);\n\n  const onDone = response => {\n    setLoading(false);\n    return response;\n  };\n\n  const onError = error => {\n    setError(error);\n    setLoading(false);\n  };\n\n  const mutate = ({\n    ids\n  }) => {\n    onStart();\n    return Promise.all(ids.map(idToMutationRequest)).then(onDone).catch(onError);\n  };\n\n  return [mutate, {\n    loading,\n    error\n  }];\n};","import { useDataQuery } from '@dhis2/app-runtime';\nexport const READ_SMS_COMMAND_PARSER_TYPE_QUERY = {\n  smsCommand: {\n    resource: 'smsCommands',\n    id: ({\n      id\n    }) => id,\n    params: {\n      fields: 'parserType',\n      paging: 'false'\n    }\n  }\n};\nexport const useReadSmsCommandParserTypeQuery = id => useDataQuery(READ_SMS_COMMAND_PARSER_TYPE_QUERY, {\n  variables: {\n    id\n  }\n});","import { useDataQuery } from '@dhis2/app-runtime';\nexport const SMS_COMMANDS_QUERY = {\n  smsCommands: {\n    resource: 'smsCommands',\n    pager: false,\n    params: ({\n      ids\n    } = {}) => ({\n      // @TODO: Why is `paging: false` not working?\n      paging: 'false',\n      fields: '*',\n      filter: ids ? `ids:in:[${ids.join(',')}]` : undefined\n    })\n  }\n};\nexport const useReadSmsCommandsQuery = () => useDataQuery(SMS_COMMANDS_QUERY);","import { FinalForm } from '@dhis2/ui';\nimport { useContext } from 'react';\nimport { useDataEngine } from '@dhis2/app-runtime';\nimport { AlertContext } from '../notifications';\nimport i18n from '../locales';\nconst {\n  FORM_ERROR\n} = FinalForm;\n\nconst identity = input => input;\n\nexport const REPLACE_SMS_COMMAND_MUTATION = {\n  resource: 'smsCommands',\n  type: 'update',\n  id: ({\n    commandId\n  }) => commandId,\n  // @TODO(non-critical):\n  //   Make this produce static object structures\n  // eslint-disable-next-line no-unused-vars\n  data: ({\n    commandId,\n    ...params\n  }) => params\n};\nexport const UPDATE_SMS_COMMAND_MUTATION = { ...REPLACE_SMS_COMMAND_MUTATION,\n  partial: true\n};\nexport const useUpdateCommand = ({\n  onAfterChange,\n  commandId,\n  formatCommand = identity,\n  replace = false\n}) => {\n  const {\n    addAlert\n  } = useContext(AlertContext);\n  const engine = useDataEngine();\n  return variables => {\n    const allVariables = {\n      variables: { ...formatCommand(variables),\n        commandId\n      }\n    };\n    const mutation = replace ? UPDATE_SMS_COMMAND_MUTATION : REPLACE_SMS_COMMAND_MUTATION;\n    return engine.mutate(mutation, allVariables).then(onAfterChange).catch(error => {\n      const isValidationError = error.type === 'access'; // Potential validation error, return it in a format final-form can handle\n\n      if (isValidationError) {\n        const fallback = 'No error message was provided';\n        const message = error.message || i18n.t(fallback);\n        return {\n          [FORM_ERROR]: message\n        };\n      } // Notify on unexpected errors\n\n\n      addAlert({\n        type: 'critical',\n        message: error.message\n      });\n    });\n  };\n};","import { SingleSelectFieldFF, ReactFinalForm, hasValue } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nexport const FIELD_USER_GROUP_NAME = 'userGroup';\nexport const FieldUserGroup = ({\n  userGroups,\n  loading,\n  required,\n  disabled,\n  errorText\n}) => <Field disabled={disabled} error={!!errorText} validationText={errorText} required={required} loading={loading} dataTest={dataTest('forms-fielduserGroup')} name={FIELD_USER_GROUP_NAME} label={i18n.t('Usergroup')} component={SingleSelectFieldFF} options={userGroups} validate={required && hasValue} />;\nFieldUserGroup.defaultProps = {\n  disabled: false,\n  loading: false,\n  required: false,\n  errorText: ''\n};\nFieldUserGroup.propTypes = {\n  userGroups: PropTypes.arrayOf(PropTypes.shape({\n    label: PropTypes.string.isRequired,\n    value: PropTypes.string.isRequired\n  })).isRequired,\n  disabled: PropTypes.bool,\n  errorText: PropTypes.string,\n  loading: PropTypes.bool,\n  required: PropTypes.bool\n};","import { useDataQuery } from '@dhis2/app-runtime';\nexport const USER_GROUPS_QUERY = {\n  userGroups: {\n    resource: 'userGroups',\n    params: {\n      paging: 'false'\n    }\n  }\n};\nexport const useReadUserGroupsQuery = () => useDataQuery(USER_GROUPS_QUERY);","import { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { FieldUserGroup } from './FieldUserGroup';\nimport { useReadUserGroupsQuery } from './useReadUserGroupsQuery';\nexport const FieldUserGroupWithAutoLoad = ({\n  required\n}) => {\n  const {\n    loading,\n    error,\n    data\n  } = useReadUserGroupsQuery();\n\n  if (loading) {\n    return <FieldUserGroup required={required} loading showLoadingStatus userGroups={[]} />;\n  }\n\n  if (error) {\n    return <FieldUserGroup required={required} disabled userGroups={[]} errorText={error.message} />;\n  }\n\n  const {\n    userGroups\n  } = data.userGroups;\n  const options = userGroups.map(({\n    id,\n    displayName\n  }) => ({\n    label: displayName,\n    value: id\n  }));\n  return <FieldUserGroup required={required} userGroups={options} />;\n};\nFieldUserGroupWithAutoLoad.defaultProps = {\n  required: false\n};\nFieldUserGroupWithAutoLoad.propTypes = {\n  required: PropTypes.bool\n};","import React from 'react';\nimport { PropTypes } from '@dhis2/prop-types';\nimport { ReactFinalForm, NoticeBox, CenteredContent, CircularLoader } from '@dhis2/ui';\nimport { useDataQuery } from '@dhis2/app-runtime';\nimport { FieldCommandConfirmMessage, FieldCommandName, FieldCommandParser } from '../smsCommandFields';\nimport { SaveCommandButton, SubmitErrors, useUpdateCommand } from '../smsCommand';\nimport { FieldUserGroup } from '../userGroup';\nimport { FormRow } from '../forms';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Form\n} = ReactFinalForm;\nconst query = {\n  smsCommand: {\n    resource: 'smsCommands',\n    id: ({\n      commandId\n    }) => commandId,\n    params: {\n      fields: ['name', 'parserType', 'receivedMessage', 'userGroup[name,id]']\n    }\n  }\n};\nexport const CommandEditUnregisteredParserForm = ({\n  commandId,\n  onAfterChange\n}) => {\n  const updateCommand = useUpdateCommand({\n    commandId,\n    onAfterChange,\n    replace: true\n  });\n  const {\n    loading,\n    error,\n    data\n  } = useDataQuery(query, {\n    variables: {\n      commandId\n    }\n  });\n\n  if (loading) {\n    return <CenteredContent>\n                <CircularLoader />\n            </CenteredContent>;\n  }\n\n  if (error) {\n    const msg = i18n.t('Something went wrong whilst loading the sms command');\n    return <NoticeBox error title={msg}>\n                {error.message}\n            </NoticeBox>;\n  }\n\n  const {\n    name,\n    parserType,\n    receivedMessage,\n    userGroup\n  } = data.smsCommand;\n  const initialValues = {\n    name,\n    parserType,\n    receivedMessage,\n    userGroup: userGroup.id\n  };\n  const userGroups = [{\n    value: userGroup.id,\n    label: userGroup.name\n  }];\n  return <Form onSubmit={updateCommand} initialValues={initialValues}>\n            {({\n      handleSubmit\n    }) => <form onSubmit={handleSubmit} data-test={dataTest('commands-commandunregisteredparserform')}>\n                    <FormRow>\n                        <FieldCommandName />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandParser disabled />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldUserGroup disabled userGroups={userGroups} />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandConfirmMessage />\n                    </FormRow>\n\n                    <SubmitErrors />\n                    <SaveCommandButton />\n                </form>}\n        </Form>;\n};\nCommandEditUnregisteredParserForm.propTypes = {\n  commandId: PropTypes.string.isRequired,\n  onAfterChange: PropTypes.func.isRequired\n};","import { SingleSelectFieldFF, ReactFinalForm, hasValue } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nexport const FIELD_PROGRAM_NAME = 'program';\nexport const FieldProgram = ({\n  programs,\n  loading,\n  required,\n  disabled,\n  errorText\n}) => <Field error={!!errorText} validationText={errorText} disabled={disabled} required={required} loading={loading} dataTest={dataTest('forms-fieldprogram')} name={FIELD_PROGRAM_NAME} label={i18n.t('Program')} component={SingleSelectFieldFF} options={programs} validate={required && hasValue} format={value => value?.id || null} parse={id => ({\n  id\n})} />;\nFieldProgram.defaultProps = {\n  disabled: false,\n  errorText: '',\n  loading: false,\n  required: false\n};\nFieldProgram.propTypes = {\n  programs: PropTypes.arrayOf(PropTypes.shape({\n    label: PropTypes.string.isRequired,\n    value: PropTypes.string.isRequired\n  })).isRequired,\n  disabled: PropTypes.bool,\n  errorText: PropTypes.string,\n  loading: PropTypes.bool,\n  required: PropTypes.bool\n};","import { useDataQuery } from '@dhis2/app-runtime';\nexport const PROGRAMS_QUERY = {\n  programs: {\n    resource: 'programs',\n    params: ({\n      registration\n    }) => {\n      const params = {\n        paging: 'false'\n      };\n\n      if (typeof registration !== 'undefined') {\n        const filter = registration ? 'programType:eq:WITH_REGISTRATION' : 'programType:eq:WITHOUT_REGISTRATION';\n        params.filter = filter;\n      }\n\n      return params;\n    }\n  }\n};\nexport const useReadProgramsQuery = registration => useDataQuery(PROGRAMS_QUERY, {\n  variables: {\n    registration\n  }\n});","import { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { FieldProgram } from './FieldProgram';\nimport { useReadProgramsQuery } from './useReadProgramsQuery';\nexport const FieldProgramWithAutoLoad = ({\n  required,\n  registration\n}) => {\n  const variables = {\n    registration\n  };\n  const {\n    loading,\n    error,\n    data\n  } = useReadProgramsQuery({\n    variables\n  });\n\n  if (loading) {\n    return <FieldProgram required={required} loading showLoadingStatus programs={[]} />;\n  }\n\n  if (error) {\n    return <FieldProgram required={required} disabled programs={[]} errorText={error.message} />;\n  }\n\n  const {\n    programs\n  } = data.programs;\n  const options = programs.map(({\n    id,\n    displayName\n  }) => ({\n    label: displayName,\n    value: id\n  }));\n  return <FieldProgram required={required} programs={options} />;\n};\nFieldProgramWithAutoLoad.defaultProps = {\n  required: false,\n  // undefined = both\n  registration: undefined\n};\nFieldProgramWithAutoLoad.propTypes = {\n  registration: PropTypes.bool,\n  required: PropTypes.bool\n};","import React from 'react';\nimport { PropTypes } from '@dhis2/prop-types';\nimport { ReactFinalForm, NoticeBox, CenteredContent, CircularLoader } from '@dhis2/ui';\nimport { useDataQuery } from '@dhis2/app-runtime';\nimport { FIELD_COMMAND_SMS_CODES_NAME, FieldCommandName, FieldCommandSeparator, FieldCommandParser, FieldCommandDefaultMessage, FieldCommandWrongFormatMessage, FieldCommandNoUserMessage, FieldCommandMoreThanOneOrgUnitMessage, FieldCommandSuccessMessage, FieldCommandSmsCode } from '../smsCommandFields';\nimport { SaveCommandButton, SubmitErrors, useUpdateCommand } from '../smsCommand';\nimport { FormRow } from '../forms';\nimport { FieldProgram } from '../program';\nimport i18n from '../locales';\nconst {\n  Form\n} = ReactFinalForm;\n\nconst formatSmsCodes = updates => ({ ...updates,\n  [FIELD_COMMAND_SMS_CODES_NAME]: Object.values(updates[FIELD_COMMAND_SMS_CODES_NAME])\n});\n\nconst query = {\n  smsCommand: {\n    resource: 'smsCommands',\n    id: ({\n      commandId\n    }) => commandId,\n    params: {\n      fields: ['name', 'parserType', 'separator', 'defaultMessage', 'wrongFormatMessage', 'noUserMessage', 'moreThanOneOrgUnitMessage', 'successMessage', // The queries below should be reduced to only the data we need\n      'program[id,displayName,programTrackedEntityAttributes[trackedEntityAttribute[:all,id,displayName]]]', 'smsCodes[:all,trackedEntityAttribute[id,displayName,valueType]]']\n    }\n  }\n};\nexport const CommandEditTrackedEntityRegistrationParserForm = ({\n  commandId,\n  onAfterChange\n}) => {\n  const updateCommand = useUpdateCommand({\n    commandId,\n    onAfterChange,\n    formatCommand: formatSmsCodes //partial: true,\n\n  });\n  const {\n    loading,\n    error,\n    data\n  } = useDataQuery(query, {\n    variables: {\n      commandId\n    }\n  });\n\n  if (loading) {\n    return <CenteredContent>\n                <CircularLoader />\n            </CenteredContent>;\n  }\n\n  if (error) {\n    const msg = i18n.t('Something went wrong whilst loading the sms command');\n    return <NoticeBox error title={msg}>\n                {error.message}\n            </NoticeBox>;\n  }\n\n  const {\n    name,\n    parserType,\n    program,\n    separator,\n    defaultMessage,\n    wrongFormatMessage,\n    noUserMessage,\n    moreThanOneOrgUnitMessage,\n    successMessage,\n    smsCodes: smsCodesOriginal\n  } = data.smsCommand;\n  const smsCodes = smsCodesOriginal.reduce((curSmsCodes, smsCode) => ({ ...curSmsCodes,\n    [smsCode.trackedEntityAttribute.id]: smsCode\n  }), {});\n  const initialValues = {\n    name,\n    parserType,\n    program,\n    separator,\n    defaultMessage,\n    wrongFormatMessage,\n    noUserMessage,\n    moreThanOneOrgUnitMessage,\n    successMessage,\n    smsCodes\n  };\n  const selectedProgramOption = {\n    value: program.id,\n    label: program.displayName\n  };\n  /**\n   * Create usable data for the dynamic fields\n   */\n  // The tracked entity attributes here have the right order for the fields\n\n  const trackedEntityAttributes = program.programTrackedEntityAttributes.map(({\n    trackedEntityAttribute\n  }) => trackedEntityAttribute); // Creating an array with only the data we need to render our dynamic form fields\n\n  const dynamicFields = trackedEntityAttributes.map(trackedEntityAttribute => {\n    const {\n      id,\n      displayName,\n      valueType\n    } = trackedEntityAttribute;\n    const merged = {\n      id,\n      displayName,\n      valueType\n    };\n    const smsCode = smsCodes[id];\n\n    if (smsCode) {\n      // This contains the actual value of the field\n      merged.initialValue = smsCode.code;\n    }\n\n    return merged;\n  });\n  return <Form onSubmit={updateCommand} initialValues={initialValues}>\n            {({\n      handleSubmit\n    }) => <form onSubmit={handleSubmit}>\n                    <FormRow>\n                        <FieldCommandName />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandParser disabled />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldProgram disabled programs={[selectedProgramOption]} />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandSeparator />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandDefaultMessage />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandWrongFormatMessage />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandNoUserMessage />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandMoreThanOneOrgUnitMessage />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandSuccessMessage />\n                    </FormRow>\n\n                    <h2>{i18n.t('Tracked entity attribute')}</h2>\n\n                    {dynamicFields.map(dynamicField => {\n        // I assume this should switch field types based on `valueType`\n        // which can be 'TEXT', 'NUMBER', etc. Currently this renders\n        // a regular input for everything.\n        return <FormRow key={dynamicField.id}>\n                                <FieldCommandSmsCode id={dynamicField.id} displayName={dynamicField.displayName} valueType={dynamicField.valueType} />\n                            </FormRow>;\n      })}\n\n                    <SubmitErrors />\n                    <SaveCommandButton />\n                </form>}\n        </Form>;\n};\nCommandEditTrackedEntityRegistrationParserForm.propTypes = {\n  commandId: PropTypes.string.isRequired,\n  onAfterChange: PropTypes.func.isRequired\n};","import { SingleSelectFieldFF, ReactFinalForm, hasValue } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Field\n} = ReactFinalForm;\nexport const FIELD_PROGRAM_STAGE_NAME = 'programStage';\nexport const FieldProgramStage = ({\n  programStages,\n  disabled,\n  loading,\n  required,\n  errorText\n}) => <Field disabled={disabled} error={!!errorText} validationText={errorText} required={required} loading={loading} dataTest={dataTest('forms-fieldprogramStage')} name={FIELD_PROGRAM_STAGE_NAME} label={i18n.t('Program stage')} component={SingleSelectFieldFF} options={programStages} validate={required && hasValue} format={value => value?.id || null} parse={id => ({\n  id\n})} />;\nFieldProgramStage.defaultProps = {\n  disabled: false,\n  loading: false,\n  required: false,\n  errorText: ''\n};\nFieldProgramStage.propTypes = {\n  programStages: PropTypes.arrayOf(PropTypes.shape({\n    label: PropTypes.string.isRequired,\n    value: PropTypes.string.isRequired\n  })).isRequired,\n  disabled: PropTypes.bool,\n  errorText: PropTypes.string,\n  loading: PropTypes.bool,\n  required: PropTypes.bool\n};","import { useDataQuery } from '@dhis2/app-runtime';\nexport const PROGRAM_STAGES_QUERY = {\n  programStages: {\n    resource: 'programStages',\n    params: ({\n      programId\n    }) => ({\n      paging: 'false',\n      filter: programId ? `program.id:eq:${programId}` : undefined\n    })\n  }\n};\nexport const useReadProgramStagesQuery = ({\n  programId,\n  lazy\n}) => useDataQuery(PROGRAM_STAGES_QUERY, {\n  variables: {\n    programId\n  },\n  lazy\n});","import { PropTypes } from '@dhis2/prop-types';\nimport React, { useEffect } from 'react';\nimport { FieldProgramStage } from './FieldProgramStage';\nimport { useReadProgramStagesQuery } from './useReadProgramStagesQuery';\nexport const FieldProgramStageWithAutoLoad = ({\n  required,\n  programId\n}) => {\n  const {\n    loading,\n    error,\n    data,\n    refetch\n  } = useReadProgramStagesQuery({\n    lazy: true\n  });\n  useEffect(() => {\n    if (programId) refetch({\n      programId\n    });\n  }, [programId]);\n\n  if (loading) {\n    return <FieldProgramStage loading required={required} programStages={[]} />;\n  }\n\n  if (error) {\n    return <FieldProgramStage disabled errorText={error.message} required={required} programStages={[]} />;\n  }\n\n  if (!programId || !data) {\n    return <FieldProgramStage disabled required={required} programStages={[]} />;\n  }\n\n  const programStages = data?.programStages?.programStages || [];\n  const options = programStages.map(({\n    id,\n    displayName\n  }) => ({\n    label: displayName,\n    value: id\n  }));\n  return <FieldProgramStage required={required} programStages={options} />;\n};\nFieldProgramStageWithAutoLoad.defaultProps = {\n  required: false\n};\nFieldProgramStageWithAutoLoad.propTypes = {\n  programId: PropTypes.string.isRequired,\n  required: PropTypes.bool\n};","import { useDataQuery } from '@dhis2/app-runtime';\nconst READ_SMS_COMMAND_PROGRAM_STAGE_DATA_ENTRY_PARSER_QUERY = {\n  smsCommand: {\n    resource: 'smsCommands',\n    id: ({\n      id\n    }) => id,\n    params: {\n      fields: ['*', 'program[id,displayName]', 'programStage[id,displayName,programStageDataElements[dataElement[id,displayName]]]'],\n      paging: 'false'\n    }\n  }\n};\nexport const useReadSmsCommandProgramStageDataEntryParserQuery = programStageId => useDataQuery(READ_SMS_COMMAND_PROGRAM_STAGE_DATA_ENTRY_PARSER_QUERY, {\n  variables: {\n    id: programStageId\n  }\n});","import { CenteredContent, CircularLoader, NoticeBox, ReactFinalForm } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { FIELD_COMMAND_DEFAULT_MESSAGE_NAME, FIELD_COMMAND_MORE_THAN_ONE_ORG_UNIT_MESSAGE_NAME, FIELD_COMMAND_NAME_NAME, FIELD_COMMAND_NO_USER_MESSAGE_NAME, FIELD_COMMAND_PARSER_NAME, FIELD_COMMAND_PROGAM_NAME, FIELD_COMMAND_PROGAM_STAGE_NAME, FIELD_COMMAND_SEPARATOR_NAME, FIELD_COMMAND_SMS_CODES_NAME, FIELD_COMMAND_SUCCESS_MESSAGE_NAME, FIELD_COMMAND_WRONG_FORMAT_MESSAGE_NAME, FieldCommandDefaultMessage, FieldCommandMoreThanOneOrgUnitMessage, FieldCommandName, FieldCommandNoUserMessage, FieldCommandParser, FieldCommandSeparator, FieldCommandSuccessMessage, FieldCommandWrongFormatMessage, PROGRAM_STAGE_DATAENTRY_PARSER, ProgramStageDataElements } from '../smsCommandFields';\nimport { SaveCommandButton, SubmitErrors, useUpdateCommand } from '../smsCommand';\nimport { FieldProgram } from '../program';\nimport { FieldProgramStage } from '../programStage';\nimport { FormRow } from '../forms';\nimport { dataTest } from '../dataTest';\nimport { useReadSmsCommandProgramStageDataEntryParserQuery } from './useReadSmsCommandProgramStageDataEntryParserQuery';\nimport i18n from '../locales';\nconst {\n  Form\n} = ReactFinalForm;\n\nconst getInitialFormState = command => {\n  const name = command[FIELD_COMMAND_NAME_NAME];\n  const program = command[FIELD_COMMAND_PROGAM_NAME];\n  const programStage = command[FIELD_COMMAND_PROGAM_STAGE_NAME];\n  const separator = command[FIELD_COMMAND_SEPARATOR_NAME];\n  const defaultMessage = command[FIELD_COMMAND_DEFAULT_MESSAGE_NAME];\n  const wrongFormatMessage = command[FIELD_COMMAND_WRONG_FORMAT_MESSAGE_NAME];\n  const noUserMessage = command[FIELD_COMMAND_NO_USER_MESSAGE_NAME];\n  const moreThanOneOrgUnitMessage = command[FIELD_COMMAND_MORE_THAN_ONE_ORG_UNIT_MESSAGE_NAME];\n  const successMessage = command[FIELD_COMMAND_SUCCESS_MESSAGE_NAME];\n  const smsCodes = command[FIELD_COMMAND_SMS_CODES_NAME].reduce((curSmsCodes, smsCode) => ({ ...curSmsCodes,\n    [smsCode.dataElement.id]: smsCode\n  }), {});\n  return {\n    [FIELD_COMMAND_NAME_NAME]: name,\n    [FIELD_COMMAND_PARSER_NAME]: PROGRAM_STAGE_DATAENTRY_PARSER.value,\n    [FIELD_COMMAND_PROGAM_NAME]: program,\n    [FIELD_COMMAND_PROGAM_STAGE_NAME]: programStage,\n    [FIELD_COMMAND_SEPARATOR_NAME]: separator,\n    [FIELD_COMMAND_DEFAULT_MESSAGE_NAME]: defaultMessage,\n    [FIELD_COMMAND_WRONG_FORMAT_MESSAGE_NAME]: wrongFormatMessage,\n    [FIELD_COMMAND_NO_USER_MESSAGE_NAME]: noUserMessage,\n    [FIELD_COMMAND_MORE_THAN_ONE_ORG_UNIT_MESSAGE_NAME]: moreThanOneOrgUnitMessage,\n    [FIELD_COMMAND_SUCCESS_MESSAGE_NAME]: successMessage,\n    [FIELD_COMMAND_SMS_CODES_NAME]: smsCodes\n  };\n};\n\nconst formatSmsCodes = updates => ({ ...updates,\n  [FIELD_COMMAND_SMS_CODES_NAME]: Object.values(updates[FIELD_COMMAND_SMS_CODES_NAME])\n});\n\nexport const CommandEditProgramStageDataEntryParserForm = ({\n  commandId,\n  onAfterChange\n}) => {\n  const {\n    error: loadingCommandError,\n    data: commandData\n  } = useReadSmsCommandProgramStageDataEntryParserQuery(commandId);\n  const command = commandData?.smsCommand;\n  const programStageDataElements = command?.programStage.programStageDataElements;\n  const updateCommand = useUpdateCommand({\n    commandId,\n    onAfterChange,\n    formatCommand: formatSmsCodes\n  });\n\n  if (loadingCommandError) {\n    const msg = i18n.t(\"Something went wrong whilst loading the command's details\");\n    return <NoticeBox error title={msg}>\n                {loadingCommandError.message}\n            </NoticeBox>;\n  }\n\n  if (!command) {\n    return <CenteredContent>\n                <CircularLoader />\n            </CenteredContent>;\n  }\n\n  const initialValues = getInitialFormState(command);\n  const selectedProgramOption = {\n    value: command.program.id,\n    label: command.program.displayName\n  };\n  const selectedProgramStageOption = {\n    value: command.programStage.id,\n    label: command.programStage.displayName\n  };\n  return <Form onSubmit={updateCommand} initialValues={initialValues}>\n            {({\n      handleSubmit,\n      values\n    }) => <form onSubmit={handleSubmit} data-test={dataTest('commands-commandeditprogramstagedataentryparserform')}>\n                    <FormRow>\n                        <FieldCommandName />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandParser disabled />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldProgram disabled programs={[selectedProgramOption]} />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldProgramStage disabled programStages={[selectedProgramStageOption]} />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandSeparator />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandDefaultMessage />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandWrongFormatMessage />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandNoUserMessage />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandMoreThanOneOrgUnitMessage />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandSuccessMessage />\n                    </FormRow>\n\n                    {programStageDataElements && <FormRow>\n                            <h2>{i18n.t('Program stage data elements')}</h2>\n\n                            <ProgramStageDataElements programStageDataElements={programStageDataElements} smsCodes={values[FIELD_COMMAND_SMS_CODES_NAME]} />\n                        </FormRow>}\n\n                    <SubmitErrors />\n                    <SaveCommandButton />\n                </form>}\n        </Form>;\n};\nCommandEditProgramStageDataEntryParserForm.propTypes = {\n  commandId: PropTypes.string.isRequired,\n  onAfterChange: PropTypes.func.isRequired\n};","import { useDataQuery } from '@dhis2/app-runtime'; // @TODO(non-critical):\n//   The response for key value parser\n//   does contain the information for \"Data element category combination\".\n//   But it does not contain the id of the category option combo,\n//   only the data element and a code.\n\nexport const READ_SMS_COMMAND_KEY_VALUE_PARSER_QUERY = {\n  smsCommand: {\n    resource: 'smsCommands',\n    id: ({\n      id\n    }) => id,\n    params: {\n      fields: ['*', 'dataset[id,displayName,dataSetElements[dataElement[id,displayName,categoryCombo[categoryOptionCombos[id,displayName,code]]]]'],\n      paging: 'false'\n    }\n  }\n};\nexport const useReadSmsCommandWithDataSetQuery = id => useDataQuery(READ_SMS_COMMAND_KEY_VALUE_PARSER_QUERY, {\n  variables: {\n    id\n  }\n});","import { CenteredContent, CircularLoader, NoticeBox, ReactFinalForm } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { ALL_DATAVALUE, AT_LEAST_ONE_DATAVALUE, CommandsAddSpecialCharacters, DataElementTimesCategoryOptionCombos, FIELD_COMMAND_COMPLETENESS_METHOD_NAME, FIELD_COMMAND_DEFAULT_MESSAGE_NAME, FIELD_COMMAND_MORE_THAN_ONE_ORG_UNIT_MESSAGE_NAME, FIELD_COMMAND_NAME_NAME, FIELD_COMMAND_NO_USER_MESSAGE_NAME, FIELD_COMMAND_PARSER_NAME, FIELD_COMMAND_SEPARATOR_NAME, FIELD_COMMAND_SMS_CODES_NAME, FIELD_COMMAND_SPECIAL_CHARS_NAME, FIELD_COMMAND_SUCCESS_MESSAGE_NAME, FIELD_COMMAND_USE_CURRENT_PERIOD_FOR_REPORTING_NAME, FIELD_COMMAND_WRONG_FORMAT_MESSAGE_NAME, FieldCommandCompletenessMethod, FieldCommandDefaultMessage, FieldCommandMoreThanOneOrgUnitMessage, FieldCommandName, FieldCommandNoUserMessage, FieldCommandParser, FieldCommandSeparator, FieldCommandSpecialCharacter, FieldCommandSuccessMessage, FieldCommandUseCurrentPeriodForReporting, FieldCommandWrongFormatMessage, KEY_VALUE_PARSER } from '../smsCommandFields';\nimport { SaveCommandButton, SubmitErrors, getSmsCodeDuplicates, useUpdateCommand } from '../smsCommand';\nimport { FIELD_DATA_SET_NAME, FieldDataSet } from '../dataSet';\nimport { FormRow } from '../forms';\nimport { useReadSmsCommandWithDataSetQuery } from './useReadSmsCommandWithDataSetQuery';\nimport i18n from '../locales';\nconst {\n  Form,\n  FormSpy\n} = ReactFinalForm;\n\nconst getInitialFormState = (command, initialCompletenessMethod) => {\n  const name = command[FIELD_COMMAND_NAME_NAME];\n  const parserType = KEY_VALUE_PARSER.value;\n  const dataSetId = {\n    id: command[FIELD_DATA_SET_NAME].id\n  };\n  const separator = command[FIELD_COMMAND_SEPARATOR_NAME];\n  const completenessMethod = initialCompletenessMethod || command[FIELD_COMMAND_COMPLETENESS_METHOD_NAME] || ALL_DATAVALUE.value;\n  const useCurrentPeriodForReporting = command[FIELD_COMMAND_USE_CURRENT_PERIOD_FOR_REPORTING_NAME];\n  const defaultMessage = command[FIELD_COMMAND_DEFAULT_MESSAGE_NAME];\n  const wrongFormatMessage = command[FIELD_COMMAND_WRONG_FORMAT_MESSAGE_NAME];\n  const noUserMessage = command[FIELD_COMMAND_NO_USER_MESSAGE_NAME];\n  const moreThanOneOrgUnitMessage = command[FIELD_COMMAND_MORE_THAN_ONE_ORG_UNIT_MESSAGE_NAME];\n  const successMessage = command[FIELD_COMMAND_SUCCESS_MESSAGE_NAME];\n  const smsCodes = command[FIELD_COMMAND_SMS_CODES_NAME].reduce((acc, {\n    code,\n    compulsory,\n    formula,\n    optionId,\n    dataElement\n  }) => {\n    const key = optionId < 10 ? dataElement.id : `${dataElement.id}-${optionId}`;\n    const smsCode = {\n      code,\n      compulsory,\n      optionId\n    };\n\n    if (formula) {\n      smsCode.formula = formula;\n    }\n\n    return { ...acc,\n      [key]: smsCode\n    };\n  }, {});\n  const specialCharacters = command[FIELD_COMMAND_SPECIAL_CHARS_NAME] || [];\n  return {\n    [FIELD_COMMAND_NAME_NAME]: name,\n    [FIELD_COMMAND_PARSER_NAME]: parserType,\n    [FIELD_DATA_SET_NAME]: dataSetId,\n    [FIELD_COMMAND_SEPARATOR_NAME]: separator,\n    [FIELD_COMMAND_COMPLETENESS_METHOD_NAME]: completenessMethod,\n    [FIELD_COMMAND_USE_CURRENT_PERIOD_FOR_REPORTING_NAME]: useCurrentPeriodForReporting,\n    [FIELD_COMMAND_DEFAULT_MESSAGE_NAME]: defaultMessage,\n    [FIELD_COMMAND_WRONG_FORMAT_MESSAGE_NAME]: wrongFormatMessage,\n    [FIELD_COMMAND_NO_USER_MESSAGE_NAME]: noUserMessage,\n    [FIELD_COMMAND_MORE_THAN_ONE_ORG_UNIT_MESSAGE_NAME]: moreThanOneOrgUnitMessage,\n    [FIELD_COMMAND_SUCCESS_MESSAGE_NAME]: successMessage,\n    smsCodes,\n    specialCharacters\n  };\n};\n\nconst globalValidate = DE_COC_combination_data => values => {\n  let hasErrors = false;\n  const errors = {};\n  const completenessMethod = values[FIELD_COMMAND_COMPLETENESS_METHOD_NAME];\n  const smsCodesFormState = values[FIELD_COMMAND_SMS_CODES_NAME];\n  const smsCodes = smsCodesFormState ? Object.entries(smsCodesFormState) : [];\n  const smsCodesWithValue = smsCodes.filter(([_, {\n    code\n  }]) => code); //eslint-disable-line no-unused-vars\n\n  if (completenessMethod === ALL_DATAVALUE.value && smsCodesWithValue.length !== DE_COC_combination_data?.length) {\n    hasErrors = true;\n    errors[FIELD_COMMAND_SMS_CODES_NAME] = errors[FIELD_COMMAND_SMS_CODES_NAME] || {};\n    errors[FIELD_COMMAND_SMS_CODES_NAME] = {\n      global: i18n.t(`With completeness method \"${ALL_DATAVALUE.label}\", all sms codes need to have a value`)\n    };\n  } else if (completenessMethod === AT_LEAST_ONE_DATAVALUE.value && !smsCodesWithValue.length) {\n    hasErrors = true;\n    errors[FIELD_COMMAND_SMS_CODES_NAME] = errors[FIELD_COMMAND_SMS_CODES_NAME] || {};\n    Object.assign(errors[FIELD_COMMAND_SMS_CODES_NAME], {\n      global: i18n.t(`With completeness method \"${AT_LEAST_ONE_DATAVALUE.label}\", you need to provide at least one value`)\n    });\n  }\n\n  if (smsCodesWithValue.length) {\n    const duplicates = getSmsCodeDuplicates(smsCodesWithValue);\n\n    if (duplicates.length) {\n      hasErrors = true;\n      const duplicateErrors = {};\n      duplicates.forEach(duplicate => {\n        duplicateErrors[duplicate] = {\n          code: i18n.t('Duplicate value!')\n        };\n      });\n      errors[FIELD_COMMAND_SMS_CODES_NAME] = errors[FIELD_COMMAND_SMS_CODES_NAME] || {};\n      Object.assign(errors[FIELD_COMMAND_SMS_CODES_NAME], duplicateErrors);\n    }\n  }\n\n  return hasErrors ? errors : undefined;\n};\n\nconst formatSmsCodes = updates => {\n  const smsCodes = updates[FIELD_COMMAND_SMS_CODES_NAME];\n  const formattedSmsCodes = Object.entries(smsCodes).map(([id, {\n    code,\n    formula,\n    compulsory,\n    optionId\n  }]) => {\n    const [dataElementId] = id.split('-');\n    const formattedSmsCode = {\n      code,\n      compulsory,\n      dataElement: {\n        id: dataElementId\n      }\n    };\n\n    if (formula) {\n      formattedSmsCode.formula = formula;\n    }\n\n    if (optionId) {\n      formattedSmsCode.optionId = optionId;\n    }\n\n    return formattedSmsCode;\n  });\n  return { ...updates,\n    [FIELD_COMMAND_SMS_CODES_NAME]: formattedSmsCodes\n  };\n};\n\nexport const CommandEditWithDataSetForm = ({\n  commandId,\n  onAfterChange,\n  dataTest,\n  initialCompletenessMethod\n}) => {\n  const {\n    error: loadingCommandError,\n    data: commandData\n  } = useReadSmsCommandWithDataSetQuery(commandId);\n  const command = commandData?.smsCommand;\n  const updateCommand = useUpdateCommand({\n    commandId,\n    onAfterChange,\n    formatCommand: formatSmsCodes\n  });\n\n  if (loadingCommandError) {\n    const msg = i18n.t(\"Something went wrong whilst loading the command's details\");\n    return <NoticeBox error title={msg}>\n                {loadingCommandError.message}\n            </NoticeBox>;\n  }\n\n  if (!command) {\n    return <CenteredContent>\n                <CircularLoader />\n            </CenteredContent>;\n  }\n\n  const selectedDataSetOption = {\n    value: command[FIELD_DATA_SET_NAME].id,\n    label: command[FIELD_DATA_SET_NAME].displayName\n  };\n  const initialValues = getInitialFormState(command, initialCompletenessMethod);\n  const DE_COC_combination_data = command.dataset.dataSetElements.reduce((curCombinations, {\n    dataElement\n  }) => {\n    const categoryOptionCombo = dataElement.categoryCombo?.categoryOptionCombo;\n\n    if (!categoryOptionCombo) {\n      return [...curCombinations, {\n        dataElement\n      }];\n    }\n\n    const combos = categoryOptionCombo.map(COC => ({\n      dataElement,\n      categoryOptionCombo: COC\n    }));\n    return [...curCombinations, ...combos];\n  }, []);\n  return <Form onSubmit={updateCommand} initialValues={initialValues} validate={globalValidate(DE_COC_combination_data)} subscription={{}}>\n            {({\n      handleSubmit,\n      form\n    }) => <form onSubmit={handleSubmit} data-test={dataTest}>\n                    <FormRow>\n                        <FieldCommandName />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandParser disabled />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldDataSet disabled dataSets={[selectedDataSetOption]} />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandCompletenessMethod />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandUseCurrentPeriodForReporting />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandSeparator />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandDefaultMessage />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandWrongFormatMessage />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandNoUserMessage />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandMoreThanOneOrgUnitMessage />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandSuccessMessage />\n                    </FormRow>\n\n                    {DE_COC_combination_data && <DataElementTimesCategoryOptionCombos DE_COC_combinations={DE_COC_combination_data} />}\n\n                    <div>\n                        <h2>Special characters</h2>\n\n                        <FormSpy subscription={{\n          values: true\n        }}>\n                            {({\n            values\n          }) => <>\n                                    {values[FIELD_COMMAND_SPECIAL_CHARS_NAME].map((_, index) => <FormRow key={index}>\n                                            <FieldCommandSpecialCharacter index={index} />\n                                        </FormRow>)}\n                                </>}\n                        </FormSpy>\n\n                        <CommandsAddSpecialCharacters />\n\n                        <FormRow>\n                            <hr />\n                        </FormRow>\n                    </div>\n\n                    <SubmitErrors />\n                    <SaveCommandButton />\n                </form>}\n        </Form>;\n};\nCommandEditWithDataSetForm.propTypes = {\n  commandId: PropTypes.string.isRequired,\n  onAfterChange: PropTypes.func.isRequired,\n  dataTest: PropTypes.string,\n  initialCompletenessMethod: PropTypes.string\n};","export const getSmsCodeDuplicates = smsCodes => {\n  const duplicates = smsCodes.reduce((curDuplicates, smsCode, index) => {\n    const [name, code] = smsCode;\n    const errorAlreadyPresent = curDuplicates.includes(name);\n\n    if (errorAlreadyPresent) {\n      return curDuplicates;\n    }\n\n    const potentialDuplicates = smsCodes.filter( // eslint-disable-next-line no-unused-vars\n    ([_, curCode], curIndex) => {\n      return curCode.code === code.code && curIndex !== index;\n    });\n    const noDuplicates = !potentialDuplicates.length;\n\n    if (noDuplicates) {\n      return curDuplicates;\n    }\n\n    const newlyFoundDuplicates = potentialDuplicates.reduce((curWithCodeDuplicates, [curName]) => {\n      return [...curWithCodeDuplicates, curName];\n    }, [name]);\n    return [...curDuplicates, ...newlyFoundDuplicates];\n  }, []);\n  return duplicates;\n};","import { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { CommandEditWithDataSetForm } from '../smsCommandWithDataSet';\nimport { dataTest } from '../dataTest';\nexport const CommandEditKeyValueParserForm = ({\n  commandId,\n  onAfterChange\n}) => <CommandEditWithDataSetForm dataTest={dataTest('smscommandkeyvalueparser-commandeditkeyvalueparserform')} commandId={commandId} onAfterChange={onAfterChange} />;\nCommandEditKeyValueParserForm.propTypes = {\n  commandId: PropTypes.string.isRequired,\n  onAfterChange: PropTypes.func.isRequired\n};","import { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { CommandEditWithDataSetForm } from '../smsCommandWithDataSet';\nimport { AT_LEAST_ONE_DATAVALUE } from '../smsCommandFields';\nimport { dataTest } from '../dataTest';\nexport const CommandEditJ2MEParserForm = ({\n  commandId,\n  onAfterChange\n}) => <CommandEditWithDataSetForm dataTest={dataTest('smscommandkeyvalueparser-commandeditj2meparserform')} commandId={commandId} onAfterChange={onAfterChange} initialCompletenessMethod={AT_LEAST_ONE_DATAVALUE.value} />;\nCommandEditJ2MEParserForm.propTypes = {\n  commandId: PropTypes.string.isRequired,\n  onAfterChange: PropTypes.func.isRequired\n};","import { useDataQuery } from '@dhis2/app-runtime';\nexport const READ_SMS_COMMAND_EVENT_REGISTRATION_PARSER_QUERY = {\n  smsCommand: {\n    resource: 'smsCommands',\n    id: ({\n      id\n    }) => id,\n    params: {\n      fields: ['*', 'program[id,displayName]', 'programStage[id,displayName,programStageDataElements[id,dataElement[id,displayName]]'],\n      paging: 'false'\n    }\n  }\n};\nexport const useReadSmsCommandEventRegistrationParserQuery = id => useDataQuery(READ_SMS_COMMAND_EVENT_REGISTRATION_PARSER_QUERY, {\n  variables: {\n    id\n  }\n});","import { CenteredContent, CircularLoader, NoticeBox, ReactFinalForm } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { EVENT_REGISTRATION_PARSER, FIELD_COMMAND_DEFAULT_MESSAGE_NAME, FIELD_COMMAND_MORE_THAN_ONE_ORG_UNIT_MESSAGE_NAME, FIELD_COMMAND_NAME_NAME, FIELD_COMMAND_NO_USER_MESSAGE_NAME, FIELD_COMMAND_PARSER_NAME, FIELD_COMMAND_PROGAM_NAME, FIELD_COMMAND_PROGAM_STAGE_NAME, FIELD_COMMAND_SEPARATOR_NAME, FIELD_COMMAND_SMS_CODES_NAME, FIELD_COMMAND_SUCCESS_MESSAGE_NAME, FIELD_COMMAND_WRONG_FORMAT_MESSAGE_NAME, FieldCommandDefaultMessage, FieldCommandMoreThanOneOrgUnitMessage, FieldCommandName, FieldCommandNoUserMessage, FieldCommandParser, FieldCommandSeparator, FieldCommandSuccessMessage, FieldCommandWrongFormatMessage, ProgramStageDataElements } from '../smsCommandFields';\nimport { SaveCommandButton, SubmitErrors, useUpdateCommand } from '../smsCommand';\nimport { FormRow } from '../forms';\nimport { FieldProgram } from '../program';\nimport { FieldProgramStage } from '../programStage';\nimport { useReadSmsCommandEventRegistrationParserQuery } from './useReadSmsCommandEventRegistrationParserQuery';\nimport i18n from '../locales';\nconst {\n  Form\n} = ReactFinalForm;\n\nconst getInitialFormState = command => {\n  const name = command[FIELD_COMMAND_NAME_NAME];\n  const program = command[FIELD_COMMAND_PROGAM_NAME];\n  const programStage = command[FIELD_COMMAND_PROGAM_STAGE_NAME];\n  const separator = command[FIELD_COMMAND_SEPARATOR_NAME];\n  const defaultMessage = command[FIELD_COMMAND_DEFAULT_MESSAGE_NAME];\n  const wrongFormatMessage = command[FIELD_COMMAND_WRONG_FORMAT_MESSAGE_NAME];\n  const noUserMessage = command[FIELD_COMMAND_NO_USER_MESSAGE_NAME];\n  const moreThanOneOrgUnitMessage = command[FIELD_COMMAND_MORE_THAN_ONE_ORG_UNIT_MESSAGE_NAME];\n  const successMessage = command[FIELD_COMMAND_SUCCESS_MESSAGE_NAME];\n  const smsCodes = command[FIELD_COMMAND_SMS_CODES_NAME].reduce((curSmsCodes, smsCode) => ({ ...curSmsCodes,\n    [smsCode.dataElement.id]: smsCode\n  }), {});\n  return {\n    [FIELD_COMMAND_NAME_NAME]: name,\n    [FIELD_COMMAND_PARSER_NAME]: EVENT_REGISTRATION_PARSER.value,\n    [FIELD_COMMAND_PROGAM_NAME]: program,\n    [FIELD_COMMAND_PROGAM_STAGE_NAME]: programStage,\n    [FIELD_COMMAND_SEPARATOR_NAME]: separator,\n    [FIELD_COMMAND_DEFAULT_MESSAGE_NAME]: defaultMessage,\n    [FIELD_COMMAND_WRONG_FORMAT_MESSAGE_NAME]: wrongFormatMessage,\n    [FIELD_COMMAND_NO_USER_MESSAGE_NAME]: noUserMessage,\n    [FIELD_COMMAND_MORE_THAN_ONE_ORG_UNIT_MESSAGE_NAME]: moreThanOneOrgUnitMessage,\n    [FIELD_COMMAND_SUCCESS_MESSAGE_NAME]: successMessage,\n    [FIELD_COMMAND_SMS_CODES_NAME]: smsCodes\n  };\n};\n\nconst formatSmsCodes = updates => ({ ...updates,\n  [FIELD_COMMAND_SMS_CODES_NAME]: Object.values(updates[FIELD_COMMAND_SMS_CODES_NAME])\n});\n\nexport const CommandEditEventRegistrationParserForm = ({\n  commandId,\n  onAfterChange\n}) => {\n  const {\n    error,\n    data: {\n      smsCommand: command\n    } = {}\n  } = useReadSmsCommandEventRegistrationParserQuery(commandId);\n  const updateCommand = useUpdateCommand({\n    commandId,\n    onAfterChange,\n    formatCommand: formatSmsCodes\n  });\n\n  if (error) {\n    const msg = i18n.t(\"Something went wrong whilst loading the command's details\");\n    return <NoticeBox error title={msg}>\n                {error.message}\n            </NoticeBox>;\n  }\n\n  if (!command) {\n    return <CenteredContent>\n                <CircularLoader />\n            </CenteredContent>;\n  }\n\n  const selectedProgramOption = {\n    value: command.program.id,\n    label: command.program.displayName\n  };\n  const selectedProgramStageOption = {\n    value: command.programStage.id,\n    label: command.programStage.displayName\n  };\n  const programStageDataElements = command.programStage.programStageDataElements;\n  const initialValues = getInitialFormState(command);\n  return <Form initialValues={initialValues} onSubmit={updateCommand}>\n            {({\n      handleSubmit,\n      values\n    }) => {\n      return <form onSubmit={handleSubmit}>\n                        <FormRow>\n                            <FieldCommandName />\n                        </FormRow>\n\n                        <FormRow>\n                            <FieldCommandParser disabled />\n                        </FormRow>\n\n                        <FormRow>\n                            <FieldProgram disabled programs={[selectedProgramOption]} />\n                        </FormRow>\n\n                        <FormRow>\n                            <FieldProgramStage disabled programStages={[selectedProgramStageOption]} />\n                        </FormRow>\n\n                        <FormRow>\n                            <FieldCommandSeparator />\n                        </FormRow>\n\n                        <FormRow>\n                            <FieldCommandDefaultMessage />\n                        </FormRow>\n\n                        <FormRow>\n                            <FieldCommandWrongFormatMessage />\n                        </FormRow>\n\n                        <FormRow>\n                            <FieldCommandNoUserMessage />\n                        </FormRow>\n\n                        <FormRow>\n                            <FieldCommandMoreThanOneOrgUnitMessage />\n                        </FormRow>\n\n                        <FormRow>\n                            <FieldCommandSuccessMessage />\n                        </FormRow>\n\n                        {programStageDataElements && <FormRow>\n                                <h2>{i18n.t('Program stage data elements')}</h2>\n\n                                <ProgramStageDataElements programStageDataElements={programStageDataElements} smsCodes={values[FIELD_COMMAND_SMS_CODES_NAME]} />\n                            </FormRow>}\n\n                        <SubmitErrors />\n                        <SaveCommandButton />\n                    </form>;\n    }}\n        </Form>;\n};\nCommandEditEventRegistrationParserForm.propTypes = {\n  commandId: PropTypes.string.isRequired,\n  onAfterChange: PropTypes.func.isRequired\n};","import React from 'react';\nimport { PropTypes } from '@dhis2/prop-types';\nimport { ReactFinalForm, NoticeBox, CenteredContent, CircularLoader } from '@dhis2/ui';\nimport { useDataQuery } from '@dhis2/app-runtime';\nimport { FieldCommandName, FieldCommandParser, FieldCommandConfirmMessage } from '../smsCommandFields';\nimport { SaveCommandButton, SubmitErrors, useUpdateCommand } from '../smsCommand';\nimport { FieldUserGroup } from '../userGroup';\nimport { FormRow } from '../forms';\nimport { dataTest } from '../dataTest';\nimport i18n from '../locales';\nconst {\n  Form\n} = ReactFinalForm;\nconst query = {\n  smsCommand: {\n    resource: 'smsCommands',\n    id: ({\n      commandId\n    }) => commandId,\n    params: {\n      fields: ['name', 'parserType', 'receivedMessage', 'userGroup[name,id]']\n    }\n  }\n};\nexport const CommandEditAlertParserForm = ({\n  commandId,\n  onAfterChange\n}) => {\n  const updateCommand = useUpdateCommand({\n    commandId,\n    onAfterChange,\n    replace: true\n  });\n  const {\n    loading,\n    error,\n    data\n  } = useDataQuery(query, {\n    variables: {\n      commandId\n    }\n  });\n\n  if (loading) {\n    return <CenteredContent>\n                <CircularLoader />\n            </CenteredContent>;\n  }\n\n  if (error) {\n    const msg = i18n.t('Something went wrong whilst loading the sms command');\n    return <NoticeBox error title={msg}>\n                {error.message}\n            </NoticeBox>;\n  }\n\n  const {\n    name,\n    parserType,\n    receivedMessage,\n    userGroup\n  } = data.smsCommand;\n  const initialValues = {\n    name,\n    parserType,\n    receivedMessage,\n    userGroup: userGroup.id\n  };\n  const userGroups = [{\n    value: userGroup.id,\n    label: userGroup.name\n  }];\n  return <Form onSubmit={updateCommand} initialValues={initialValues}>\n            {({\n      handleSubmit\n    }) => <form onSubmit={handleSubmit} data-test={dataTest('commands-commandeditalertparserform')}>\n                    <FormRow>\n                        <FieldCommandName />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandParser disabled />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldUserGroup disabled userGroups={userGroups} />\n                    </FormRow>\n\n                    <FormRow>\n                        <FieldCommandConfirmMessage />\n                    </FormRow>\n\n                    <SubmitErrors />\n                    <SaveCommandButton />\n                </form>}\n        </Form>;\n};\nCommandEditAlertParserForm.propTypes = {\n  commandId: PropTypes.string.isRequired,\n  onAfterChange: PropTypes.func.isRequired\n};","import { NoticeBox, CenteredContent, CircularLoader } from '@dhis2/ui';\nimport { useHistory, useParams } from 'react-router-dom';\nimport React from 'react';\nimport { PageHeadline } from '../../headline';\nimport { isParserType, useReadSmsCommandParserTypeQuery } from '../../smsCommand';\nimport { ALERT_PARSER, EVENT_REGISTRATION_PARSER, J2ME_PARSER, KEY_VALUE_PARSER, PROGRAM_STAGE_DATAENTRY_PARSER, TRACKED_ENTITY_REGISTRATION_PARSER, UNREGISTERED_PARSER, FIELD_COMMAND_PARSER_NAME } from '../../smsCommandFields';\nimport { CommandEditUnregisteredParserForm } from '../../smsCommandUnregisteredParser';\nimport { CommandEditTrackedEntityRegistrationParserForm } from '../../smsCommandTrackedEntityRegistrationParser';\nimport { CommandEditProgramStageDataEntryParserForm } from '../../smsCommandProgramStageDataEntryParser';\nimport { CommandEditKeyValueParserForm } from '../../smsCommandKeyValueParser';\nimport { CommandEditJ2MEParserForm } from '../../smsCommandJ2MEParser';\nimport { CommandEditEventRegistrationParserForm } from '../../smsCommandEventRegistrationParser';\nimport { CommandEditAlertParserForm } from '../../smsCommandAlertParser';\nimport { SMS_COMMAND_LIST_PATH } from './SmsCommandList';\nimport i18n from '../../locales';\nexport const SMS_COMMAND_FORM_EDIT_PATH_STATIC = '/sms-config/edit';\nexport const SMS_COMMAND_FORM_EDIT_PATH = `${SMS_COMMAND_FORM_EDIT_PATH_STATIC}/:id`;\nexport const SmsCommandFormEdit = () => {\n  const history = useHistory();\n  const {\n    id\n  } = useParams();\n  const {\n    loading,\n    error,\n    data\n  } = useReadSmsCommandParserTypeQuery(id);\n\n  if (loading) {\n    return <CenteredContent>\n                <CircularLoader />\n            </CenteredContent>;\n  }\n\n  if (error) {\n    const msg = i18n.t('Something went wrong whilst loading commands');\n    return <NoticeBox error title={msg}>\n                {error.message}\n            </NoticeBox>;\n  }\n\n  const parserType = data?.smsCommand[FIELD_COMMAND_PARSER_NAME];\n  const isParser = isParserType.bind(null, parserType);\n  return <div>\n            <PageHeadline>{i18n.t('Edit command')}</PageHeadline>\n\n            {parserType && isParser(KEY_VALUE_PARSER) && <CommandEditKeyValueParserForm commandId={id} onAfterChange={() => history.push(SMS_COMMAND_LIST_PATH)} />}\n\n            {parserType && isParser(J2ME_PARSER) && <CommandEditJ2MEParserForm commandId={id} onAfterChange={() => history.push(SMS_COMMAND_LIST_PATH)} />}\n\n            {parserType && isParser(ALERT_PARSER) && <CommandEditAlertParserForm commandId={id} onAfterChange={() => history.push(SMS_COMMAND_LIST_PATH)} />}\n\n            {parserType && isParser(PROGRAM_STAGE_DATAENTRY_PARSER) && <CommandEditProgramStageDataEntryParserForm commandId={id} onAfterChange={() => history.push(SMS_COMMAND_LIST_PATH)} />}\n\n            {parserType && isParser(UNREGISTERED_PARSER) && <CommandEditUnregisteredParserForm commandId={id} onAfterChange={() => history.push(SMS_COMMAND_LIST_PATH)} />}\n\n            {parserType && isParser(EVENT_REGISTRATION_PARSER) && <CommandEditEventRegistrationParserForm commandId={id} onAfterChange={() => history.push(SMS_COMMAND_LIST_PATH)} />}\n\n            {parserType && isParser(TRACKED_ENTITY_REGISTRATION_PARSER) && <CommandEditTrackedEntityRegistrationParserForm commandId={id} onAfterChange={() => history.push(SMS_COMMAND_LIST_PATH)} />}\n\n            {!parserType && <NoticeBox error title={i18n.t('Unrecognised parser type')}>\n                    {i18n.t('Could not find the requested parser type')}\n                </NoticeBox>}\n        </div>;\n};","import { Button, ReactFinalForm, CircularLoader } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React, { useEffect, useState } from 'react';\nimport { useHistory } from 'react-router';\nimport { ALERT_PARSER, EVENT_REGISTRATION_PARSER, FIELD_COMMAND_PARSER_NAME, J2ME_PARSER, KEY_VALUE_PARSER, PROGRAM_STAGE_DATAENTRY_PARSER, TRACKED_ENTITY_REGISTRATION_PARSER, UNREGISTERED_PARSER, FieldCommandName, FieldCommandParser } from '../../smsCommandFields';\nimport { useCreateSmsCommandMutation } from '../../smsCommand';\nimport { FieldDataSetWithAutoLoad } from '../../dataSet';\nimport { FIELD_PROGRAM_NAME, FieldProgramWithAutoLoad } from '../../program';\nimport { FIELD_PROGRAM_STAGE_NAME, FieldProgramStageWithAutoLoad } from '../../programStage';\nimport { FieldUserGroupWithAutoLoad } from '../../userGroup';\nimport { FormRow } from '../../forms';\nimport { PageHeadline } from '../../headline';\nimport i18n from '../../locales';\nimport { SMS_COMMAND_LIST_PATH } from './SmsCommandList';\nconst {\n  Form,\n  useForm\n} = ReactFinalForm;\nexport const SMS_COMMAND_FORM_NEW_PATH = '/sms-config/new';\n\nconst useResetFormFields = () => {\n  const form = useForm();\n  const [prevValues, setPrevValues] = useState(form.getState().values);\n  useEffect(() => form.subscribe(({\n    values\n  }) => {\n    form.batch(() => {\n      const parserType = values[FIELD_COMMAND_PARSER_NAME];\n      const program = values[FIELD_PROGRAM_NAME];\n      const programStage = values[FIELD_PROGRAM_STAGE_NAME];\n      const prevProgram = prevValues[FIELD_PROGRAM_NAME];\n      const prevParserType = prevValues[FIELD_COMMAND_PARSER_NAME];\n      const programChanged = prevProgram && program !== prevProgram;\n      const parserTypeChanged = prevParserType && parserType !== prevParserType;\n\n      if ( // only unset program stage if one exists already\n      programStage && (programChanged || parserTypeChanged)) {\n        form.change(FIELD_PROGRAM_STAGE_NAME, null);\n      }\n    });\n    setPrevValues(values);\n  }, {\n    values: true\n  }), [prevValues]);\n};\n\nconst ActualForm = ({\n  handleSubmit,\n  submitting\n}) => {\n  // This is required to unset form fields that depend\n  // on the selected value of a previous field\n  useResetFormFields();\n  const form = useForm();\n  const {\n    values\n  } = form.getState();\n  const parserType = values[FIELD_COMMAND_PARSER_NAME];\n  const program = values[FIELD_PROGRAM_NAME];\n  const showDataSetField = parserType === KEY_VALUE_PARSER.value || parserType === J2ME_PARSER.value;\n  const showUserGroupField = parserType === ALERT_PARSER.value || parserType === UNREGISTERED_PARSER.value;\n  const showProgramField = parserType === TRACKED_ENTITY_REGISTRATION_PARSER.value || parserType === PROGRAM_STAGE_DATAENTRY_PARSER.value || parserType === EVENT_REGISTRATION_PARSER.value;\n  const showProgramStageField = parserType === PROGRAM_STAGE_DATAENTRY_PARSER.value;\n  const registration = // undefined = all, false = program.programType --> WITHOUT_REGISTRATION\n  parserType === EVENT_REGISTRATION_PARSER.value ? false : undefined;\n  return <div>\n            <PageHeadline>{i18n.t('Add command')}</PageHeadline>\n            <form onSubmit={handleSubmit}>\n                <FormRow>\n                    <FieldCommandName />\n                </FormRow>\n\n                <FormRow>\n                    <FieldCommandParser />\n                </FormRow>\n\n                {showDataSetField && <FormRow>\n                        <FieldDataSetWithAutoLoad />\n                    </FormRow>}\n\n                {showUserGroupField && <FormRow>\n                        <FieldUserGroupWithAutoLoad />\n                    </FormRow>}\n\n                {showProgramField && <FormRow>\n                        <FieldProgramWithAutoLoad registration={registration} />\n                    </FormRow>}\n\n                {showProgramStageField && <FormRow>\n                        <FieldProgramStageWithAutoLoad programId={program || ''} />\n                    </FormRow>}\n\n                <Button primary type=\"submit\" icon={submitting ? <CircularLoader small /> : null} disabled={submitting}>\n                    {i18n.t('Add command')}\n                </Button>\n            </form>\n        </div>;\n};\n\nActualForm.propTypes = {\n  handleSubmit: PropTypes.func.isRequired,\n  submitting: PropTypes.bool.isRequired\n};\nexport const SmsCommandFormNew = () => {\n  const history = useHistory();\n  const [createSmsCommand] = useCreateSmsCommandMutation({\n    onComplete: () => history.push(SMS_COMMAND_LIST_PATH)\n  });\n\n  const onSubmit = values => createSmsCommand(values);\n\n  return <Form onSubmit={onSubmit}>\n            {({\n      handleSubmit,\n      submitting\n    }) => <ActualForm handleSubmit={handleSubmit} submitting={submitting} />}\n        </Form>;\n};","import { Button, Checkbox, Table, TableHead, TableBody, TableRow, TableRowHead, TableCell, TableCellHead, NoticeBox, CenteredContent, CircularLoader } from '@dhis2/ui';\nimport { useHistory } from 'react-router-dom';\nimport React, { useState } from 'react';\nimport { SMS_COMMAND_FORM_EDIT_PATH_STATIC } from './SmsCommandFormEdit';\nimport { SMS_COMMAND_FORM_NEW_PATH } from './SmsCommandFormNew';\nimport { ListActions } from '../../dataList';\nimport { PageHeadline } from '../../headline';\nimport { DeleteCommandsConfirmationDialog, getLabelByParserTypes, useDeleteSmsCommandMutation, useReadSmsCommandsQuery } from '../../smsCommand';\nimport { dataTest } from '../../dataTest';\nimport i18n from '../../locales';\nimport styles from './SmsCommandList.module.css';\nexport const SMS_COMMAND_LIST_LABEL = i18n.t('Commands');\nexport const SMS_COMMAND_LIST_PATH = '/sms-config';\nexport const SmsCommandList = () => {\n  const history = useHistory();\n\n  const onAddCommandClick = () => history.push(SMS_COMMAND_FORM_NEW_PATH);\n\n  const [checkedSmsCommands, setCheckedSmsCommands] = useState([]);\n  const [showDeleteConfirmationDialog, setShowDeleteConfirmationDialog] = useState(false);\n  const {\n    loading: loadingReadSmsCommands,\n    error: errorReadSmsCommands,\n    data,\n    refetch\n  } = useReadSmsCommandsQuery();\n  const [deleteSmsCommands, {\n    loading: loadingDelete,\n    error: errorDelete\n  }] = useDeleteSmsCommandMutation();\n\n  if (loadingReadSmsCommands) {\n    return <div data-test={dataTest('views-smscommandlist')}>\n                <PageHeadline>{SMS_COMMAND_LIST_LABEL}</PageHeadline>\n                <CenteredContent>\n                    <CircularLoader />\n                </CenteredContent>\n            </div>;\n  }\n\n  const error = errorReadSmsCommands || errorDelete;\n\n  if (error) {\n    const msg = i18n.t('Something went wrong whilst performing the requested operation');\n    return <div data-test={dataTest('views-smscommandlist')}>\n                <PageHeadline>{SMS_COMMAND_LIST_LABEL}</PageHeadline>\n                <NoticeBox error title={msg}>\n                    {error.message}\n                </NoticeBox>\n            </div>;\n  }\n\n  const onToggleCallChange = () => {\n    const smsCommands = data?.smsCommands?.smsCommands;\n\n    if (!smsCommands) {\n      return;\n    }\n\n    if (checkedSmsCommands.length === smsCommands.length) {\n      setCheckedSmsCommands([]);\n    } else {\n      setCheckedSmsCommands(smsCommands.map(({\n        id,\n        displayName\n      }) => ({\n        id,\n        displayName\n      })));\n    }\n  };\n\n  const toggleSmsCommand = smsCommand => {\n    const {\n      id\n    } = smsCommand;\n\n    if (checkedSmsCommands.find(({\n      id: checkedId\n    }) => id === checkedId)) {\n      const index = checkedSmsCommands.findIndex(({\n        id: checkedId\n      }) => id === checkedId);\n      return setCheckedSmsCommands([...checkedSmsCommands.slice(0, index), ...checkedSmsCommands.slice(index + 1)]);\n    }\n\n    return setCheckedSmsCommands([...checkedSmsCommands, smsCommand]);\n  };\n\n  const onDeleteClick = async () => {\n    const ids = checkedSmsCommands.map(({\n      id\n    }) => id);\n    await deleteSmsCommands({\n      ids\n    });\n    setCheckedSmsCommands([]);\n    setShowDeleteConfirmationDialog(false);\n    refetch();\n  };\n\n  const allChecked = checkedSmsCommands.length === data?.smsCommands?.smsCommands?.length;\n  const hasCommands = data?.smsCommands?.smsCommands?.length > 0;\n  return <div data-test={dataTest('views-smscommandlist')}>\n            <PageHeadline>{SMS_COMMAND_LIST_LABEL}</PageHeadline>\n\n            <ListActions addLabel={i18n.t('Add command')} deleteLabel={i18n.t('Delete selected')} dataTest=\"views-smscommandlist\" onAddClick={onAddCommandClick} onDeleteClick={() => setShowDeleteConfirmationDialog(true)} disableAdd={loadingDelete} disableDelete={!checkedSmsCommands.length || loadingDelete} />\n\n            {showDeleteConfirmationDialog && <DeleteCommandsConfirmationDialog onCancelClick={() => setShowDeleteConfirmationDialog(false)} onDeleteClick={onDeleteClick} />}\n\n            <Table>\n                <TableHead>\n                    <TableRowHead>\n                        <TableCellHead>\n                            <Checkbox checked={allChecked} onChange={onToggleCallChange} />\n                        </TableCellHead>\n                        <TableCellHead>{i18n.t('Sms command')}</TableCellHead>\n                        <TableCellHead>{i18n.t('Parser')}</TableCellHead>\n                        <TableCellHead />\n                    </TableRowHead>\n                </TableHead>\n                <TableBody>\n                    {hasCommands ? data?.smsCommands?.smsCommands?.map(({\n          id,\n          displayName,\n          parserType\n        }) => <TableRow key={id}>\n                                    <TableCell className={styles.checkbox}>\n                                        <Checkbox checked={!!checkedSmsCommands.find(({\n              id: checkedId\n            }) => id === checkedId)} onChange={() => toggleSmsCommand({\n              id,\n              displayName\n            })} />\n                                    </TableCell>\n\n                                    <TableCell>{displayName}</TableCell>\n\n                                    <TableCell>\n                                        {getLabelByParserTypes(parserType)}\n                                    </TableCell>\n\n                                    <TableCell className={styles.editButtonCell}>\n                                        <Button onClick={() => history.push(`${SMS_COMMAND_FORM_EDIT_PATH_STATIC}/${id}`)}>\n                                            {i18n.t('Edit')}\n                                        </Button>\n                                    </TableCell>\n                                </TableRow>) : <TableRow>\n                            <TableCell colSpan=\"4\" className={styles.noResults}>\n                                {i18n.t('No commands to display')}\n                            </TableCell>\n                        </TableRow>}\n                </TableBody>\n            </Table>\n        </div>;\n};","import * as parserTypes from '../smsCommandFields';\nexport const getLabelByParserTypes = parserType => {\n  const type = Object.values(parserTypes).find(({\n    value\n  }) => value === parserType);\n  return type?.label || parserType;\n};","import i18n from '@dhis2/d2-i18n';\nexport const statusMap = {\n  DELIVERED: i18n.t('Delivered'),\n  ERROR: i18n.t('Error'),\n  FAILED: i18n.t('Failed'),\n  OUTBOUND: i18n.t('Outbound'),\n  PENDING: i18n.t('Pending'),\n  SCHEDULED: i18n.t('Scheduled'),\n  SENT: i18n.t('Sent')\n};","import { createContext } from 'react';\nconst message = 'RefetchSms consumer needs to have a valid Provider as parent';\n\nconst throwError = () => {\n  throw new Error(message);\n}; // Throws an error if the consumer is not nested in a provider\n\n\nconst RefetchSms = createContext({\n  refetch: throwError,\n  refetchAndClear: throwError\n});\nexport default RefetchSms;","import React, { useContext } from 'react';\nimport { Button } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport { useDataMutation } from '@dhis2/app-runtime';\nimport i18n from '../../locales';\nimport { AlertContext } from '../../notifications';\nimport RefetchSms from './RefetchSms';\nconst mutation = {\n  resource: 'sms/outbound',\n  params: ({\n    ids\n  }) => ({\n    ids\n  }),\n  type: 'delete'\n};\n\nconst DeleteButton = ({\n  id,\n  cleanSelected\n}) => {\n  const {\n    addAlert\n  } = useContext(AlertContext);\n  const {\n    refetch\n  } = useContext(RefetchSms);\n  const [mutate, {\n    loading\n  }] = useDataMutation(mutation, {\n    onComplete: () => {\n      cleanSelected(id);\n      refetch();\n    },\n    onError: error => {\n      addAlert({\n        type: 'critical',\n        message: error.message\n      });\n    },\n    variables: {\n      ids: id\n    }\n  });\n  /**\n   * We're disabling the button when fetching instead of rendering a spinner, since rendering\n   * a spinner results in the whole table jumping and for a short fetch that looks very buggy\n   */\n\n  return <Button small destructive onClick={mutate} disabled={loading}>\n            {i18n.t('Delete')}\n        </Button>;\n};\n\nDeleteButton.propTypes = {\n  cleanSelected: PropTypes.func.isRequired,\n  id: PropTypes.string.isRequired\n};\nexport default DeleteButton;","import React from 'react';\nimport { TableRow, TableCell, Checkbox } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport moment from 'moment';\nimport { statusMap } from './translations';\nimport DeleteButton from './DeleteButton';\n\nconst SmsTableItem = ({\n  sms,\n  toggleSelected,\n  isSelected,\n  cleanSelected\n}) => {\n  const {\n    message,\n    status,\n    date,\n    id\n  } = sms;\n  /**\n   *FIXME: after a deletion, for a short while the backend returns null for\n   * recipients. We can't catch that with a default value since it's not\n   * undefined, so we're doing it this way.\n   */\n\n  const recipients = sms.recipients === null ? [] : sms.recipients;\n  return <TableRow>\n            <TableCell>\n                <Checkbox onChange={() => toggleSelected(id)} checked={isSelected} />\n            </TableCell>\n            <TableCell>{message}</TableCell>\n            <TableCell>{recipients.join(', ')}</TableCell>\n            <TableCell>{statusMap[status]}</TableCell>\n            <TableCell>\n                {moment(date).format('MMMM Do YYYY, h:mm:ss a')}\n            </TableCell>\n            <TableCell>\n                <DeleteButton id={id} cleanSelected={cleanSelected} />\n            </TableCell>\n        </TableRow>;\n};\n\nSmsTableItem.propTypes = {\n  cleanSelected: PropTypes.func.isRequired,\n  isSelected: PropTypes.bool.isRequired,\n  sms: PropTypes.shape({\n    date: PropTypes.string.isRequired,\n    id: PropTypes.string.isRequired,\n    message: PropTypes.string.isRequired,\n    status: PropTypes.string.isRequired,\n    recipients: PropTypes.arrayOf(PropTypes.string)\n  }).isRequired,\n  toggleSelected: PropTypes.func.isRequired\n};\nexport default SmsTableItem;","import React, { useContext } from 'react';\nimport { Button, SingleSelect, SingleSelectOption } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport i18n from '../../locales';\nimport RefetchSms from './RefetchSms';\nimport s from './Pagination.module.css';\nconst pageSizes = ['10', '20', '30', '40', '50', '100'];\n\nconst Pagination = ({\n  pager\n}) => {\n  const {\n    refetchAndClear\n  } = useContext(RefetchSms);\n\n  const changePage = newPage => {\n    refetchAndClear({\n      page: newPage\n    });\n  };\n\n  const changePageSize = newSize => {\n    refetchAndClear({\n      pageSize: newSize,\n      page: 1\n    });\n  };\n\n  const {\n    page,\n    pageCount,\n    pageSize,\n    total\n  } = pager;\n  const firstItem = Math.min((page - 1) * pageSize + 1, total);\n  const lastItem = Math.min(firstItem + pageSize - 1, total);\n  const availablePages = Array.from({\n    length: pageCount\n  }, (_x, i) => (i + 1).toString());\n  return <div className={s.container}>\n            <div className={s.left}>\n                <span>{i18n.t('Show')}</span>\n                <SingleSelect dense selected={pageSize.toString()} onChange={({\n        selected\n      }) => changePageSize(selected)}>\n                    {pageSizes.map(size => <SingleSelectOption key={size} value={size} label={size} />)}\n                </SingleSelect>\n                <span>{i18n.t('per page')}</span>\n            </div>\n            <div className={s.right}>\n                <div className={s.amount}>\n                    {i18n.t('Viewing {{firstItem}}-{{lastItem}} of {{total}}', {\n          firstItem,\n          lastItem,\n          total\n        })}\n                </div>\n                <Button small disabled={page === 1} onClick={() => changePage(page - 1)}>\n                    {i18n.t('Previous')}\n                </Button>\n                <div className={s.pageselection}>\n                    <div>{i18n.t('Page')}</div>\n                    <SingleSelect dense selected={page.toString()} onChange={({\n          selected\n        }) => {\n          changePage(selected);\n        }}>\n                        {availablePages.map(page => <SingleSelectOption key={page} value={page} label={page} />)}\n                    </SingleSelect>\n                    <div>{i18n.t('of {{pageCount}}', {\n            pageCount\n          })}</div>\n                </div>\n                <Button small disabled={page === pageCount} onClick={() => changePage(page + 1)}>\n                    {i18n.t('Next')}\n                </Button>\n            </div>\n        </div>;\n};\n\nPagination.propTypes = {\n  pager: PropTypes.shape({\n    page: PropTypes.number.isRequired,\n    pageCount: PropTypes.number.isRequired,\n    pageSize: PropTypes.number.isRequired,\n    total: PropTypes.number.isRequired\n  }).isRequired\n};\nexport default Pagination;","import React from 'react';\nimport { Checkbox } from '@dhis2/ui';\nimport i18n from '../../locales';\nimport { Table, TableHead, TableRowHead, TableRow, TableCell, TableCellHead, TableBody, TableFoot } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport SmsTableItem from './SmsTableItem';\nimport Pagination from './Pagination';\nimport s from './SmsTable.module.css';\n\nconst SmsTable = ({\n  smses,\n  cleanSelected,\n  toggleSelected,\n  toggleAll,\n  allSelected,\n  selected,\n  pager\n}) => <Table>\n        <TableHead>\n            <TableRowHead>\n                <TableCellHead>\n                    <Checkbox disabled={smses.length === 0} onChange={toggleAll} checked={allSelected} />\n                </TableCellHead>\n                <TableCellHead>{i18n.t('Message')}</TableCellHead>\n                <TableCellHead>{i18n.t('Recipients')}</TableCellHead>\n                <TableCellHead>{i18n.t('Status')}</TableCellHead>\n                <TableCellHead>{i18n.t('Date')}</TableCellHead>\n                <TableCellHead>{i18n.t('Delete')}</TableCellHead>\n            </TableRowHead>\n        </TableHead>\n        <TableBody>\n            {smses.length === 0 ? <TableRow>\n                    <TableCell colSpan=\"7\" className={s.noResults}>\n                        {i18n.t('No SMSes to display')}\n                    </TableCell>\n                </TableRow> : smses.map(sms => <SmsTableItem key={sms.id} sms={sms} isSelected={selected.includes(sms.id)} toggleSelected={toggleSelected} cleanSelected={cleanSelected} />)}\n        </TableBody>\n        <TableFoot>\n            <TableRow>\n                <TableCell colSpan=\"7\">\n                    <Pagination pager={pager} />\n                </TableCell>\n            </TableRow>\n        </TableFoot>\n    </Table>;\n\nSmsTable.propTypes = {\n  allSelected: PropTypes.bool.isRequired,\n  cleanSelected: PropTypes.func.isRequired,\n  pager: PropTypes.object.isRequired,\n  selected: PropTypes.arrayOf(PropTypes.string).isRequired,\n  smses: PropTypes.arrayOf(PropTypes.object).isRequired,\n  toggleAll: PropTypes.func.isRequired,\n  toggleSelected: PropTypes.func.isRequired\n};\nexport default SmsTable;","import React, { useContext } from 'react';\nimport { PropTypes } from '@dhis2/prop-types';\nimport { SingleSelectField, SingleSelectOption } from '@dhis2/ui';\nimport i18n from '../../locales';\nimport RefetchSms from './RefetchSms';\nimport { statusMap } from './translations';\n/**\n * Using ALL instead of a more sensible empty string due to a bug in the Select,\n * which means the select doesn't allow empty strings as values.\n * https://github.com/dhis2/ui/issues/245\n */\n\nexport const parseStatus = status => {\n  if (status === 'ALL') {\n    return '';\n  }\n\n  return status;\n}; // From https://github.com/dhis2/dhis2-core/blob/master/dhis-2/dhis-api/src/main/java/org/hisp/dhis/sms/outbound/OutboundSmsStatus.java\n\nconst statuses = ['DELIVERED', 'ERROR', 'FAILED', 'OUTBOUND', 'PENDING', 'SCHEDULED', 'SENT'];\nconst filterOptions = [{\n  label: i18n.t('All'),\n  value: 'ALL'\n}, // Using the translations from statusmap as labels\n...statuses.map(status => ({\n  label: statusMap[status],\n  value: status\n}))];\n\nconst StatusFilter = ({\n  status,\n  setStatus\n}) => {\n  const {\n    refetchAndClear\n  } = useContext(RefetchSms);\n\n  const onChange = ({\n    selected\n  }) => {\n    setStatus(selected);\n    refetchAndClear({\n      status: parseStatus(selected),\n      // Reset to the first page after filtering\n      page: 1\n    });\n  };\n\n  return <SingleSelectField label={i18n.t('Filter by status')} inputWidth=\"200px\" onChange={onChange} selected={status}>\n            {filterOptions.map(({\n      label,\n      value\n    }) => <SingleSelectOption key={label} label={label} value={value} />)}\n        </SingleSelectField>;\n};\n\nStatusFilter.propTypes = {\n  setStatus: PropTypes.func.isRequired,\n  status: PropTypes.string.isRequired\n};\nexport default StatusFilter;","// Returns an array of all the ids\nexport const getAllIds = smses => smses.map(sms => sms.id); // Returns true if all smses are selected, false if not\n\nexport const getAllSelected = (allIds, selected) => {\n  // If there are no ids there's nothing to select\n  const noIds = allIds.length === 0; // If the lengths don't match we're assuming that they're not all selected (assuming no duplicate ids)\n\n  const noLengthMatch = allIds.length !== selected.length;\n\n  if (noIds || noLengthMatch) {\n    return false;\n  }\n\n  return allIds.every(id => selected.includes(id));\n};","import React, { useContext } from 'react';\nimport { Button } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport { useDataMutation } from '@dhis2/app-runtime';\nimport i18n from '../../locales';\nimport { AlertContext } from '../../notifications';\nimport RefetchSms from './RefetchSms';\nconst mutation = {\n  resource: 'sms/outbound',\n  params: ({\n    ids\n  }) => ({\n    ids\n  }),\n  type: 'delete'\n};\n\nconst DeleteSelectedButton = ({\n  selected\n}) => {\n  const disabled = selected.length === 0;\n  const ids = selected.join(',');\n  const {\n    addAlert\n  } = useContext(AlertContext);\n  const {\n    refetchAndClear\n  } = useContext(RefetchSms);\n  const [mutate, {\n    loading\n  }] = useDataMutation(mutation, {\n    onComplete: () => {\n      refetchAndClear();\n    },\n    onError: error => {\n      addAlert({\n        type: 'critical',\n        message: error.message\n      });\n    }\n  });\n  return <Button destructive disabled={disabled || loading} onClick={() => mutate({\n    ids\n  })}>\n            {i18n.t('Delete selected')}\n        </Button>;\n};\n\nDeleteSelectedButton.propTypes = {\n  selected: PropTypes.arrayOf(PropTypes.string).isRequired\n};\nexport default DeleteSelectedButton;","import React, { useState } from 'react';\nimport { useDataQuery } from '@dhis2/app-runtime';\nimport { NoticeBox, CenteredContent, CircularLoader } from '@dhis2/ui';\nimport i18n from '../../locales';\nimport { PageHeadline } from '../../headline';\nimport SmsTable from './SmsTable';\nimport StatusFilter, { parseStatus } from './StatusFilter';\nimport { getAllIds, getAllSelected } from './selectors';\nimport { createToggleAllHandler, createToggleHandler, createCleanSelectedHandler } from './handlers';\nimport DeleteSelectedButton from './DeleteSelectedButton';\nimport RefetchSms from './RefetchSms';\nimport s from './SentSmsList.module.css';\nexport const SENT_SMS_LIST_LABEL = i18n.t('Sent');\nexport const SENT_SMS_LIST_PATH = '/sent';\n\nconst parseParams = ({\n  status,\n  page,\n  pageSize\n}) => {\n  const base = {\n    pageSize,\n    page,\n    fields: ['id', 'message', 'status', 'date', 'recipients']\n  };\n\n  if (!status) {\n    return base;\n  }\n\n  return { ...base,\n    filter: `status:eq:${status}`\n  };\n};\n\nconst query = {\n  sms: {\n    resource: 'sms/outbound',\n    params: parseParams\n  }\n};\nexport const SentSmsList = () => {\n  const [selected, setSelected] = useState([]);\n  const [status, setStatus] = useState('ALL');\n  const {\n    loading,\n    error,\n    data,\n    refetch\n  } = useDataQuery(query, {\n    variables: {\n      status: parseStatus(status),\n      pageSize: 10,\n      page: 1\n    }\n  });\n\n  if (loading) {\n    return <>\n                <PageHeadline>{SENT_SMS_LIST_LABEL}</PageHeadline>\n                <CenteredContent>\n                    <CircularLoader />\n                </CenteredContent>\n            </>;\n  }\n\n  if (error) {\n    const msg = i18n.t('Something went wrong whilst loading sent SMSes');\n    return <>\n                <PageHeadline>{SENT_SMS_LIST_LABEL}</PageHeadline>\n                <NoticeBox error title={msg}>\n                    {error.message}\n                </NoticeBox>\n            </>;\n  } // Selectors\n\n\n  const allIds = getAllIds(data.sms.outboundsmss);\n  const allSelected = getAllSelected(allIds, selected); // Handlers\n\n  const cleanSelected = createCleanSelectedHandler({\n    selected,\n    setSelected\n  });\n  const toggleAll = createToggleAllHandler({\n    allSelected,\n    setSelected,\n    allIds\n  });\n  const toggleSelected = createToggleHandler({\n    selected,\n    setSelected\n  }); // Context\n\n  const context = {\n    refetch,\n    refetchAndClear: params => {\n      setSelected([]);\n      refetch(params);\n    }\n  };\n  const smses = data?.sms?.outboundsmss || [];\n  return <RefetchSms.Provider value={context}>\n            <PageHeadline>{SENT_SMS_LIST_LABEL}</PageHeadline>\n            <div className={s.header}>\n                <StatusFilter status={status} setStatus={setStatus} />\n                <div className={s.headerRight}>\n                    <DeleteSelectedButton selected={selected} />\n                </div>\n            </div>\n            <SmsTable smses={smses} cleanSelected={cleanSelected} allSelected={allSelected} selected={selected} toggleSelected={toggleSelected} toggleAll={toggleAll} pager={data.sms.pager} />\n        </RefetchSms.Provider>;\n};","// Creates a handler for toggling a single checkbox\nexport const createToggleHandler = ({\n  selected,\n  setSelected\n}) => id => {\n  const isSelected = selected.includes(id);\n\n  if (isSelected) {\n    const filtered = selected.filter(currentId => currentId !== id);\n    return setSelected(filtered);\n  }\n\n  return setSelected([...selected, id]);\n}; // Create a handler for toggling all checkboxes\n\nexport const createToggleAllHandler = ({\n  allSelected,\n  setSelected,\n  allIds\n}) => () => {\n  if (allSelected) {\n    return setSelected([]);\n  }\n\n  return setSelected(allIds);\n}; // Create a handler to remove an id from selected, for after deletion\n\nexport const createCleanSelectedHandler = ({\n  selected,\n  setSelected\n}) => id => {\n  if (selected.includes(id)) {\n    const filtered = selected.filter(current => current != id);\n    setSelected(filtered);\n  }\n};","import { useHistory, useRouteMatch } from 'react-router-dom';\nimport { MenuItem } from '@dhis2/ui';\nimport { PropTypes } from '@dhis2/prop-types';\nimport React from 'react';\nimport { dataTest } from '../dataTest';\n\nconst useIsItemActive = (path, exactMatch) => {\n  const routeMatch = useRouteMatch(path);\n  if (!routeMatch) return false;\n  if (exactMatch) return routeMatch.isExact;\n  return true;\n};\n\nexport const NavigationItem = ({\n  label,\n  path,\n  exactMatch\n}) => {\n  const history = useHistory();\n  const active = useIsItemActive(path, exactMatch);\n\n  const navigateToPath = () => history.push(path);\n\n  return <MenuItem onClick={navigateToPath} active={active} label={label} dataTest={dataTest('navigation-navigationitem')} />;\n};\nNavigationItem.defualtProps = {\n  exactMatch: false\n};\nNavigationItem.propTypes = {\n  label: PropTypes.string.isRequired,\n  path: PropTypes.string.isRequired,\n  exactMatch: PropTypes.bool\n};","import { Menu } from '@dhis2/ui';\nimport React from 'react';\nimport { GATEWAY_CONFIG_LIST_LABEL, GATEWAY_CONFIG_LIST_PATH, SMS_COMMAND_LIST_LABEL, SMS_COMMAND_LIST_PATH, SENT_SMS_LIST_LABEL, SENT_SMS_LIST_PATH, HOME_PATH, HOME_LABEL, RECEIVED_SMS_LIST_PATH, RECEIVED_SMS_LIST_LABEL } from '../views';\nimport { NavigationItem } from './NavigationItem';\nimport { dataTest } from '../dataTest';\nexport const Navigation = () => <Menu dataTest={dataTest('navigation-navigation')}>\n        <NavigationItem path={HOME_PATH} label={HOME_LABEL} exactMatch={true} />\n\n        <NavigationItem path={GATEWAY_CONFIG_LIST_PATH} label={GATEWAY_CONFIG_LIST_LABEL} />\n\n        <NavigationItem path={SMS_COMMAND_LIST_PATH} label={SMS_COMMAND_LIST_LABEL} />\n\n        <NavigationItem path={SENT_SMS_LIST_PATH} label={SENT_SMS_LIST_LABEL} />\n\n        <NavigationItem path={RECEIVED_SMS_LIST_PATH} label={RECEIVED_SMS_LIST_LABEL} />\n    </Menu>;","import { BrowserRouter, Route, Switch } from 'react-router-dom';\nimport { CssVariables } from '@dhis2/ui';\nimport React from 'react';\nimport styles from './App.module.css';\nimport { AlertHandler } from './notifications';\nimport { Navigation } from './navigation';\nimport { GATEWAY_CONFIG_FORM_EDIT_PATH, GATEWAY_CONFIG_FORM_NEW_PATH, GATEWAY_CONFIG_LIST_PATH, RECEIVED_SMS_LIST_PATH, SMS_COMMAND_LIST_PATH, SMS_COMMAND_FORM_EDIT_PATH, SMS_COMMAND_FORM_NEW_PATH, SENT_SMS_LIST_PATH, GatewayConfigFormEdit, GatewayConfigFormNew, GatewayConfigList, ReceivedSmsList, SmsCommandList, SmsCommandFormEdit, SmsCommandFormNew, SentSmsList, HOME_PATH, Home, NoMatch } from './views';\nimport { dataTest } from './dataTest';\n\nconst App = () => <AlertHandler>\n        <CssVariables spacers colors />\n        <BrowserRouter>\n            <div className={styles.container} data-test={dataTest('app')}>\n                <div className={styles.sidebar}>\n                    <Navigation />\n                </div>\n\n                <main className={styles.content}>\n                    <Switch>\n                        <Route exact path={HOME_PATH} component={Home} />\n\n                        {\n          /* Gateway configuration */\n          ''}\n                        <Route exact path={GATEWAY_CONFIG_LIST_PATH} component={GatewayConfigList} />\n\n                        <Route exact path={GATEWAY_CONFIG_FORM_EDIT_PATH} component={GatewayConfigFormEdit} />\n\n                        <Route exact path={GATEWAY_CONFIG_FORM_NEW_PATH} component={GatewayConfigFormNew} />\n\n                        {\n          /* Sms command */\n          ''}\n                        <Route exact path={SMS_COMMAND_LIST_PATH} component={SmsCommandList} />\n\n                        <Route exact path={SMS_COMMAND_FORM_EDIT_PATH} component={SmsCommandFormEdit} />\n\n                        <Route exact path={SMS_COMMAND_FORM_NEW_PATH} component={SmsCommandFormNew} />\n\n                        {\n          /* View sent sms */\n          ''}\n                        <Route exact path={SENT_SMS_LIST_PATH} component={SentSmsList} />\n\n                        {\n          /* View received sms */\n          ''}\n                        <Route exact path={RECEIVED_SMS_LIST_PATH} component={ReceivedSmsList} />\n\n                        <Route component={NoMatch} />\n                    </Switch>\n                </main>\n            </div>\n        </BrowserRouter>\n    </AlertHandler>;\n\nexport default App;"],"sourceRoot":""}